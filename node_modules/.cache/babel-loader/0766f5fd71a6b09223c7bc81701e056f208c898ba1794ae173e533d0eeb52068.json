{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport \"core-js/modules/es.iterator.constructor.js\";\nimport \"core-js/modules/es.iterator.map.js\";\nimport { ref, onMounted } from 'vue';\nimport axios from 'axios';\nimport { useRoute, useRouter } from 'vue-router';\nimport L from 'leaflet';\nconst API_URL = 'http://127.0.0.1:8000/api';\nexport default {\n  __name: 'EvacuationAreaView',\n  setup(__props, {\n    expose: __expose\n  }) {\n    __expose();\n    const route = useRoute();\n    const router = useRouter();\n    const area = ref(null);\n    const loading = ref(false);\n    const errorMessage = ref('');\n    let map = null;\n    const fetchArea = async () => {\n      loading.value = true;\n      try {\n        const response = await axios.get(`${API_URL}/evacuation-areas/${route.params.id}`);\n        area.value = response.data;\n        setTimeout(() => {\n          initMap();\n        }, 100);\n      } catch (error) {\n        errorMessage.value = error.response?.data?.message || 'Failed to fetch evacuation area';\n        console.error(error);\n      } finally {\n        loading.value = false;\n      }\n    };\n    const initMap = () => {\n      if (!area.value || !area.value.latitude || !area.value.longitude) return;\n      if (map) return;\n      const mapContainer = document.getElementById('map-view');\n      if (!mapContainer) return;\n      map = L.map('map-view').setView([area.value.latitude, area.value.longitude], 13);\n      L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {\n        attribution: '© OpenStreetMap contributors',\n        maxZoom: 19\n      }).addTo(map);\n      L.marker([area.value.latitude, area.value.longitude]).bindPopup(area.value.name).addTo(map).openPopup();\n    };\n    const deleteArea = async () => {\n      if (!confirm('Are you sure you want to delete this evacuation area?')) return;\n      try {\n        const token = localStorage.getItem('token');\n        await axios.delete(`${API_URL}/evacuation-areas/${area.value.id}`, {\n          headers: {\n            Authorization: `Bearer ${token}`\n          }\n        });\n        router.push('/evacuation-areas?success=Area deleted successfully');\n      } catch (error) {\n        errorMessage.value = error.response?.data?.message || 'Failed to delete evacuation area';\n        console.error(error);\n      }\n    };\n    const getStatusClass = status => {\n      const statusMap = {\n        available: 'bg-success',\n        full: 'bg-warning',\n        closed: 'bg-danger',\n        maintenance: 'bg-secondary'\n      };\n      return statusMap[status] || 'bg-secondary';\n    };\n    const getOccupancyPercent = areaData => {\n      if (areaData.capacity === 0) return 0;\n      return Math.round(areaData.current_occupancy / areaData.capacity * 100);\n    };\n    const getOccupancyClass = areaData => {\n      const percent = getOccupancyPercent(areaData);\n      if (percent >= 90) return 'bg-danger';\n      if (percent >= 70) return 'bg-warning';\n      return 'bg-success';\n    };\n    const formatDate = dateString => {\n      const date = new Date(dateString);\n      return date.toLocaleDateString('en-US', {\n        year: 'numeric',\n        month: 'long',\n        day: 'numeric'\n      });\n    };\n    onMounted(() => {\n      fetchArea();\n    });\n    const __returned__ = {\n      route,\n      router,\n      area,\n      loading,\n      errorMessage,\n      get map() {\n        return map;\n      },\n      set map(v) {\n        map = v;\n      },\n      API_URL,\n      fetchArea,\n      initMap,\n      deleteArea,\n      getStatusClass,\n      getOccupancyPercent,\n      getOccupancyClass,\n      formatDate,\n      ref,\n      onMounted,\n      get axios() {\n        return axios;\n      },\n      get useRoute() {\n        return useRoute;\n      },\n      get useRouter() {\n        return useRouter;\n      },\n      get L() {\n        return L;\n      }\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["ref","onMounted","axios","useRoute","useRouter","L","API_URL","route","router","area","loading","errorMessage","map","fetchArea","value","response","get","params","id","data","setTimeout","initMap","error","message","console","latitude","longitude","mapContainer","document","getElementById","setView","tileLayer","attribution","maxZoom","addTo","marker","bindPopup","name","openPopup","deleteArea","confirm","token","localStorage","getItem","delete","headers","Authorization","push","getStatusClass","status","statusMap","available","full","closed","maintenance","getOccupancyPercent","areaData","capacity","Math","round","current_occupancy","getOccupancyClass","percent","formatDate","dateString","date","Date","toLocaleDateString","year","month","day"],"sources":["C:/VUEprojects/crud-app/src/pages/EvacuationAreaView.vue"],"sourcesContent":["<template>\r\n  <div class=\"container mt-4\">\r\n    <div class=\"row\">\r\n      <div class=\"col-md-8 mx-auto\">\r\n        <!-- Back Button -->\r\n        <router-link to=\"/evacuation-areas\" class=\"btn btn-secondary mb-3\">\r\n          <i class=\"bi bi-arrow-left\"></i> Back\r\n        </router-link>\r\n\r\n        <!-- Alert Messages -->\r\n        <div v-if=\"errorMessage\" class=\"alert alert-danger alert-dismissible fade show\" role=\"alert\">\r\n          {{ errorMessage }}\r\n          <button type=\"button\" class=\"btn-close\" @click=\"errorMessage = ''\"></button>\r\n        </div>\r\n\r\n        <!-- Loading State -->\r\n        <div v-if=\"loading\" class=\"text-center\">\r\n          <div class=\"spinner-border\" role=\"status\">\r\n            <span class=\"visually-hidden\">Loading...</span>\r\n          </div>\r\n        </div>\r\n\r\n        <!-- Area Details -->\r\n        <div v-else-if=\"area\" class=\"bg-white p-4 rounded shadow-sm\">\r\n          <!-- Header -->\r\n          <div class=\"d-flex justify-content-between align-items-start mb-4\">\r\n            <div>\r\n              <h1 class=\"mb-2\">{{ area.name }}</h1>\r\n              <p class=\"text-muted mb-0\">{{ area.address }}</p>\r\n            </div>\r\n            <div>\r\n              <router-link :to=\"`/evacuation-areas/${area.id}/edit`\" class=\"btn btn-warning btn-sm\">\r\n                <i class=\"bi bi-pencil\"></i> Edit\r\n              </router-link>\r\n            </div>\r\n          </div>\r\n\r\n          <!-- Status & Capacity -->\r\n          <div class=\"row mb-4\">\r\n            <div class=\"col-md-6\">\r\n              <div class=\"card\">\r\n                <div class=\"card-body\">\r\n                  <h6 class=\"card-title text-muted\">Status</h6>\r\n                  <span :class=\"['badge', getStatusClass(area.status), 'fs-6']\">\r\n                    {{ area.status }}\r\n                  </span>\r\n                </div>\r\n              </div>\r\n            </div>\r\n            <div class=\"col-md-6\">\r\n              <div class=\"card\">\r\n                <div class=\"card-body\">\r\n                  <h6 class=\"card-title text-muted\">Occupancy</h6>\r\n                  <p class=\"card-text\">{{ area.current_occupancy }} / {{ area.capacity }} persons</p>\r\n                  <div class=\"progress\" style=\"height: 20px;\">\r\n                    <div\r\n                      class=\"progress-bar\"\r\n                      :class=\"getOccupancyClass(area)\"\r\n                      :style=\"{ width: getOccupancyPercent(area) + '%' }\"\r\n                    >\r\n                      {{ getOccupancyPercent(area) }}%\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          <!-- Contact Information -->\r\n          <div class=\"card mb-4\">\r\n            <div class=\"card-header bg-light\">\r\n              <h6 class=\"mb-0\">Contact Information</h6>\r\n            </div>\r\n            <div class=\"card-body\">\r\n              <div class=\"row\">\r\n                <div class=\"col-md-6\">\r\n                  <strong>Contact Person:</strong>\r\n                  <p>{{ area.contact_person || 'Not provided' }}</p>\r\n                </div>\r\n                <div class=\"col-md-6\">\r\n                  <strong>Phone Number:</strong>\r\n                  <p>{{ area.contact_number || 'Not provided' }}</p>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          <!-- Location Map -->\r\n          <div class=\"card mb-4\">\r\n            <div class=\"card-header bg-light\">\r\n              <h6 class=\"mb-0\">Location</h6>\r\n            </div>\r\n            <div class=\"card-body\">\r\n              <div v-if=\"area.latitude && area.longitude\">\r\n                <div id=\"map-view\" style=\"height: 300px; border-radius: 5px; margin-bottom: 15px;\"></div>\r\n                <p class=\"text-muted small\">\r\n                  <strong>Latitude:</strong> {{ area.latitude }}<br>\r\n                  <strong>Longitude:</strong> {{ area.longitude }}\r\n                </p>\r\n              </div>\r\n              <div v-else class=\"alert alert-info mb-0\">\r\n                No location coordinates provided\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          <!-- Facilities -->\r\n          <div class=\"card mb-4\">\r\n            <div class=\"card-header bg-light\">\r\n              <h6 class=\"mb-0\">Facilities</h6>\r\n            </div>\r\n            <div class=\"card-body\">\r\n              <p v-if=\"area.facilities\" class=\"mb-0\">{{ area.facilities }}</p>\r\n              <p v-else class=\"text-muted mb-0\">No facilities listed</p>\r\n            </div>\r\n          </div>\r\n\r\n          <!-- Evacuated Families -->\r\n          <div class=\"card mb-4\">\r\n            <div class=\"card-header bg-light\">\r\n              <h6 class=\"mb-0\">Evacuated Families</h6>\r\n            </div>\r\n            <div class=\"card-body\">\r\n              <div v-if=\"area.families && area.families.length > 0\">\r\n                <div v-for=\"family in area.families\" :key=\"family.id\" class=\"family-item mb-3 p-3 border rounded\">\r\n                  <div class=\"d-flex justify-content-between align-items-start mb-2\">\r\n                    <h6 class=\"mb-1\">{{ family.family_name || 'Unnamed Family' }}</h6>\r\n                    <small class=\"text-muted\">{{ family.evacuees ? family.evacuees.length : 0 }} members</small>\r\n                  </div>\r\n                  <p class=\"text-muted small mb-2\">{{ family.address || 'No address provided' }}</p>\r\n                  <div v-if=\"family.evacuees && family.evacuees.length > 0\">\r\n                    <strong class=\"small\">Family Members:</strong>\r\n                    <ul class=\"list-unstyled mt-1\">\r\n                      <li v-for=\"evacuee in family.evacuees\" :key=\"evacuee.id\" class=\"small\">\r\n                        <i class=\"bi bi-person-fill me-1\"></i>\r\n                        {{ evacuee.first_name }} {{ evacuee.last_name }}\r\n                        <span v-if=\"evacuee.age\" class=\"text-muted\">({{ evacuee.age }} years old)</span>\r\n                        <span v-if=\"evacuee.relationship\" class=\"text-muted\">- {{ evacuee.relationship }}</span>\r\n                      </li>\r\n                    </ul>\r\n                  </div>\r\n                  <div v-else class=\"text-muted small\">\r\n                    No family members listed\r\n                  </div>\r\n                </div>\r\n              </div>\r\n              <div v-else class=\"text-muted\">\r\n                No families currently evacuated in this area\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          <!-- Additional Info -->\r\n          <div class=\"row text-muted small\">\r\n            <div class=\"col-md-6\">\r\n              <p><strong>Families:</strong> {{ area.families_count || 0 }}</p>\r\n            </div>\r\n            <div class=\"col-md-6\">\r\n              <p v-if=\"area.created_at\" class=\"mb-0\">\r\n                <strong>Created:</strong> {{ formatDate(area.created_at) }}\r\n              </p>\r\n            </div>\r\n          </div>\r\n\r\n          <!-- Action Buttons -->\r\n          <div class=\"d-flex gap-2 mt-4\">\r\n            <router-link :to=\"`/evacuation-areas/${area.id}/edit`\" class=\"btn btn-warning\">\r\n              <i class=\"bi bi-pencil\"></i> Edit\r\n            </router-link>\r\n            <button @click=\"deleteArea\" class=\"btn btn-danger\">\r\n              <i class=\"bi bi-trash\"></i> Delete\r\n            </button>\r\n            <router-link to=\"/evacuation-areas\" class=\"btn btn-secondary\">\r\n              <i class=\"bi bi-list\"></i> Back to List\r\n            </router-link>\r\n          </div>\r\n        </div>\r\n\r\n        <!-- Not Found -->\r\n        <div v-else class=\"alert alert-warning\">\r\n          Evacuation area not found\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, onMounted } from 'vue'\r\nimport axios from 'axios'\r\nimport { useRoute, useRouter } from 'vue-router'\r\nimport L from 'leaflet'\r\n\r\nconst route = useRoute()\r\nconst router = useRouter()\r\n\r\nconst area = ref(null)\r\nconst loading = ref(false)\r\nconst errorMessage = ref('')\r\nlet map = null\r\n\r\nconst API_URL = 'http://127.0.0.1:8000/api'\r\n\r\nconst fetchArea = async () => {\r\n  loading.value = true\r\n  try {\r\n    const response = await axios.get(`${API_URL}/evacuation-areas/${route.params.id}`)\r\n    area.value = response.data\r\n    setTimeout(() => {\r\n      initMap()\r\n    }, 100)\r\n  } catch (error) {\r\n    errorMessage.value = error.response?.data?.message || 'Failed to fetch evacuation area'\r\n    console.error(error)\r\n  } finally {\r\n    loading.value = false\r\n  }\r\n}\r\n\r\nconst initMap = () => {\r\n  if (!area.value || !area.value.latitude || !area.value.longitude) return\r\n  if (map) return\r\n\r\n  const mapContainer = document.getElementById('map-view')\r\n  if (!mapContainer) return\r\n\r\n  map = L.map('map-view').setView([area.value.latitude, area.value.longitude], 13)\r\n\r\n  L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {\r\n    attribution: '© OpenStreetMap contributors',\r\n    maxZoom: 19\r\n  }).addTo(map)\r\n\r\n  L.marker([area.value.latitude, area.value.longitude])\r\n    .bindPopup(area.value.name)\r\n    .addTo(map)\r\n    .openPopup()\r\n}\r\n\r\nconst deleteArea = async () => {\r\n  if (!confirm('Are you sure you want to delete this evacuation area?')) return\r\n\r\n  try {\r\n    const token = localStorage.getItem('token')\r\n    await axios.delete(`${API_URL}/evacuation-areas/${area.value.id}`, {\r\n      headers: { Authorization: `Bearer ${token}` }\r\n    })\r\n    router.push('/evacuation-areas?success=Area deleted successfully')\r\n  } catch (error) {\r\n    errorMessage.value = error.response?.data?.message || 'Failed to delete evacuation area'\r\n    console.error(error)\r\n  }\r\n}\r\n\r\nconst getStatusClass = (status) => {\r\n  const statusMap = {\r\n    available: 'bg-success',\r\n    full: 'bg-warning',\r\n    closed: 'bg-danger',\r\n    maintenance: 'bg-secondary'\r\n  }\r\n  return statusMap[status] || 'bg-secondary'\r\n}\r\n\r\nconst getOccupancyPercent = (areaData) => {\r\n  if (areaData.capacity === 0) return 0\r\n  return Math.round((areaData.current_occupancy / areaData.capacity) * 100)\r\n}\r\n\r\nconst getOccupancyClass = (areaData) => {\r\n  const percent = getOccupancyPercent(areaData)\r\n  if (percent >= 90) return 'bg-danger'\r\n  if (percent >= 70) return 'bg-warning'\r\n  return 'bg-success'\r\n}\r\n\r\nconst formatDate = (dateString) => {\r\n  const date = new Date(dateString)\r\n  return date.toLocaleDateString('en-US', {\r\n    year: 'numeric',\r\n    month: 'long',\r\n    day: 'numeric'\r\n  })\r\n}\r\n\r\nonMounted(() => {\r\n  fetchArea()\r\n})\r\n</script>\r\n\r\n<style scoped>\r\n.card {\r\n  border: 1px solid #ddd;\r\n  transition: box-shadow 0.2s;\r\n}\r\n\r\n.card:hover {\r\n  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);\r\n}\r\n\r\n.badge {\r\n  padding: 0.5rem 1rem;\r\n}\r\n</style>\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}