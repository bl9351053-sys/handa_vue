{"ast":null,"code":"import \"core-js/modules/web.url-search-params.delete.js\";\nimport \"core-js/modules/web.url-search-params.has.js\";\nimport \"core-js/modules/web.url-search-params.size.js\";\nimport { reactive, toRefs, onMounted } from 'vue';\nimport axios from 'axios';\nexport default {\n  __name: 'ReportPrediction',\n  setup(__props, {\n    expose: __expose\n  }) {\n    __expose();\n    const state = reactive({\n      predictions: [],\n      summary: {\n        total: 0,\n        by_severity: {},\n        active: 0\n      },\n      filters: {\n        severity: '',\n        disaster_type: ''\n      },\n      loading: false,\n      error: null\n    });\n    function formatDate(dt) {\n      return dt ? new Date(dt).toLocaleString() : 'N/A';\n    }\n    async function fetchPredictions() {\n      state.loading = true;\n      state.error = null;\n      try {\n        const params = {\n          ...state.filters,\n          json: 1\n        };\n        const res = await axios.get('http://localhost:8000/api/reports/prediction', {\n          params\n        });\n        state.predictions = res.data.predictions || [];\n        state.summary = res.data.summary || {\n          total: 0,\n          by_severity: {},\n          active: 0\n        };\n      } catch (e) {\n        console.error(e);\n        state.error = e.message || 'Failed to load predictions.';\n      } finally {\n        state.loading = false;\n      }\n    }\n    async function downloadCSV() {\n      const params = {\n        ...state.filters,\n        format: 'csv'\n      };\n      try {\n        const res = await axios.get('http://localhost:8000/api/reports/prediction', {\n          params,\n          responseType: 'blob'\n        });\n        const blob = new Blob([res.data], {\n          type: 'text/csv'\n        });\n        const url = window.URL.createObjectURL(blob);\n        const a = document.createElement('a');\n        a.href = url;\n        a.download = `prediction_report_${new Date().toISOString().slice(0, 19).replace(/[:T]/g, '_')}.csv`;\n        document.body.appendChild(a);\n        a.click();\n        a.remove();\n        window.URL.revokeObjectURL(url);\n      } catch (e) {\n        console.error('CSV download failed', e);\n        state.error = 'Failed to download CSV.';\n      }\n    }\n    onMounted(fetchPredictions);\n    const {\n      predictions,\n      summary,\n      filters,\n      loading,\n      error\n    } = toRefs(state);\n    const __returned__ = {\n      state,\n      formatDate,\n      fetchPredictions,\n      downloadCSV,\n      predictions,\n      summary,\n      filters,\n      loading,\n      error,\n      reactive,\n      toRefs,\n      onMounted,\n      get axios() {\n        return axios;\n      }\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["reactive","toRefs","onMounted","axios","state","predictions","summary","total","by_severity","active","filters","severity","disaster_type","loading","error","formatDate","dt","Date","toLocaleString","fetchPredictions","params","json","res","get","data","e","console","message","downloadCSV","format","responseType","blob","Blob","type","url","window","URL","createObjectURL","a","document","createElement","href","download","toISOString","slice","replace","body","appendChild","click","remove","revokeObjectURL"],"sources":["C:/VUEprojects/crud-app/src/pages/ReportPrediction.vue"],"sourcesContent":["<template>\r\n  <div class=\"container\">\r\n    <div class=\"header mb-6\">\r\n      <h1 class=\"text-3xl font-bold gradient-text\">Disaster Report</h1>\r\n    </div>\r\n\r\n      <div class=\"card mb-6\">\r\n        <div class=\"grid grid-cols-1 md:grid-cols-4 gap-4\">\r\n          <select v-model=\"filters.severity\" class=\"input-field\">\r\n            <option value=\"\">All Severities</option>\r\n            <option value=\"low\">Low</option>\r\n            <option value=\"medium\">Medium</option>\r\n            <option value=\"high\">High</option>\r\n          </select>\r\n          <input v-model=\"filters.disaster_type\" placeholder=\"Disaster Type\" class=\"input-field\" />\r\n          <button class=\"btn-submit\" @click=\"fetchPredictions\">Filter</button>\r\n          <div class=\"flex justify-end\">\r\n            <button class=\"btn-submit\" @click=\"downloadCSV\">Download CSV</button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      <div class=\"flex items-center justify-between mb-4\">\r\n        <div></div>\r\n        <div>\r\n          <span v-if=\"loading\">Loading...</span>\r\n          <span v-if=\"error\" class=\"text-red-600\">{{ error }}</span>\r\n        </div>\r\n      </div>\r\n\r\n```\r\n<!-- Table -->\r\n<div class=\"card\">\r\n  <table class=\"w-full table-auto border-collapse\">\r\n    <thead>\r\n      <tr>\r\n        <th class=\"th\">Disaster Type</th>\r\n        <th class=\"th\">Severity</th>\r\n        <th class=\"th\">Location</th>\r\n        <th class=\"th\">Issued At</th>\r\n        <th class=\"th\">Valid Until</th>\r\n      </tr>\r\n    </thead>\r\n    <tbody>\r\n      <tr v-for=\"p in predictions\" :key=\"p.id\">\r\n        <td class=\"td\">{{ p.disaster_type }}</td>\r\n        <td class=\"td\">{{ p.severity }}</td>\r\n        <td class=\"td\">{{ p.location_name || 'N/A' }}</td>\r\n        <td class=\"td\">{{ formatDate(p.predicted_at) }}</td>\r\n        <td class=\"td\">{{ formatDate(p.valid_until) }}</td>\r\n      </tr>\r\n    </tbody>\r\n  </table>\r\n</div>\r\n\r\n<!-- Summary -->\r\n<div class=\"grid grid-cols-1 md:grid-cols-3 gap-4 mt-6\">\r\n  <div class=\"info-box purple\">\r\n    <p class=\"label\">Total Predictions</p>\r\n    <p class=\"value\">{{ summary.total }}</p>\r\n  </div>\r\n  <div class=\"info-box green\">\r\n    <p class=\"label\">By Severity</p>\r\n    <p class=\"value\" v-for=\"(count, severity) in summary.by_severity\" :key=\"severity\">{{ severity }}: {{ count }}</p>\r\n  </div>\r\n  <div class=\"info-box indigo\">\r\n    <p class=\"label\">Active Predictions</p>\r\n    <p class=\"value\">{{ summary.active }}</p>\r\n  </div>\r\n</div>\r\n```\r\n\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { reactive, toRefs, onMounted } from 'vue'\r\nimport axios from 'axios'\r\n\r\nconst state = reactive({\r\n  predictions: [],\r\n  summary: { total:0, by_severity:{}, active:0 },\r\n  filters: { severity: '', disaster_type: '' },\r\n  loading: false,\r\n  error: null,\r\n})\r\n\r\nfunction formatDate(dt) { return dt ? new Date(dt).toLocaleString() : 'N/A' }\r\n\r\nasync function fetchPredictions() {\r\n  state.loading = true\r\n  state.error = null\r\n  try {\r\n    const params = { ...state.filters, json: 1 }\r\n    const res = await axios.get('http://localhost:8000/api/reports/prediction', { params })\r\n    state.predictions = res.data.predictions || []\r\n    state.summary = res.data.summary || { total:0, by_severity:{}, active:0 }\r\n  } catch (e) {\r\n    console.error(e)\r\n    state.error = e.message || 'Failed to load predictions.'\r\n  } finally {\r\n    state.loading = false\r\n  }\r\n}\r\n\r\nasync function downloadCSV() {\r\n  const params = { ...state.filters, format: 'csv' }\r\n  try {\r\n    const res = await axios.get('http://localhost:8000/api/reports/prediction', { params, responseType: 'blob' })\r\n    const blob = new Blob([res.data], { type: 'text/csv' })\r\n    const url = window.URL.createObjectURL(blob)\r\n    const a = document.createElement('a')\r\n    a.href = url\r\n    a.download = `prediction_report_${new Date().toISOString().slice(0,19).replace(/[:T]/g,'_')}.csv`\r\n    document.body.appendChild(a)\r\n    a.click()\r\n    a.remove()\r\n    window.URL.revokeObjectURL(url)\r\n  } catch (e) {\r\n    console.error('CSV download failed', e)\r\n    state.error = 'Failed to download CSV.'\r\n  }\r\n}\r\n\r\nonMounted(fetchPredictions)\r\n\r\nconst { predictions, summary, filters, loading, error } = toRefs(state)\r\n</script>\r\n\r\n<style scoped>\r\n.container { max-width: 1100px; margin:0 auto; padding:20px; }\r\n.gradient-text { background: linear-gradient(90deg,#6366f1,#f43f5e); -webkit-background-clip:text; -webkit-text-fill-color:transparent; }\r\n.card { background:#fff; border-radius:12px; padding:20px; box-shadow:0 4px 12px rgba(0,0,0,0.08); margin-bottom:20px; }\r\n.info-box { padding:15px; border-radius:12px; }\r\n.info-box.purple { background:#f3e8ff; color:#7c3aed; }\r\n.info-box.green { background:#d1fae5; color:#059669; }\r\n.info-box.indigo { background:#e0e7ff; color:#4338ca; }\r\ntable { width:100%; border-collapse:collapse; }\r\n.th, .td { padding:8px; border:1px solid #e5e7eb; text-align:left; }\r\n</style>\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}