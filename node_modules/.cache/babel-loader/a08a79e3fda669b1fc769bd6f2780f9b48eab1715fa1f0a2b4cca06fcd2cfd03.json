{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport { ref, inject, onMounted, computed } from 'vue';\nimport { useRoute, useRouter } from 'vue-router';\nexport default {\n  __name: 'RegisterFamily',\n  setup(__props, {\n    expose: __expose\n  }) {\n    __expose();\n    const route = useRoute();\n    const router = useRouter();\n\n    // Extract ID from route params - it should be the first :id in the path\n    const id = computed(() => {\n      const paramId = route.params.id;\n      if (!paramId) {\n        console.warn('[RegisterFamily] No id found in route params', route.params);\n      }\n      return paramId;\n    });\n    const residentAxios = inject('residentAxios', null);\n    let axiosFallback = null;\n    const form = ref({\n      family_head_name: '',\n      total_members: 1,\n      contact_number: '',\n      address: '',\n      special_needs: ''\n    });\n    const errors = ref({});\n    const serverError = ref('');\n    const successMessage = ref('');\n    const submitting = ref(false);\n    onMounted(() => {\n      console.debug('[RegisterFamily] mounted with id:', id.value, 'route params:', route.params);\n    });\n\n    /**\r\n     * Submit the registration form\r\n     */\n    async function submit() {\n      if (!id.value) {\n        serverError.value = 'Invalid evacuation area ID';\n        return;\n      }\n      submitting.value = true;\n      errors.value = {};\n      serverError.value = '';\n      successMessage.value = '';\n      try {\n        if (!axiosFallback) {\n          const mod = await import('axios');\n          axiosFallback = mod.default || mod;\n        }\n        const http = residentAxios || axiosFallback;\n        console.debug('[RegisterFamily] submitting to /evacuation-areas/' + id.value + '/go', form.value);\n        const response = await http.post(`/evacuation-areas/${id.value}/go`, form.value);\n        console.debug('[RegisterFamily] success', response.data);\n        successMessage.value = response.data.message || 'Family registered successfully!';\n\n        // Redirect after a short delay to show the success message\n        setTimeout(() => {\n          router.push(`/resident_pages/evacuation-areas/${id.value}`);\n        }, 1500);\n      } catch (e) {\n        console.error('[RegisterFamily] submission error', e);\n        if (e.response && e.response.status === 422) {\n          // Validation errors\n          errors.value = e.response.data.errors || e.response.data || {};\n          console.debug('[RegisterFamily] validation errors', errors.value);\n        } else {\n          // Server or other error\n          serverError.value = e.response?.data?.message || e.message || 'Failed to register family';\n        }\n      } finally {\n        submitting.value = false;\n      }\n    }\n    const __returned__ = {\n      route,\n      router,\n      id,\n      residentAxios,\n      get axiosFallback() {\n        return axiosFallback;\n      },\n      set axiosFallback(v) {\n        axiosFallback = v;\n      },\n      form,\n      errors,\n      serverError,\n      successMessage,\n      submitting,\n      submit,\n      ref,\n      inject,\n      onMounted,\n      computed,\n      get useRoute() {\n        return useRoute;\n      },\n      get useRouter() {\n        return useRouter;\n      }\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["ref","inject","onMounted","computed","useRoute","useRouter","route","router","id","paramId","params","console","warn","residentAxios","axiosFallback","form","family_head_name","total_members","contact_number","address","special_needs","errors","serverError","successMessage","submitting","debug","value","submit","mod","default","http","response","post","data","message","setTimeout","push","e","error","status"],"sources":["C:/VUEprojects/crud-app/src/pages/resident_pages/RegisterFamily.vue"],"sourcesContent":["<template>\r\n  <div class=\"register-family\">\r\n    <!-- Header with Back Button -->\r\n    <div class=\"header-controls\">\r\n      <router-link :to=\"`/resident_pages/evacuation-areas/${id}`\" class=\"btn btn-secondary\">‚Üê Back to Area</router-link>\r\n    </div>\r\n\r\n    <div class=\"card\">\r\n      <div class=\"card-header\">üë• Register My Family</div>\r\n      <div class=\"card-body\">\r\n        <p class=\"intro-text\">Please provide your family information to register at this evacuation area.</p>\r\n\r\n        <!-- Success Message -->\r\n        <div v-if=\"successMessage\" class=\"success-msg\">\r\n          ‚úÖ {{ successMessage }}\r\n        </div>\r\n\r\n        <!-- Server Error -->\r\n        <div v-if=\"serverError\" class=\"error-box\">\r\n          ‚ùå {{ serverError }}\r\n        </div>\r\n\r\n        <!-- Registration Form -->\r\n        <form @submit.prevent=\"submit\" class=\"form\">\r\n          <div class=\"form-row\">\r\n            <label for=\"family_head_name\">Family Head Name *</label>\r\n            <input \r\n              id=\"family_head_name\"\r\n              v-model=\"form.family_head_name\" \r\n              type=\"text\"\r\n              placeholder=\"e.g., Juan Dela Cruz\"\r\n              required\r\n            />\r\n            <div v-if=\"errors.family_head_name\" class=\"error-msg\">\r\n              {{ errors.family_head_name[0] }}\r\n            </div>\r\n          </div>\r\n\r\n          <div class=\"form-row\">\r\n            <label for=\"total_members\">Total Family Members *</label>\r\n            <input \r\n              id=\"total_members\"\r\n              v-model.number=\"form.total_members\" \r\n              type=\"number\" \r\n              min=\"1\"\r\n              placeholder=\"e.g., 4\"\r\n              required\r\n            />\r\n            <div v-if=\"errors.total_members\" class=\"error-msg\">\r\n              {{ errors.total_members[0] }}\r\n            </div>\r\n            <div class=\"hint\">Including yourself</div>\r\n          </div>\r\n\r\n          <div class=\"form-row\">\r\n            <label for=\"contact_number\">Contact Number *</label>\r\n            <input \r\n              id=\"contact_number\"\r\n              v-model=\"form.contact_number\" \r\n              type=\"text\"\r\n              placeholder=\"e.g., +63 9XX XXX XXXX\"\r\n              required\r\n            />\r\n            <div v-if=\"errors.contact_number\" class=\"error-msg\">\r\n              {{ errors.contact_number[0] }}\r\n            </div>\r\n          </div>\r\n\r\n          <div class=\"form-row\">\r\n            <label for=\"address\">Current Address</label>\r\n            <input \r\n              id=\"address\"\r\n              v-model=\"form.address\" \r\n              type=\"text\"\r\n              placeholder=\"Your residential address\"\r\n            />\r\n            <div v-if=\"errors.address\" class=\"error-msg\">\r\n              {{ errors.address[0] }}\r\n            </div>\r\n          </div>\r\n\r\n          <div class=\"form-row\">\r\n            <label for=\"special_needs\">Special Needs / Medical Conditions</label>\r\n            <input \r\n              id=\"special_needs\"\r\n              v-model=\"form.special_needs\" \r\n              type=\"text\"\r\n              placeholder=\"e.g., Wheelchair accessible, Oxygen support, etc.\"\r\n            />\r\n            <div v-if=\"errors.special_needs\" class=\"error-msg\">\r\n              {{ errors.special_needs[0] }}\r\n            </div>\r\n          </div>\r\n\r\n          <div class=\"form-actions\">\r\n            <button type=\"submit\" class=\"btn btn-primary\" :disabled=\"submitting\">\r\n              {{ submitting ? 'Registering...' : '‚úì Register Family' }}\r\n            </button>\r\n            <router-link :to=\"`/resident_pages/evacuation-areas/${id}`\" class=\"btn btn-secondary\">\r\n              Cancel\r\n            </router-link>\r\n          </div>\r\n        </form>\r\n      </div>\r\n    </div>\r\n\r\n    <!-- Info Box -->\r\n    <div class=\"card mt-2\">\r\n      <div class=\"card-header\">‚ÑπÔ∏è Information</div>\r\n      <div class=\"card-body\">\r\n        <ul class=\"info-list\">\r\n          <li>Your family information will be securely recorded</li>\r\n          <li>You will receive a confirmation with your family ID</li>\r\n          <li>The evacuation center staff will be notified of your arrival</li>\r\n          <li>Contact the center at the provided number if you have questions</li>\r\n        </ul>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, inject, onMounted, computed } from 'vue';\r\nimport { useRoute, useRouter } from 'vue-router';\r\n\r\nconst route = useRoute();\r\nconst router = useRouter();\r\n\r\n// Extract ID from route params - it should be the first :id in the path\r\nconst id = computed(() => {\r\n  const paramId = route.params.id;\r\n  if (!paramId) {\r\n    console.warn('[RegisterFamily] No id found in route params', route.params);\r\n  }\r\n  return paramId;\r\n});\r\n\r\nconst residentAxios = inject('residentAxios', null);\r\nlet axiosFallback = null;\r\n\r\nconst form = ref({\r\n  family_head_name: '',\r\n  total_members: 1,\r\n  contact_number: '',\r\n  address: '',\r\n  special_needs: ''\r\n});\r\n\r\nconst errors = ref({});\r\nconst serverError = ref('');\r\nconst successMessage = ref('');\r\nconst submitting = ref(false);\r\n\r\nonMounted(() => {\r\n  console.debug('[RegisterFamily] mounted with id:', id.value, 'route params:', route.params);\r\n});\r\n\r\n/**\r\n * Submit the registration form\r\n */\r\nasync function submit() {\r\n  if (!id.value) {\r\n    serverError.value = 'Invalid evacuation area ID';\r\n    return;\r\n  }\r\n\r\n  submitting.value = true;\r\n  errors.value = {};\r\n  serverError.value = '';\r\n  successMessage.value = '';\r\n\r\n  try {\r\n    if (!axiosFallback) {\r\n      const mod = await import('axios');\r\n      axiosFallback = mod.default || mod;\r\n    }\r\n\r\n    const http = residentAxios || axiosFallback;\r\n    \r\n    console.debug('[RegisterFamily] submitting to /evacuation-areas/' + id.value + '/go', form.value);\r\n    \r\n    const response = await http.post(`/evacuation-areas/${id.value}/go`, form.value);\r\n    \r\n    console.debug('[RegisterFamily] success', response.data);\r\n    \r\n    successMessage.value = response.data.message || 'Family registered successfully!';\r\n    \r\n    // Redirect after a short delay to show the success message\r\n    setTimeout(() => {\r\n      router.push(`/resident_pages/evacuation-areas/${id.value}`);\r\n    }, 1500);\r\n  } catch (e) {\r\n    console.error('[RegisterFamily] submission error', e);\r\n    \r\n    if (e.response && e.response.status === 422) {\r\n      // Validation errors\r\n      errors.value = e.response.data.errors || e.response.data || {};\r\n      console.debug('[RegisterFamily] validation errors', errors.value);\r\n    } else {\r\n      // Server or other error\r\n      serverError.value = e.response?.data?.message || e.message || 'Failed to register family';\r\n    }\r\n  } finally {\r\n    submitting.value = false;\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.register-family {\r\n  padding: 1rem;\r\n  max-width: 700px;\r\n  margin: 0 auto;\r\n}\r\n\r\n/* Header Controls */\r\n.header-controls {\r\n  margin-bottom: 1.5rem;\r\n  display: flex;\r\n  gap: 0.5rem;\r\n}\r\n\r\n/* Cards */\r\n.card {\r\n  background: white;\r\n  border-radius: 8px;\r\n  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);\r\n  margin-bottom: 1rem;\r\n  overflow: hidden;\r\n}\r\n\r\n.card-header {\r\n  padding: 1rem;\r\n  font-weight: 700;\r\n  border-bottom: 1px solid #e6edf3;\r\n  background: linear-gradient(180deg, #f8fafc 0%, #eef2f6 100%);\r\n  font-size: 1.1rem;\r\n}\r\n\r\n.card-body {\r\n  padding: 1.5rem;\r\n}\r\n\r\n/* Intro Text */\r\n.intro-text {\r\n  color: #666;\r\n  margin-bottom: 1rem;\r\n  line-height: 1.6;\r\n}\r\n\r\n/* Messages */\r\n.success-msg {\r\n  background: #ecfdf5;\r\n  color: #065f46;\r\n  padding: 12px;\r\n  border-radius: 6px;\r\n  border-left: 4px solid #10b981;\r\n  margin-bottom: 1rem;\r\n  font-weight: 500;\r\n}\r\n\r\n.error-box {\r\n  background: #fff1f2;\r\n  color: #7f1d1d;\r\n  padding: 12px;\r\n  border-radius: 6px;\r\n  border-left: 4px solid #ef4444;\r\n  margin-bottom: 1rem;\r\n  font-weight: 500;\r\n}\r\n\r\n/* Form */\r\n.form {\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: 1rem;\r\n}\r\n\r\n.form-row {\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: 4px;\r\n}\r\n\r\n.form-row label {\r\n  display: block;\r\n  font-weight: 600;\r\n  color: #374151;\r\n  font-size: 0.95rem;\r\n}\r\n\r\n.form-row input {\r\n  width: 100%;\r\n  padding: 10px;\r\n  border: 1px solid #e6edf3;\r\n  border-radius: 6px;\r\n  font-size: 0.95rem;\r\n  font-family: inherit;\r\n  transition: border-color 200ms ease, box-shadow 200ms ease;\r\n}\r\n\r\n.form-row input:focus {\r\n  outline: none;\r\n  border-color: #667eea;\r\n  box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);\r\n}\r\n\r\n.form-row input::placeholder {\r\n  color: #999;\r\n}\r\n\r\n.hint {\r\n  font-size: 0.85rem;\r\n  color: #666;\r\n  margin-top: 2px;\r\n}\r\n\r\n.error-msg {\r\n  color: #b00020;\r\n  font-size: 0.85rem;\r\n  margin-top: 2px;\r\n}\r\n\r\n/* Form Actions */\r\n.form-actions {\r\n  display: flex;\r\n  gap: 8px;\r\n  margin-top: 1.5rem;\r\n}\r\n\r\n/* Buttons */\r\n.btn {\r\n  padding: 10px 12px;\r\n  border-radius: 6px;\r\n  color: white;\r\n  text-decoration: none;\r\n  border: none;\r\n  cursor: pointer;\r\n  font-size: 0.95rem;\r\n  font-weight: 500;\r\n  transition: background 200ms ease, opacity 200ms ease;\r\n  flex: 1;\r\n  text-align: center;\r\n  display: inline-block;\r\n}\r\n\r\n.btn:hover {\r\n  opacity: 0.9;\r\n}\r\n\r\n.btn:disabled {\r\n  opacity: 0.65;\r\n  cursor: not-allowed;\r\n}\r\n\r\n.btn-primary {\r\n  background: #667eea;\r\n}\r\n\r\n.btn-secondary {\r\n  background: #6c757d;\r\n}\r\n\r\n.mt-2 {\r\n  margin-top: 1rem;\r\n}\r\n\r\n/* Info List */\r\n.info-list {\r\n  list-style: none;\r\n  padding: 0;\r\n  margin: 0;\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: 0.75rem;\r\n}\r\n\r\n.info-list li {\r\n  padding-left: 24px;\r\n  position: relative;\r\n  color: #666;\r\n  line-height: 1.6;\r\n  font-size: 0.95rem;\r\n}\r\n\r\n.info-list li::before {\r\n  content: '‚úì';\r\n  position: absolute;\r\n  left: 0;\r\n  color: #10b981;\r\n  font-weight: 700;\r\n}\r\n\r\n/* Responsive */\r\n@media (max-width: 600px) {\r\n  .register-family {\r\n    padding: 0.75rem;\r\n  }\r\n\r\n  .form-actions {\r\n    flex-direction: column;\r\n  }\r\n\r\n  .btn {\r\n    width: 100%;\r\n  }\r\n}\r\n</style>\r\n"],"mappings":";AA0HA,SAASA,GAAG,EAAEC,MAAM,EAAEC,SAAS,EAAEC,QAAQ,QAAQ,KAAK;AACtD,SAASC,QAAQ,EAAEC,SAAS,QAAQ,YAAY;;;;;;;IAEhD,MAAMC,KAAK,GAAGF,QAAQ,CAAC,CAAC;IACxB,MAAMG,MAAM,GAAGF,SAAS,CAAC,CAAC;;IAE1B;IACA,MAAMG,EAAE,GAAGL,QAAQ,CAAC,MAAM;MACxB,MAAMM,OAAO,GAAGH,KAAK,CAACI,MAAM,CAACF,EAAE;MAC/B,IAAI,CAACC,OAAO,EAAE;QACZE,OAAO,CAACC,IAAI,CAAC,8CAA8C,EAAEN,KAAK,CAACI,MAAM,CAAC;MAC5E;MACA,OAAOD,OAAO;IAChB,CAAC,CAAC;IAEF,MAAMI,aAAa,GAAGZ,MAAM,CAAC,eAAe,EAAE,IAAI,CAAC;IACnD,IAAIa,aAAa,GAAG,IAAI;IAExB,MAAMC,IAAI,GAAGf,GAAG,CAAC;MACfgB,gBAAgB,EAAE,EAAE;MACpBC,aAAa,EAAE,CAAC;MAChBC,cAAc,EAAE,EAAE;MAClBC,OAAO,EAAE,EAAE;MACXC,aAAa,EAAE;IACjB,CAAC,CAAC;IAEF,MAAMC,MAAM,GAAGrB,GAAG,CAAC,CAAC,CAAC,CAAC;IACtB,MAAMsB,WAAW,GAAGtB,GAAG,CAAC,EAAE,CAAC;IAC3B,MAAMuB,cAAc,GAAGvB,GAAG,CAAC,EAAE,CAAC;IAC9B,MAAMwB,UAAU,GAAGxB,GAAG,CAAC,KAAK,CAAC;IAE7BE,SAAS,CAAC,MAAM;MACdS,OAAO,CAACc,KAAK,CAAC,mCAAmC,EAAEjB,EAAE,CAACkB,KAAK,EAAE,eAAe,EAAEpB,KAAK,CAACI,MAAM,CAAC;IAC7F,CAAC,CAAC;;IAEF;AACA;AACA;IACA,eAAeiB,MAAMA,CAAA,EAAG;MACtB,IAAI,CAACnB,EAAE,CAACkB,KAAK,EAAE;QACbJ,WAAW,CAACI,KAAK,GAAG,4BAA4B;QAChD;MACF;MAEAF,UAAU,CAACE,KAAK,GAAG,IAAI;MACvBL,MAAM,CAACK,KAAK,GAAG,CAAC,CAAC;MACjBJ,WAAW,CAACI,KAAK,GAAG,EAAE;MACtBH,cAAc,CAACG,KAAK,GAAG,EAAE;MAEzB,IAAI;QACF,IAAI,CAACZ,aAAa,EAAE;UAClB,MAAMc,GAAG,GAAG,MAAM,MAAM,CAAC,OAAO,CAAC;UACjCd,aAAa,GAAGc,GAAG,CAACC,OAAO,IAAID,GAAG;QACpC;QAEA,MAAME,IAAI,GAAGjB,aAAa,IAAIC,aAAa;QAE3CH,OAAO,CAACc,KAAK,CAAC,mDAAmD,GAAGjB,EAAE,CAACkB,KAAK,GAAG,KAAK,EAAEX,IAAI,CAACW,KAAK,CAAC;QAEjG,MAAMK,QAAQ,GAAG,MAAMD,IAAI,CAACE,IAAI,CAAC,qBAAqBxB,EAAE,CAACkB,KAAK,KAAK,EAAEX,IAAI,CAACW,KAAK,CAAC;QAEhFf,OAAO,CAACc,KAAK,CAAC,0BAA0B,EAAEM,QAAQ,CAACE,IAAI,CAAC;QAExDV,cAAc,CAACG,KAAK,GAAGK,QAAQ,CAACE,IAAI,CAACC,OAAO,IAAI,iCAAiC;;QAEjF;QACAC,UAAU,CAAC,MAAM;UACf5B,MAAM,CAAC6B,IAAI,CAAC,oCAAoC5B,EAAE,CAACkB,KAAK,EAAE,CAAC;QAC7D,CAAC,EAAE,IAAI,CAAC;MACV,CAAC,CAAC,OAAOW,CAAC,EAAE;QACV1B,OAAO,CAAC2B,KAAK,CAAC,mCAAmC,EAAED,CAAC,CAAC;QAErD,IAAIA,CAAC,CAACN,QAAQ,IAAIM,CAAC,CAACN,QAAQ,CAACQ,MAAM,KAAK,GAAG,EAAE;UAC3C;UACAlB,MAAM,CAACK,KAAK,GAAGW,CAAC,CAACN,QAAQ,CAACE,IAAI,CAACZ,MAAM,IAAIgB,CAAC,CAACN,QAAQ,CAACE,IAAI,IAAI,CAAC,CAAC;UAC9DtB,OAAO,CAACc,KAAK,CAAC,oCAAoC,EAAEJ,MAAM,CAACK,KAAK,CAAC;QACnE,CAAC,MAAM;UACL;UACAJ,WAAW,CAACI,KAAK,GAAGW,CAAC,CAACN,QAAQ,EAAEE,IAAI,EAAEC,OAAO,IAAIG,CAAC,CAACH,OAAO,IAAI,2BAA2B;QAC3F;MACF,CAAC,SAAS;QACRV,UAAU,CAACE,KAAK,GAAG,KAAK;MAC1B;IACF","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}