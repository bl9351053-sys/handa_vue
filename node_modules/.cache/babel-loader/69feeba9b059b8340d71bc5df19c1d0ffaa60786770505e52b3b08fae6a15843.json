{"ast":null,"code":"import { ref, onMounted } from 'vue';\nimport axios from 'axios';\nimport { useRoute } from 'vue-router';\nconst API_URL = 'http://127.0.0.1:8000/api';\nexport default {\n  __name: 'EvacuationAreaList',\n  setup(__props, {\n    expose: __expose\n  }) {\n    __expose();\n    const areas = ref([]);\n    const loading = ref(false);\n    const successMessage = ref('');\n    const errorMessage = ref('');\n    const route = useRoute();\n    const fetchAreas = async () => {\n      loading.value = true;\n      try {\n        const response = await axios.get(`${API_URL}/evacuation-areas`);\n        areas.value = response.data;\n      } catch (error) {\n        errorMessage.value = error.response?.data?.message || 'Failed to fetch evacuation areas';\n        console.error(error);\n      } finally {\n        loading.value = false;\n      }\n    };\n    const deleteArea = async id => {\n      if (!confirm('Are you sure you want to delete this evacuation area?')) return;\n      try {\n        const token = localStorage.getItem('token');\n        await axios.delete(`${API_URL}/evacuation-areas/${id}`, {\n          headers: {\n            Authorization: `Bearer ${token}`\n          }\n        });\n        successMessage.value = 'Evacuation area deleted successfully';\n        await fetchAreas();\n      } catch (error) {\n        errorMessage.value = error.response?.data?.message || 'Failed to delete evacuation area';\n        console.error(error);\n      }\n    };\n    const getStatusClass = status => {\n      const statusMap = {\n        available: 'bg-success',\n        full: 'bg-warning',\n        closed: 'bg-danger',\n        maintenance: 'bg-secondary'\n      };\n      return statusMap[status] || 'bg-secondary';\n    };\n    const getOccupancyPercent = area => {\n      if (area.capacity === 0) return 0;\n      return Math.round(area.current_occupancy / area.capacity * 100);\n    };\n    const getOccupancyClass = area => {\n      const percent = getOccupancyPercent(area);\n      if (percent >= 90) return 'bg-danger';\n      if (percent >= 70) return 'bg-warning';\n      return 'bg-success';\n    };\n\n    // Check for success message from route params\n    onMounted(() => {\n      if (route.query.success) {\n        successMessage.value = route.query.success;\n      }\n      fetchAreas();\n    });\n    const __returned__ = {\n      areas,\n      loading,\n      successMessage,\n      errorMessage,\n      route,\n      API_URL,\n      fetchAreas,\n      deleteArea,\n      getStatusClass,\n      getOccupancyPercent,\n      getOccupancyClass,\n      ref,\n      onMounted,\n      get axios() {\n        return axios;\n      },\n      get useRoute() {\n        return useRoute;\n      }\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["ref","onMounted","axios","useRoute","API_URL","areas","loading","successMessage","errorMessage","route","fetchAreas","value","response","get","data","error","message","console","deleteArea","id","confirm","token","localStorage","getItem","delete","headers","Authorization","getStatusClass","status","statusMap","available","full","closed","maintenance","getOccupancyPercent","area","capacity","Math","round","current_occupancy","getOccupancyClass","percent","query","success"],"sources":["C:/VUEprojects/crud-app/src/pages/EvacuationAreaList.vue"],"sourcesContent":["<template>\r\n  <div class=\"container mt-4\">\r\n    <div class=\"row mb-4\">\r\n      <div class=\"col-md-8\">\r\n        <h1>Evacuation Areas</h1>\r\n      </div>\r\n      <div class=\"col-md-4 text-end\">\r\n        <router-link to=\"/evacuation-areas/create\" class=\"btn btn-primary\">\r\n          <i class=\"bi bi-plus-circle\"></i> Add Evacuation Area\r\n        </router-link>\r\n      </div>\r\n    </div>\r\n\r\n    <!-- Alert Messages -->\r\n    <div v-if=\"successMessage\" class=\"alert alert-success alert-dismissible fade show\" role=\"alert\">\r\n      {{ successMessage }}\r\n      <button type=\"button\" class=\"btn-close\" @click=\"successMessage = ''\"></button>\r\n    </div>\r\n    <div v-if=\"errorMessage\" class=\"alert alert-danger alert-dismissible fade show\" role=\"alert\">\r\n      {{ errorMessage }}\r\n      <button type=\"button\" class=\"btn-close\" @click=\"errorMessage = ''\"></button>\r\n    </div>\r\n\r\n    <!-- Loading State -->\r\n    <div v-if=\"loading\" class=\"text-center\">\r\n      <div class=\"spinner-border\" role=\"status\">\r\n        <span class=\"visually-hidden\">Loading...</span>\r\n      </div>\r\n    </div>\r\n\r\n    <!-- Areas List -->\r\n    <div v-else-if=\"areas.length > 0\" class=\"row\">\r\n      <div v-for=\"area in areas\" :key=\"area.id\" class=\"col-md-6 col-lg-4 mb-4\">\r\n        <div class=\"card h-100 shadow-sm\">\r\n          <div class=\"card-body\">\r\n            <h5 class=\"card-title\">{{ area.name }}</h5>\r\n            <p class=\"card-text text-muted small\">{{ area.address }}</p>\r\n\r\n            <!-- Status Badge -->\r\n            <div class=\"mb-3\">\r\n              <span :class=\"['badge', getStatusClass(area.status)]\">\r\n                {{ area.status }}\r\n              </span>\r\n            </div>\r\n\r\n            <!-- Occupancy Bar -->\r\n            <div class=\"mb-3\">\r\n              <div class=\"d-flex justify-content-between mb-1\">\r\n                <small>Occupancy</small>\r\n                <small>{{ area.current_occupancy }} / {{ area.capacity }}</small>\r\n              </div>\r\n              <div class=\"progress\" style=\"height: 20px;\">\r\n                <div\r\n                  class=\"progress-bar\"\r\n                  :class=\"getOccupancyClass(area)\"\r\n                  :style=\"{ width: getOccupancyPercent(area) + '%' }\"\r\n                  role=\"progressbar\"\r\n                >\r\n                  {{ getOccupancyPercent(area) }}%\r\n                </div>\r\n              </div>\r\n            </div>\r\n\r\n            <!-- Contact Info -->\r\n            <p class=\"card-text small mb-3\">\r\n              <strong>Contact:</strong> {{ area.contact_person || 'N/A' }}<br>\r\n              <strong>Phone:</strong> {{ area.contact_number || 'N/A' }}\r\n            </p>\r\n\r\n            <!-- Action Buttons -->\r\n            <div class=\"d-flex gap-2\">\r\n              <router-link :to=\"`/evacuation-areas/${area.id}`\" class=\"btn btn-sm btn-info flex-grow-1\">\r\n                View\r\n              </router-link>\r\n              <router-link :to=\"`/evacuation-areas/${area.id}/edit`\" class=\"btn btn-sm btn-warning flex-grow-1\">\r\n                Edit\r\n              </router-link>\r\n              <button @click=\"deleteArea(area.id)\" class=\"btn btn-sm btn-danger\">\r\n                <i class=\"bi bi-trash\"></i>\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n\r\n    <!-- Empty State -->\r\n    <div v-else class=\"alert alert-info text-center\">\r\n      <p class=\"mb-0\">No evacuation areas found.</p>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, onMounted } from 'vue'\r\nimport axios from 'axios'\r\nimport { useRoute } from 'vue-router'\r\n\r\nconst areas = ref([])\r\nconst loading = ref(false)\r\nconst successMessage = ref('')\r\nconst errorMessage = ref('')\r\nconst route = useRoute()\r\n\r\nconst API_URL = 'http://127.0.0.1:8000/api'\r\n\r\nconst fetchAreas = async () => {\r\n  loading.value = true\r\n  try {\r\n    const response = await axios.get(`${API_URL}/evacuation-areas`)\r\n    areas.value = response.data\r\n  } catch (error) {\r\n    errorMessage.value = error.response?.data?.message || 'Failed to fetch evacuation areas'\r\n    console.error(error)\r\n  } finally {\r\n    loading.value = false\r\n  }\r\n}\r\n\r\nconst deleteArea = async (id) => {\r\n  if (!confirm('Are you sure you want to delete this evacuation area?')) return\r\n\r\n  try {\r\n    const token = localStorage.getItem('token')\r\n    await axios.delete(`${API_URL}/evacuation-areas/${id}`, {\r\n      headers: { Authorization: `Bearer ${token}` }\r\n    })\r\n    successMessage.value = 'Evacuation area deleted successfully'\r\n    await fetchAreas()\r\n  } catch (error) {\r\n    errorMessage.value = error.response?.data?.message || 'Failed to delete evacuation area'\r\n    console.error(error)\r\n  }\r\n}\r\n\r\nconst getStatusClass = (status) => {\r\n  const statusMap = {\r\n    available: 'bg-success',\r\n    full: 'bg-warning',\r\n    closed: 'bg-danger',\r\n    maintenance: 'bg-secondary'\r\n  }\r\n  return statusMap[status] || 'bg-secondary'\r\n}\r\n\r\nconst getOccupancyPercent = (area) => {\r\n  if (area.capacity === 0) return 0\r\n  return Math.round((area.current_occupancy / area.capacity) * 100)\r\n}\r\n\r\nconst getOccupancyClass = (area) => {\r\n  const percent = getOccupancyPercent(area)\r\n  if (percent >= 90) return 'bg-danger'\r\n  if (percent >= 70) return 'bg-warning'\r\n  return 'bg-success'\r\n}\r\n\r\n// Check for success message from route params\r\nonMounted(() => {\r\n  if (route.query.success) {\r\n    successMessage.value = route.query.success\r\n  }\r\n  fetchAreas()\r\n})\r\n</script>\r\n\r\n<style scoped>\r\n.card {\r\n  transition: transform 0.2s, box-shadow 0.2s;\r\n}\r\n\r\n.card:hover {\r\n  transform: translateY(-5px);\r\n  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15) !important;\r\n}\r\n\r\n.progress {\r\n  background-color: #e9ecef;\r\n}\r\n</style>\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}