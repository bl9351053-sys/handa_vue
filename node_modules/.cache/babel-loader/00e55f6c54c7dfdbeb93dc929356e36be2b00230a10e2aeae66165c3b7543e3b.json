{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport \"core-js/modules/es.iterator.constructor.js\";\nimport \"core-js/modules/es.iterator.map.js\";\nimport { ref, inject, onMounted } from 'vue';\nimport { useRouter } from 'vue-router';\nexport default {\n  __name: 'DisasterPredictionsList',\n  setup(__props, {\n    expose: __expose\n  }) {\n    __expose();\n    const residentAxios = inject('residentAxios');\n    const router = useRouter();\n    const predictions = ref([]);\n    const loading = ref(false);\n    const error = ref(null);\n    const pagination = ref(null);\n    const fetchPredictions = async (page = 1) => {\n      loading.value = true;\n      error.value = null;\n      try {\n        const res = await residentAxios.get('/disaster-predictions', {\n          params: {\n            page\n          }\n        });\n        if (res.data && res.data.data) {\n          predictions.value = res.data.data.map(normalizePrediction);\n          pagination.value = {\n            current_page: res.data.current_page,\n            last_page: res.data.last_page,\n            total: res.data.total\n          };\n        } else if (Array.isArray(res.data)) {\n          predictions.value = res.data.map(normalizePrediction);\n          pagination.value = null;\n        }\n      } catch (e) {\n        console.error('[Pred] Fetch error', e);\n        error.value = 'Failed to load predictions.';\n      } finally {\n        loading.value = false;\n      }\n    };\n    function normalizePrediction(p) {\n      const disaster_type = p.disaster_type ?? p.disasterType ?? p.type ?? '';\n      const risk_level = p.risk_level ?? p.riskLevel ?? p.risk ?? 0;\n      return {\n        ...p,\n        disaster_type,\n        risk_level\n      };\n    }\n    const goToDetail = id => router.push({\n      path: `/resident_pages/disaster-predictions/${id}`\n    });\n    const formatShortDate = s => {\n      if (!s) return 'N/A';\n      try {\n        return new Date(s).toLocaleDateString('en-US', {\n          month: 'short',\n          day: '2-digit',\n          year: 'numeric'\n        });\n      } catch {\n        return s;\n      }\n    };\n    const capitalize = s => s ? s.charAt(0).toUpperCase() + s.slice(1) : '';\n    const badgeClass = lvl => {\n      if (lvl >= 8) return 'badge-critical';\n      if (lvl >= 6) return 'badge-high';\n      if (lvl >= 4) return 'badge-medium';\n      return 'badge-low';\n    };\n    const riskFillClass = lvl => {\n      if (lvl >= 8) return 'risk-bar-critical';\n      if (lvl >= 6) return 'risk-bar-high';\n      if (lvl >= 4) return 'risk-bar-medium';\n      return 'risk-bar-low';\n    };\n    const rowClass = lvl => {\n      if (lvl >= 8) return 'risk-row-critical';\n      if (lvl >= 6) return 'risk-row-high';\n      return 'risk-row-normal';\n    };\n    onMounted(() => fetchPredictions(1));\n    const __returned__ = {\n      residentAxios,\n      router,\n      predictions,\n      loading,\n      error,\n      pagination,\n      fetchPredictions,\n      normalizePrediction,\n      goToDetail,\n      formatShortDate,\n      capitalize,\n      badgeClass,\n      riskFillClass,\n      rowClass,\n      ref,\n      inject,\n      onMounted,\n      get useRouter() {\n        return useRouter;\n      }\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["ref","inject","onMounted","useRouter","residentAxios","router","predictions","loading","error","pagination","fetchPredictions","page","value","res","get","params","data","map","normalizePrediction","current_page","last_page","total","Array","isArray","e","console","p","disaster_type","disasterType","type","risk_level","riskLevel","risk","goToDetail","id","push","path","formatShortDate","s","Date","toLocaleDateString","month","day","year","capitalize","charAt","toUpperCase","slice","badgeClass","lvl","riskFillClass","rowClass"],"sources":["C:/VUEprojects/crud-app/src/pages/resident_pages/DisasterPredictionsList.vue"],"sourcesContent":["<template>\r\n  <div class=\"predictions-page\">\r\n    <div class=\"card\">\r\n      <div class=\"card-header\">ðŸ”® Disaster Predictions & Recovery Estimates</div>\r\n\r\n```\r\n  \r\n  <div v-if=\"loading\" class=\"center py-8\">Loading predictions...</div>\r\n  <div v-if=\"error\" class=\"center error p-3\">{{ error }}</div>\r\n\r\n  <div v-if=\"!loading && predictions.length > 0\" class=\"table-container\">\r\n    <table class=\"table\">\r\n      <thead>\r\n        <tr>\r\n          <th>Location</th>\r\n          <th>Disaster Type</th>\r\n          <th>Risk Level</th>\r\n          <th>Recovery Days</th>\r\n          <th>Issued At</th>\r\n          <th>Actions</th>\r\n        </tr>\r\n      </thead>\r\n      <tbody>\r\n        <tr v-for=\"p in predictions\" :key=\"p.id\" :class=\"rowClass(p.risk_level)\">\r\n          <td>\r\n            <strong>{{ p.location_name || 'Unknown' }}</strong><br>\r\n            <small class=\"text-muted\">{{ p.latitude || 'N/A' }}, {{ p.longitude || 'N/A' }}</small>\r\n          </td>\r\n          <td><span class=\"badge badge-info\">{{ capitalize(p.disaster_type) }}</span></td>\r\n          <td>\r\n            <div class=\"risk-level-container\">\r\n              <span class=\"badge\" :class=\"badgeClass(p.risk_level)\">{{ p.risk_level }}/10</span>\r\n              <div class=\"risk-bar-background mt-2\">\r\n                <div class=\"risk-bar-fill\" :class=\"riskFillClass(p.risk_level)\" :style=\"{ width: (p.risk_level || 0) * 10 + '%' }\"></div>\r\n              </div>\r\n            </div>\r\n          </td>\r\n          <td>\r\n            <span v-if=\"p.predicted_recovery_days\">~{{ p.predicted_recovery_days }} days</span>\r\n            <span v-else>N/A</span>\r\n          </td>\r\n          <td>{{ formatShortDate(p.predicted_at) }}</td>\r\n          <td>\r\n            <button class=\"btn btn-primary btn-small\" @click.prevent=\"goToDetail(p.id)\">View</button>\r\n          </td>\r\n        </tr>\r\n      </tbody>\r\n    </table>\r\n\r\n    <div class=\"mt-4 pagination-container\" v-if=\"pagination\">\r\n      <button v-if=\"pagination.current_page > 1\" @click=\"fetchPredictions(pagination.current_page - 1)\" class=\"btn btn-secondary btn-small\">Previous</button>\r\n      <span class=\"mx-3\">Page {{ pagination.current_page }} of {{ pagination.last_page }}</span>\r\n      <button v-if=\"pagination.current_page < pagination.last_page\" @click=\"fetchPredictions(pagination.current_page + 1)\" class=\"btn btn-secondary btn-small\">Next</button>\r\n    </div>\r\n  </div>\r\n\r\n  <div v-if=\"!loading && predictions.length === 0\" class=\"p-4 text-muted\">No predictions available.</div>\r\n</div>\r\n```\r\n\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, inject, onMounted } from 'vue';\r\nimport { useRouter } from 'vue-router';\r\n\r\nconst residentAxios = inject('residentAxios');\r\nconst router = useRouter();\r\n\r\nconst predictions = ref([]);\r\nconst loading = ref(false);\r\nconst error = ref(null);\r\nconst pagination = ref(null);\r\n\r\nconst fetchPredictions = async (page = 1) => {\r\n  loading.value = true;\r\n  error.value = null;\r\n  try {\r\n    const res = await residentAxios.get('/disaster-predictions', { params: { page } });\r\n    if (res.data && res.data.data) {\r\n      predictions.value = res.data.data.map(normalizePrediction);\r\n      pagination.value = {\r\n        current_page: res.data.current_page,\r\n        last_page: res.data.last_page,\r\n        total: res.data.total,\r\n      };\r\n    } else if (Array.isArray(res.data)) {\r\n      predictions.value = res.data.map(normalizePrediction);\r\n      pagination.value = null;\r\n    }\r\n  } catch (e) {\r\n    console.error('[Pred] Fetch error', e);\r\n    error.value = 'Failed to load predictions.';\r\n  } finally {\r\n    loading.value = false;\r\n  }\r\n};\r\n\r\nfunction normalizePrediction(p) {\r\n  const disaster_type = p.disaster_type ?? p.disasterType ?? p.type ?? '';\r\n  const risk_level = p.risk_level ?? p.riskLevel ?? p.risk ?? 0;\r\n  return { ...p, disaster_type, risk_level };\r\n}\r\n\r\nconst goToDetail = (id) => router.push({ path: `/resident_pages/disaster-predictions/${id}` });\r\n\r\nconst formatShortDate = (s) => {\r\n  if (!s) return 'N/A';\r\n  try { return new Date(s).toLocaleDateString('en-US', { month: 'short', day: '2-digit', year: 'numeric' }); } catch { return s; }\r\n};\r\n\r\nconst capitalize = (s) => s ? (s.charAt(0).toUpperCase() + s.slice(1)) : '';\r\n\r\nconst badgeClass = (lvl) => {\r\n  if (lvl >= 8) return 'badge-critical';\r\n  if (lvl >= 6) return 'badge-high';\r\n  if (lvl >= 4) return 'badge-medium';\r\n  return 'badge-low';\r\n};\r\n\r\nconst riskFillClass = (lvl) => {\r\n  if (lvl >= 8) return 'risk-bar-critical';\r\n  if (lvl >= 6) return 'risk-bar-high';\r\n  if (lvl >= 4) return 'risk-bar-medium';\r\n  return 'risk-bar-low';\r\n};\r\n\r\nconst rowClass = (lvl) => {\r\n  if (lvl >= 8) return 'risk-row-critical';\r\n  if (lvl >= 6) return 'risk-row-high';\r\n  return 'risk-row-normal';\r\n};\r\n\r\nonMounted(() => fetchPredictions(1));\r\n</script>\r\n\r\n<style scoped>\r\n.predictions-page {\r\n  padding: 2rem;\r\n  max-width: 1200px;\r\n  margin: 0 auto;\r\n  font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;\r\n  background: #f4f6fb;\r\n}\r\n\r\n.card {\r\n  background: #fff;\r\n  border-radius: 12px;\r\n  padding: 25px;\r\n  box-shadow: 0 8px 25px rgba(0,0,0,0.08);\r\n  transition: transform 0.2s, box-shadow 0.2s;\r\n}\r\n.card:hover {\r\n  transform: translateY(-3px);\r\n  box-shadow: 0 12px 30px rgba(0,0,0,0.12);\r\n}\r\n.card-header {\r\n  font-weight: 700;\r\n  font-size: 1.4rem;\r\n  margin-bottom: 20px;\r\n  color: #2a3f5f;\r\n  border-left: 6px solid #667eea;\r\n  padding-left: 12px;\r\n}\r\n\r\n.info-box {\r\n  background: #fff8e1;\r\n  border-left: 5px solid #ffc107;\r\n  padding: 12px 15px;\r\n  border-radius: 8px;\r\n  font-size: 0.95rem;\r\n}\r\n\r\n.center { text-align:center; font-size:1.05rem; color:#4b5563; }\r\n.error { color:#d32f2f; font-weight:600; }\r\n.text-muted { color:#6b7280; font-size:0.875rem; }\r\n\r\n.table-container { overflow-x:auto; margin-top: 1rem; }\r\n.table { width:100%; border-collapse: collapse; min-width: 700px; }\r\n.table th, .table td { padding: 12px 15px; text-align: left; border-bottom:1px solid #e2e8f0; }\r\n.table th { background:#eef2f7; color:#2a3f5f; font-weight:600; text-transform: uppercase; }\r\n.table tr:nth-child(even) { background:#f9fafc; }\r\n.table tr:hover { background-color:#e6f0ff; transition:0.2s; }\r\n\r\n.badge { padding:4px 10px; border-radius:12px; color:#fff; font-size:0.85rem; font-weight:500; }\r\n.badge-info { background:#4f46e5; }\r\n.badge-critical { background:#d32f2f; }\r\n.badge-high { background:#f97316; }\r\n.badge-medium { background:#fbbf24; }\r\n.badge-low { background:#10b981; }\r\n\r\n.risk-level-container { display:flex; flex-direction:column; }\r\n.risk-bar-background { width:100%; background:#e5e7eb; border-radius:8px; height:8px; }\r\n.risk-bar-fill { height:8px; border-radius:8px; }\r\n.risk-bar-critical { background:#d32f2f; }\r\n.risk-bar-high { background:#f97316; }\r\n.risk-bar-medium { background:#fbbf24; }\r\n.risk-bar-low { background:#10b981; }\r\n\r\n.risk-row-critical { background: rgba(211, 47, 47, 0.08); }\r\n.risk-row-high { background: rgba(249, 115, 22, 0.08); }\r\n.risk-row-normal:hover { background: #e6f0ff; }\r\n\r\n.btn { padding:6px 14px; border-radius:8px; color:#fff; background:#4f46e5; font-weight:500; cursor:pointer; transition: background 0.3s, transform 0.2s; }\r\n.btn:hover { background:#3730a3; transform: translateY(-2px); }\r\n.btn-small { font-size:0.85rem; padding:4px 10px; }\r\n\r\n.pagination-container { display:flex; align-items:center; justify-content:center; margin-top:16px; gap:10px; }\r\n\r\n@media(max-width:768px) { .table { min-width:100%; } }\r\n</style>\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}