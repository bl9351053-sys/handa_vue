{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport { ref, inject, onMounted } from 'vue';\nimport { useRouter } from 'vue-router';\nexport default {\n  __name: 'DisasterPredictionsList',\n  setup(__props, {\n    expose: __expose\n  }) {\n    __expose();\n    const residentAxios = inject('residentAxios');\n    const router = useRouter();\n    const predictions = ref([]);\n    const loading = ref(false);\n    const error = ref(null);\n    const syncing = ref(false);\n    const pagination = ref(null);\n    const fetchPredictions = async (page = 1) => {\n      loading.value = true;\n      error.value = null;\n      try {\n        const res = await residentAxios.get('/disaster-predictions', {\n          params: {\n            page\n          }\n        });\n        if (res.data && res.data.data) {\n          predictions.value = res.data.data;\n          pagination.value = {\n            current_page: res.data.current_page,\n            last_page: res.data.last_page,\n            total: res.data.total\n          };\n        } else if (Array.isArray(res.data)) {\n          predictions.value = res.data;\n          pagination.value = null;\n        }\n      } catch (e) {\n        console.error('[Pred] Fetch error', e);\n        error.value = 'Failed to load predictions.';\n      } finally {\n        loading.value = false;\n      }\n    };\n    const syncPredictions = async () => {\n      syncing.value = true;\n      try {\n        const res = await residentAxios.post('/real-time-data/sync');\n        if (res.data && res.data.success) {\n          alert('Sync successful: ' + (res.data.message || ''));\n          fetchPredictions(1);\n        } else {\n          alert('Sync failed');\n        }\n      } catch (e) {\n        console.error('[Pred] Sync error', e);\n        alert('Error syncing predictions');\n      } finally {\n        syncing.value = false;\n      }\n    };\n    const goToDetail = id => router.push({\n      path: `/resident_pages/disaster-predictions/${id}`\n    });\n    const formatShortDate = s => {\n      if (!s) return 'N/A';\n      try {\n        return new Date(s).toLocaleDateString('en-US', {\n          month: 'M',\n          day: '2-digit',\n          year: 'numeric'\n        });\n      } catch {\n        return s;\n      }\n    };\n    const capitalize = s => s ? s.charAt(0).toUpperCase() + s.slice(1) : '';\n    const badgeClass = lvl => {\n      if (lvl >= 8) return 'badge-critical';\n      if (lvl >= 6) return 'badge-high';\n      if (lvl >= 4) return 'badge-moderate';\n      return 'badge-low';\n    };\n    const riskFillClass = lvl => {\n      if (lvl >= 8) return 'risk-bar-critical';\n      if (lvl >= 6) return 'risk-bar-high';\n      if (lvl >= 4) return 'risk-bar-medium';\n      return 'risk-bar-low';\n    };\n    const rowClass = lvl => {\n      if (lvl >= 8) return 'risk-row-critical';\n      if (lvl >= 6) return 'risk-row-high';\n      return 'risk-row-normal';\n    };\n    onMounted(() => fetchPredictions(1));\n    const __returned__ = {\n      residentAxios,\n      router,\n      predictions,\n      loading,\n      error,\n      syncing,\n      pagination,\n      fetchPredictions,\n      syncPredictions,\n      goToDetail,\n      formatShortDate,\n      capitalize,\n      badgeClass,\n      riskFillClass,\n      rowClass,\n      ref,\n      inject,\n      onMounted,\n      get useRouter() {\n        return useRouter;\n      }\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["ref","inject","onMounted","useRouter","residentAxios","router","predictions","loading","error","syncing","pagination","fetchPredictions","page","value","res","get","params","data","current_page","last_page","total","Array","isArray","e","console","syncPredictions","post","success","alert","message","goToDetail","id","push","path","formatShortDate","s","Date","toLocaleDateString","month","day","year","capitalize","charAt","toUpperCase","slice","badgeClass","lvl","riskFillClass","rowClass"],"sources":["C:/VUEprojects/crud-app/src/pages/resident_pages/DisasterPredictionsList.vue"],"sourcesContent":["<template>\r\n  <div>\r\n    <div class=\"card\">\r\n      <div class=\"flex-between mb-4\">\r\n        <div class=\"card-header card-header-no-border\">üîÆ Disaster Predictions & Recovery Estimates</div>\r\n        <button @click=\"syncPredictions\" :disabled=\"syncing\" class=\"btn btn-success\">\r\n          <span v-if=\"!syncing\">üîÑ Sync from PAGASA/PhiVolcs</span>\r\n          <span v-else>‚è≥ Syncing...</span>\r\n        </button>\r\n      </div>\r\n\r\n      <div class=\"info-box warning mb-4\">\r\n        <strong>üì° Data Sources:</strong> Predictions are automatically generated from real-time data provided by: <strong>PAGASA</strong>, <strong>PhiVolcs</strong>, and <strong>NDRRMC</strong>. Click \"Sync\" to fetch latest predictions.\r\n      </div>\r\n\r\n      <div v-if=\"loading\" class=\"text-center py-8\">Loading predictions...</div>\r\n      <div v-if=\"error\" class=\"text-red-700 p-3\">{{ error }}</div>\r\n\r\n      <div v-if=\"!loading && predictions.length > 0\" class=\"table-container\">\r\n        <table class=\"table\">\r\n          <thead>\r\n            <tr>\r\n              <th>Location</th>\r\n              <th>Disaster Type</th>\r\n              <th>Risk Level</th>\r\n              <th>Recovery Days</th>\r\n              <th>Predicted At</th>\r\n              <th>Actions</th>\r\n            </tr>\r\n          </thead>\r\n          <tbody>\r\n            <tr v-for=\"p in predictions\" :key=\"p.id\" :class=\"rowClass(p.risk_level)\">\r\n              <td>\r\n                <strong>{{ p.location_name || 'Unknown' }}</strong>\r\n                <br>\r\n                <small class=\"text-muted\">{{ p.latitude || 'N/A' }}, {{ p.longitude || 'N/A' }}</small>\r\n              </td>\r\n              <td><span class=\"badge badge-info\">{{ capitalize(p.disaster_type) }}</span></td>\r\n              <td>\r\n                <div class=\"risk-level-container\">\r\n                  <span class=\"badge\" :class=\"badgeClass(p.risk_level)\">{{ p.risk_level }}/10</span>\r\n                  <div class=\"risk-bar-background mt-2\">\r\n                    <div class=\"risk-bar-fill\" :class=\"riskFillClass(p.risk_level)\" :style=\"{ width: (p.risk_level || 0) * 10 + '%' }\"></div>\r\n                  </div>\r\n                </div>\r\n              </td>\r\n              <td>\r\n                <span v-if=\"p.predicted_recovery_days\">~{{ p.predicted_recovery_days }} days</span>\r\n                <span v-else>N/A</span>\r\n              </td>\r\n              <td>{{ formatShortDate(p.predicted_at) }}</td>\r\n              <td>\r\n                <button class=\"btn btn-primary btn-small\" @click.prevent=\"goToDetail(p.id)\">View</button>\r\n              </td>\r\n            </tr>\r\n          </tbody>\r\n        </table>\r\n\r\n        <div class=\"mt-4 pagination-container\" v-if=\"pagination\">\r\n          <button v-if=\"pagination.current_page > 1\" @click=\"fetchPredictions(pagination.current_page - 1)\" class=\"btn btn-secondary btn-small\">Previous</button>\r\n          <span class=\"mx-3\">Page {{ pagination.current_page }} of {{ pagination.last_page }}</span>\r\n          <button v-if=\"pagination.current_page < pagination.last_page\" @click=\"fetchPredictions(pagination.current_page + 1)\" class=\"btn btn-secondary btn-small\">Next</button>\r\n        </div>\r\n      </div>\r\n\r\n      <div v-if=\"!loading && predictions.length === 0\" class=\"p-4 text-muted\">No predictions available.</div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, inject, onMounted } from 'vue';\r\nimport { useRouter } from 'vue-router';\r\n\r\nconst residentAxios = inject('residentAxios');\r\nconst router = useRouter();\r\n\r\nconst predictions = ref([]);\r\nconst loading = ref(false);\r\nconst error = ref(null);\r\nconst syncing = ref(false);\r\nconst pagination = ref(null);\r\n\r\nconst fetchPredictions = async (page = 1) => {\r\n  loading.value = true;\r\n  error.value = null;\r\n  try {\r\n    const res = await residentAxios.get('/disaster-predictions', { params: { page } });\r\n    if (res.data && res.data.data) {\r\n      predictions.value = res.data.data;\r\n      pagination.value = {\r\n        current_page: res.data.current_page,\r\n        last_page: res.data.last_page,\r\n        total: res.data.total,\r\n      };\r\n    } else if (Array.isArray(res.data)) {\r\n      predictions.value = res.data;\r\n      pagination.value = null;\r\n    }\r\n  } catch (e) {\r\n    console.error('[Pred] Fetch error', e);\r\n    error.value = 'Failed to load predictions.';\r\n  } finally {\r\n    loading.value = false;\r\n  }\r\n};\r\n\r\nconst syncPredictions = async () => {\r\n  syncing.value = true;\r\n  try {\r\n    const res = await residentAxios.post('/real-time-data/sync');\r\n    if (res.data && res.data.success) {\r\n      alert('Sync successful: ' + (res.data.message || ''));\r\n      fetchPredictions(1);\r\n    } else {\r\n      alert('Sync failed');\r\n    }\r\n  } catch (e) {\r\n    console.error('[Pred] Sync error', e);\r\n    alert('Error syncing predictions');\r\n  } finally {\r\n    syncing.value = false;\r\n  }\r\n};\r\n\r\nconst goToDetail = (id) => router.push({ path: `/resident_pages/disaster-predictions/${id}` });\r\n\r\nconst formatShortDate = (s) => {\r\n  if (!s) return 'N/A';\r\n  try { return new Date(s).toLocaleDateString('en-US', { month: 'M', day: '2-digit', year: 'numeric' }); } catch { return s; }\r\n};\r\n\r\nconst capitalize = (s) => s ? (s.charAt(0).toUpperCase() + s.slice(1)) : '';\r\n\r\nconst badgeClass = (lvl) => {\r\n  if (lvl >= 8) return 'badge-critical';\r\n  if (lvl >= 6) return 'badge-high';\r\n  if (lvl >= 4) return 'badge-moderate';\r\n  return 'badge-low';\r\n};\r\n\r\nconst riskFillClass = (lvl) => {\r\n  if (lvl >= 8) return 'risk-bar-critical';\r\n  if (lvl >= 6) return 'risk-bar-high';\r\n  if (lvl >= 4) return 'risk-bar-medium';\r\n  return 'risk-bar-low';\r\n};\r\n\r\nconst rowClass = (lvl) => {\r\n  if (lvl >= 8) return 'risk-row-critical';\r\n  if (lvl >= 6) return 'risk-row-high';\r\n  return 'risk-row-normal';\r\n};\r\n\r\nonMounted(() => fetchPredictions(1));\r\n</script>\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}