{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport \"core-js/modules/es.iterator.constructor.js\";\nimport \"core-js/modules/es.iterator.for-each.js\";\nimport { reactive, ref, inject, onMounted } from 'vue';\nimport axios from 'axios';\nimport { useRouter, useRoute } from 'vue-router';\nexport default {\n  __name: 'FacilityEdit',\n  setup(__props, {\n    expose: __expose\n  }) {\n    __expose();\n    const router = useRouter();\n    const route = useRoute();\n    const baseUrl = inject('baseUrl', '');\n    const facilityId = route.params.id;\n    const form = reactive({\n      name: '',\n      type: '',\n      address: '',\n      latitude: null,\n      longitude: null,\n      status: 'operational',\n      staff_count: 0,\n      contact_number: '',\n      resources: '',\n      notes: ''\n    });\n    const errors = reactive({});\n    const generalError = ref('');\n    const submitting = ref(false);\n    const loading = ref(true);\n    onMounted(async () => {\n      await fetchFacility();\n    });\n    async function fetchFacility() {\n      try {\n        const res = await axios.get(`${baseUrl}/facilities/${facilityId}`);\n        const facility = res.data?.data || res.data;\n        Object.assign(form, facility);\n      } catch (err) {\n        generalError.value = 'Failed to load facility. Please try again.';\n        console.error('Fetch facility error:', err);\n      } finally {\n        loading.value = false;\n      }\n    }\n    async function submit() {\n      submitting.value = true;\n      generalError.value = '';\n      Object.keys(errors).forEach(k => delete errors[k]);\n      try {\n        const payload = {\n          name: form.name,\n          type: form.type,\n          address: form.address,\n          latitude: form.latitude || null,\n          longitude: form.longitude || null,\n          status: form.status,\n          staff_count: form.staff_count,\n          contact_number: form.contact_number || null,\n          resources: form.resources || null,\n          notes: form.notes || null\n        };\n        await axios.put(`${baseUrl}/facilities/${facilityId}`, payload);\n        router.push('/facilities');\n      } catch (err) {\n        if (err.response?.status === 422) {\n          Object.assign(errors, err.response.data.errors || {});\n        } else if (err.response?.data?.message) {\n          generalError.value = err.response.data.message;\n        } else {\n          generalError.value = 'Failed to update facility. Please try again.';\n        }\n      } finally {\n        submitting.value = false;\n      }\n    }\n    const __returned__ = {\n      router,\n      route,\n      baseUrl,\n      facilityId,\n      form,\n      errors,\n      generalError,\n      submitting,\n      loading,\n      fetchFacility,\n      submit,\n      reactive,\n      ref,\n      inject,\n      onMounted,\n      get axios() {\n        return axios;\n      },\n      get useRouter() {\n        return useRouter;\n      },\n      get useRoute() {\n        return useRoute;\n      }\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["reactive","ref","inject","onMounted","axios","useRouter","useRoute","router","route","baseUrl","facilityId","params","id","form","name","type","address","latitude","longitude","status","staff_count","contact_number","resources","notes","errors","generalError","submitting","loading","fetchFacility","res","get","facility","data","Object","assign","err","value","console","error","submit","keys","forEach","k","payload","put","push","response","message"],"sources":["C:/VUEprojects/crud-app/src/pages/FacilityEdit.vue"],"sourcesContent":["<template>\r\n  <div class=\"min-h-screen bg-gray-100 p-6\">\r\n    <div class=\"max-w-4xl mx-auto\">\r\n      <!-- Header -->\r\n      <div class=\"mb-8 flex items-center justify-between\">\r\n        <div>\r\n          <h1 class=\"text-4xl font-bold text-gray-900\">Edit Facility</h1>\r\n          <p class=\"text-gray-600 mt-1\">Update facility information</p>\r\n        </div>\r\n        <router-link to=\"/facilities\" class=\"text-indigo-600 hover:text-indigo-900 font-medium flex items-center gap-1\">\r\n          <svg xmlns=\"http://www.w3.org/2000/svg\" class=\"h-4 w-4\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\r\n            <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M15 19l-7-7 7-7\" />\r\n          </svg>\r\n          Back to Facilities\r\n        </router-link>\r\n      </div>\r\n\r\n      <!-- Loading -->\r\n      <div v-if=\"loading\" class=\"bg-white rounded-lg shadow p-8 text-center\">\r\n        <div class=\"inline-flex items-center gap-2\">\r\n          <svg class=\"animate-spin h-6 w-6 text-indigo-600\" xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 24 24\">\r\n            <circle class=\"opacity-25\" cx=\"12\" cy=\"12\" r=\"10\" stroke=\"currentColor\" stroke-width=\"4\"></circle>\r\n            <path class=\"opacity-75\" fill=\"currentColor\" d=\"M4 12a8 8 0 018-8v8z\"></path>\r\n          </svg>\r\n          <span class=\"text-gray-600\">Loading facility...</span>\r\n        </div>\r\n      </div>\r\n\r\n      <!-- Form Card -->\r\n      <div v-else class=\"bg-white rounded-lg shadow-lg p-8\">\r\n        <!-- Error Messages -->\r\n        <div v-if=\"generalError\" class=\"mb-6 bg-red-50 border-l-4 border-red-500 text-red-800 px-6 py-4 rounded\">\r\n          <p class=\"text-sm\">{{ generalError }}</p>\r\n        </div>\r\n\r\n        <form @submit.prevent=\"submit\" class=\"space-y-6\">\r\n          <!-- Row 1: Name & Type -->\r\n          <div class=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\r\n            <div>\r\n              <label class=\"block text-sm font-medium text-gray-700 mb-2\">Name <span class=\"text-red-500\">*</span></label>\r\n              <input v-model=\"form.name\" type=\"text\" required\r\n                class=\"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent\" />\r\n              <p v-if=\"errors.name\" class=\"text-red-600 text-sm mt-1\">{{ errors.name }}</p>\r\n            </div>\r\n\r\n            <div>\r\n              <label class=\"block text-sm font-medium text-gray-700 mb-2\">Type <span class=\"text-red-500\">*</span></label>\r\n              <input v-model=\"form.type\" type=\"text\" required placeholder=\"Hospital, Fire Station, etc.\"\r\n                class=\"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent\" />\r\n              <p v-if=\"errors.type\" class=\"text-red-600 text-sm mt-1\">{{ errors.type }}</p>\r\n            </div>\r\n          </div>\r\n\r\n          <!-- Address -->\r\n          <div>\r\n            <label class=\"block text-sm font-medium text-gray-700 mb-2\">Address <span class=\"text-red-500\">*</span></label>\r\n            <textarea v-model=\"form.address\" required rows=\"3\"\r\n              class=\"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent\"></textarea>\r\n            <p v-if=\"errors.address\" class=\"text-red-600 text-sm mt-1\">{{ errors.address }}</p>\r\n          </div>\r\n\r\n          <!-- Row 2: Latitude & Longitude -->\r\n          <div class=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\r\n            <div>\r\n              <label class=\"block text-sm font-medium text-gray-700 mb-2\">Latitude</label>\r\n              <input v-model.number=\"form.latitude\" type=\"number\" step=\"0.00000001\"\r\n                class=\"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent\" />\r\n              <p v-if=\"errors.latitude\" class=\"text-red-600 text-sm mt-1\">{{ errors.latitude }}</p>\r\n            </div>\r\n\r\n            <div>\r\n              <label class=\"block text-sm font-medium text-gray-700 mb-2\">Longitude</label>\r\n              <input v-model.number=\"form.longitude\" type=\"number\" step=\"0.00000001\"\r\n                class=\"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent\" />\r\n              <p v-if=\"errors.longitude\" class=\"text-red-600 text-sm mt-1\">{{ errors.longitude }}</p>\r\n            </div>\r\n          </div>\r\n\r\n          <!-- Row 3: Status, Staff Count, Contact -->\r\n          <div class=\"grid grid-cols-1 md:grid-cols-3 gap-6\">\r\n            <div>\r\n              <label class=\"block text-sm font-medium text-gray-700 mb-2\">Status <span class=\"text-red-500\">*</span></label>\r\n              <select v-model=\"form.status\" required\r\n                class=\"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent\">\r\n                <option value=\"operational\">Operational</option>\r\n                <option value=\"limited\">Limited</option>\r\n                <option value=\"offline\">Offline</option>\r\n                <option value=\"emergency\">Emergency</option>\r\n              </select>\r\n              <p v-if=\"errors.status\" class=\"text-red-600 text-sm mt-1\">{{ errors.status }}</p>\r\n            </div>\r\n\r\n            <div>\r\n              <label class=\"block text-sm font-medium text-gray-700 mb-2\">Staff Count <span class=\"text-red-500\">*</span></label>\r\n              <input v-model.number=\"form.staff_count\" type=\"number\" required min=\"0\"\r\n                class=\"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent\" />\r\n              <p v-if=\"errors.staff_count\" class=\"text-red-600 text-sm mt-1\">{{ errors.staff_count }}</p>\r\n            </div>\r\n\r\n            <div>\r\n              <label class=\"block text-sm font-medium text-gray-700 mb-2\">Contact Number</label>\r\n              <input v-model=\"form.contact_number\" type=\"text\"\r\n                class=\"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent\" />\r\n              <p v-if=\"errors.contact_number\" class=\"text-red-600 text-sm mt-1\">{{ errors.contact_number }}</p>\r\n            </div>\r\n          </div>\r\n\r\n          <!-- Resources -->\r\n          <div>\r\n            <label class=\"block text-sm font-medium text-gray-700 mb-2\">Resources</label>\r\n            <textarea v-model=\"form.resources\" rows=\"2\" placeholder=\"e.g., Ambulances: 5, Beds: 100, Medical supplies\"\r\n              class=\"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent\"></textarea>\r\n            <p v-if=\"errors.resources\" class=\"text-red-600 text-sm mt-1\">{{ errors.resources }}</p>\r\n          </div>\r\n\r\n          <!-- Notes -->\r\n          <div>\r\n            <label class=\"block text-sm font-medium text-gray-700 mb-2\">Notes</label>\r\n            <textarea v-model=\"form.notes\" rows=\"3\"\r\n              class=\"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent\"></textarea>\r\n            <p v-if=\"errors.notes\" class=\"text-red-600 text-sm mt-1\">{{ errors.notes }}</p>\r\n          </div>\r\n\r\n          <!-- Actions -->\r\n          <div class=\"flex justify-end gap-3 pt-4 border-t\">\r\n            <router-link to=\"/facilities\" class=\"px-6 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 font-medium\">\r\n              Cancel\r\n            </router-link>\r\n            <button type=\"submit\" :disabled=\"submitting\" class=\"px-6 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 font-medium disabled:opacity-60\">\r\n              <span v-if=\"!submitting\">Update Facility</span>\r\n              <span v-else>Updating...</span>\r\n            </button>\r\n          </div>\r\n        </form>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { reactive, ref, inject, onMounted } from 'vue'\r\nimport axios from 'axios'\r\nimport { useRouter, useRoute } from 'vue-router'\r\n\r\nconst router = useRouter()\r\nconst route = useRoute()\r\nconst baseUrl = inject('baseUrl', '')\r\nconst facilityId = route.params.id\r\n\r\nconst form = reactive({\r\n  name: '',\r\n  type: '',\r\n  address: '',\r\n  latitude: null,\r\n  longitude: null,\r\n  status: 'operational',\r\n  staff_count: 0,\r\n  contact_number: '',\r\n  resources: '',\r\n  notes: ''\r\n})\r\n\r\nconst errors = reactive({})\r\nconst generalError = ref('')\r\nconst submitting = ref(false)\r\nconst loading = ref(true)\r\n\r\nonMounted(async () => {\r\n  await fetchFacility()\r\n})\r\n\r\nasync function fetchFacility() {\r\n  try {\r\n    const res = await axios.get(`${baseUrl}/facilities/${facilityId}`)\r\n    const facility = res.data?.data || res.data\r\n    Object.assign(form, facility)\r\n  } catch (err) {\r\n    generalError.value = 'Failed to load facility. Please try again.'\r\n    console.error('Fetch facility error:', err)\r\n  } finally {\r\n    loading.value = false\r\n  }\r\n}\r\n\r\nasync function submit() {\r\n  submitting.value = true\r\n  generalError.value = ''\r\n  Object.keys(errors).forEach(k => delete errors[k])\r\n\r\n  try {\r\n    const payload = {\r\n      name: form.name,\r\n      type: form.type,\r\n      address: form.address,\r\n      latitude: form.latitude || null,\r\n      longitude: form.longitude || null,\r\n      status: form.status,\r\n      staff_count: form.staff_count,\r\n      contact_number: form.contact_number || null,\r\n      resources: form.resources || null,\r\n      notes: form.notes || null\r\n    }\r\n\r\n    await axios.put(`${baseUrl}/facilities/${facilityId}`, payload)\r\n    router.push('/facilities')\r\n  } catch (err) {\r\n    if (err.response?.status === 422) {\r\n      Object.assign(errors, err.response.data.errors || {})\r\n    } else if (err.response?.data?.message) {\r\n      generalError.value = err.response.data.message\r\n    } else {\r\n      generalError.value = 'Failed to update facility. Please try again.'\r\n    }\r\n  } finally {\r\n    submitting.value = false\r\n  }\r\n}\r\n</script>\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}