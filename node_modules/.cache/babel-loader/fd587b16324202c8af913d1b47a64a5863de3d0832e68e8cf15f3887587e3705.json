{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport \"core-js/modules/es.iterator.constructor.js\";\nimport \"core-js/modules/es.iterator.for-each.js\";\nimport \"core-js/modules/es.iterator.map.js\";\nimport { ref, onMounted, onUnmounted, watch } from 'vue';\nimport { useRouter } from 'vue-router';\nimport { residentEvacuationService, residentPredictionsService } from '@/services/residentService';\nimport L from 'leaflet';\nimport 'leaflet/dist/leaflet.css';\nimport 'leaflet-routing-machine';\nimport 'leaflet-routing-machine/dist/leaflet-routing-machine.css';\nexport default {\n  __name: 'EvacuationAreaList',\n  setup(__props, {\n    expose: __expose\n  }) {\n    __expose();\n    const router = useRouter();\n\n    // ============ DATA ============\n    const areas = ref([]);\n    const loading = ref(true);\n    const error = ref(null);\n\n    // Disaster predictions\n    const disasterPredictions = ref([]);\n    const predictionsLoading = ref(true);\n\n    // Prescriptive analytics\n    const predictedEvacuees = ref(29.41);\n    const topArea = ref(null);\n    const prescriptiveData = ref(null);\n\n    // User location\n    const userLocation = ref(null);\n    const locationStatus = ref('');\n\n    // Map instance\n    let map = null;\n    let areaMarkers = [];\n    let predictionMarkers = [];\n    let updateTimeout = null;\n    let mapInitialized = false;\n\n    // Route directions\n    const showRouteDirections = ref(false);\n    const selectedArea = ref(null);\n    const routeDirections = ref([]);\n    const routeDistance = ref('');\n    const routeTime = ref('');\n\n    // Routing control\n    let routingControl = null;\n\n    // Add location modal (removed - residents cannot create evacuation areas)\n\n    // ============ METHODS ============\n\n    /**\r\n     * Capitalize first letter of a string\r\n     */\n    function capitalizeFirst(str) {\n      if (!str) return '';\n      return str.charAt(0).toUpperCase() + str.slice(1);\n    }\n\n    /**\r\n     * Get status badge CSS class\r\n     */\n    function getStatusBadgeClass(status) {\n      const classMap = {\n        'available': 'badge-success',\n        'full': 'badge-danger',\n        'closed': 'badge-warning',\n        'pending': 'badge-warning'\n      };\n      return classMap[status] || 'badge-warning';\n    }\n\n    /**\r\n     * Get hazard badge class based on risk score\r\n     */\n    function getHazardBadgeClass(riskScore) {\n      if (!riskScore) riskScore = 0;\n      if (riskScore >= 8) return 'hazard-critical';\n      if (riskScore >= 6) return 'hazard-high';\n      if (riskScore >= 4) return 'hazard-moderate';\n      return 'hazard-low';\n    }\n\n    /**\r\n     * Get safety factor badge class\r\n     */\n    function getSafetyFactorClass(safetyFactor) {\n      if (!safetyFactor) safetyFactor = 0;\n      if (safetyFactor >= 0.8) return 'hazard-low';\n      if (safetyFactor >= 0.6) return 'hazard-moderate';\n      if (safetyFactor >= 0.4) return 'hazard-high';\n      return 'hazard-critical';\n    }\n\n    /**\r\n     * Get prediction severity class\r\n     */\n    function getPredictionSeverityClass(severity) {\n      const severityMap = {\n        'low': 'severity-low',\n        'moderate': 'severity-moderate',\n        'high': 'severity-high',\n        'critical': 'severity-critical'\n      };\n      return severityMap[severity?.toLowerCase()] || 'severity-moderate';\n    }\n\n    /**\r\n     * Get disaster marker color based on disaster type\r\n     */\n    function getDisasterMarkerColor(disasterType) {\n      const colorMap = {\n        'flood': '#1e40af',\n        // blue\n        'earthquake': '#dc2626',\n        // red\n        'typhoon': '#059669',\n        // green\n        'unknown': '#6b7280' // gray\n      };\n      return colorMap[disasterType] || colorMap['unknown'];\n    }\n\n    /**\r\n     * Get disaster icon based on disaster type\r\n     */\n    function getDisasterIcon(disasterType) {\n      const iconMap = {\n        'flood': 'üåä',\n        'earthquake': 'üåã',\n        'typhoon': 'üåÄ',\n        'unknown': '‚ö†Ô∏è'\n      };\n      return iconMap[disasterType] || iconMap['unknown'];\n    }\n\n    /**\r\n     * Get risk circle color based on risk level\r\n     */\n    function getRiskCircleColor(riskLevel) {\n      if (riskLevel >= 8) return '#dc2626'; // red\n      if (riskLevel >= 6) return '#ea580c'; // orange\n      if (riskLevel >= 4) return '#f59e0b'; // amber\n      if (riskLevel >= 2) return '#eab308'; // yellow\n      return '#22c55e'; // green\n    }\n\n    /**\r\n     * Format date for display\r\n     */\n    function formatDate(dateString) {\n      if (!dateString) return 'N/A';\n      try {\n        const date = new Date(dateString);\n        return date.toLocaleDateString('en-US', {\n          year: 'numeric',\n          month: 'short',\n          day: 'numeric'\n        });\n      } catch (e) {\n        return dateString;\n      }\n    }\n\n    /**\r\n     * Fetch disaster predictions from API\r\n     */\n    async function fetchDisasterPredictions() {\n      predictionsLoading.value = true;\n      try {\n        const response = await residentPredictionsService.getDisasterPredictions();\n\n        // Handle paginated or array responses like in DisasterPredictionsList.vue\n        let predictionsData = response.data;\n        if (predictionsData && predictionsData.data) {\n          // Paginated response\n          predictionsData = predictionsData.data;\n        } else if (!Array.isArray(predictionsData)) {\n          // Not an array, set to empty\n          predictionsData = [];\n        }\n        disasterPredictions.value = Array.isArray(predictionsData) ? predictionsData.map(normalizePrediction) : [];\n        console.log('[EvacuationAreaList] Loaded disaster predictions:', disasterPredictions.value.length);\n      } catch (err) {\n        console.error('[EvacuationAreaList] Error fetching disaster predictions:', err);\n        disasterPredictions.value = [];\n      } finally {\n        predictionsLoading.value = false;\n      }\n    }\n\n    /**\r\n     * Normalize prediction data to match frontend expectations\r\n     */\n    function normalizePrediction(p) {\n      const disaster_type = p.disaster_type ?? p.disasterType ?? p.type ?? '';\n      const risk_level = p.risk_level ?? p.riskLevel ?? p.risk ?? 0;\n      const location_name = p.location_name ?? p.location ?? 'Unknown Location';\n      const latitude = p.latitude ?? 14.5995; // Default Manila coordinates\n      const longitude = p.longitude ?? 120.9842;\n      const probability = p.probability ?? p.confidence ?? 0;\n      const predicted_date = p.predicted_date ?? p.predicted_at ?? null;\n      const predicted_recovery_days = p.predicted_recovery_days ?? p.recoveryDays ?? null;\n      return {\n        ...p,\n        disaster_type,\n        risk_level,\n        location_name,\n        latitude,\n        longitude,\n        probability,\n        predicted_date,\n        predicted_recovery_days\n      };\n    }\n\n    /**\r\n     * Fetch all evacuation areas from API\r\n     */\n    async function fetchAreas() {\n      loading.value = true;\n      error.value = null;\n      try {\n        const response = await residentEvacuationService.getAvailableAreas();\n\n        // Handle array or wrapped responses\n        let areasData = response;\n        if (response && typeof response === 'object' && !Array.isArray(response)) {\n          areasData = response.data || response.evacuationAreas || [];\n        }\n        areas.value = Array.isArray(areasData) ? areasData : [];\n\n        // Normalize numeric fields to avoid runtime template errors (toFixed expects Number)\n        areas.value = areas.value.map(a => {\n          const area = {\n            ...a\n          };\n          area.risk_score = area.risk_score === null || area.risk_score === undefined ? 0 : Number(area.risk_score);\n          if (Number.isNaN(area.risk_score)) area.risk_score = 0;\n          area.final_score = area.final_score === null || area.final_score === undefined ? 0 : Number(area.final_score);\n          if (Number.isNaN(area.final_score)) area.final_score = 0;\n          area.capacity = area.capacity === null || area.capacity === undefined ? 0 : Number(area.capacity);\n          if (Number.isNaN(area.capacity)) area.capacity = 0;\n          area.current_occupancy = area.current_occupancy === null || area.current_occupancy === undefined ? 0 : Number(area.current_occupancy);\n          if (Number.isNaN(area.current_occupancy)) area.current_occupancy = 0;\n          area.capacity_score = area.capacity_score === null || area.capacity_score === undefined ? 0 : Number(area.capacity_score);\n          if (Number.isNaN(area.capacity_score)) area.capacity_score = 0;\n          area.distance_score = area.distance_score === null || area.distance_score === undefined ? 0 : Number(area.distance_score);\n          if (Number.isNaN(area.distance_score)) area.distance_score = 0;\n          return area;\n        });\n\n        // Add mock lat/lng coordinates for areas that don't have them\n        areas.value = areas.value.map(area => {\n          if (!area.latitude || !area.longitude) {\n            // Base coordinates around Manila, Philippines with small variations\n            const baseLat = 14.5995;\n            const baseLng = 120.9842;\n            const variation = 0.01; // ~1km variation\n\n            area.latitude = baseLat + (Math.random() - 0.5) * variation;\n            area.longitude = baseLng + (Math.random() - 0.5) * variation;\n          }\n          return area;\n        });\n\n        // Set top recommended area (highest final_score)\n        topArea.value = areas.value.length > 0 ? areas.value.slice().sort((a, b) => (b.final_score || 0) - (a.final_score || 0))[0] : null;\n        console.log('[EvacuationAreaList] Loaded areas:', areas.value.length);\n      } catch (err) {\n        console.error('[EvacuationAreaList] Error fetching areas:', err);\n        error.value = err.response?.data?.message || err.message || 'Failed to load evacuation areas';\n      } finally {\n        loading.value = false;\n      }\n    }\n\n    /**\r\n     * Get user location using Geolocation API\r\n     */\n    function getLocation() {\n      locationStatus.value = 'Getting location...';\n      if (!navigator.geolocation) {\n        locationStatus.value = 'Geolocation not supported by this browser';\n        return;\n      }\n      navigator.geolocation.getCurrentPosition(pos => {\n        const lat = pos.coords.latitude;\n        const lng = pos.coords.longitude;\n        userLocation.value = {\n          lat,\n          lng\n        };\n        locationStatus.value = `Lat ${lat.toFixed(6)}, Lng ${lng.toFixed(6)}`;\n\n        // Fetch prescriptive data for the new location\n        watchUserLocation();\n      }, err => {\n        locationStatus.value = `Error: ${err.message}`;\n      });\n    }\n\n    /**\r\n     * Navigate to evacuation area detail page\r\n     */\n    function goToAreaDetail(areaId) {\n      router.push(`/resident_pages/evacuation-areas/${areaId}`);\n    }\n\n    /**\r\n     * Initialize map\r\n     */\n    function initializeMap() {\n      if (map) return; // Already initialized\n\n      // Fix Leaflet icon paths to use absolute URLs from root\n      delete L.Icon.Default.prototype._getIconUrl;\n      L.Icon.Default.mergeOptions({\n        iconUrl: '/marker-icon.png',\n        shadowUrl: '/marker-shadow.png'\n      });\n\n      // Default center (Manila, Philippines)\n      const defaultCenter = [14.5995, 120.9842];\n      map = L.map('map').setView(defaultCenter, 10);\n\n      // Add OpenStreetMap tiles\n      L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {\n        attribution: '¬© OpenStreetMap contributors',\n        maxZoom: 18\n      }).addTo(map);\n\n      // Mark map as initialized\n      mapInitialized = true;\n      console.log('[EvacuationAreaList] Map initialized successfully');\n    }\n\n    /**\r\n     * Update area markers on map with debouncing and initialization checks\r\n     */\n    function updateAreaMarkers() {\n      // Clear any existing timeout\n      if (updateTimeout) {\n        clearTimeout(updateTimeout);\n      }\n\n      // Debounce updates to prevent rapid firing\n      updateTimeout = setTimeout(() => {\n        updateAreaMarkersImmediate();\n      }, 300); // 300ms debounce\n    }\n\n    /**\r\n     * Immediate marker update function (called after debouncing)\r\n     */\n    function updateAreaMarkersImmediate() {\n      // Check if map is initialized\n      if (!map || !mapInitialized) {\n        console.log('[EvacuationAreaList] Map not initialized, skipping marker update');\n        return;\n      }\n      console.log('[EvacuationAreaList] Updating markers:', areas.value.length, 'areas,', disasterPredictions.value.length, 'predictions');\n\n      // Clear existing markers more efficiently\n      areaMarkers.forEach(marker => {\n        if (map.hasLayer(marker)) {\n          map.removeLayer(marker);\n        }\n      });\n      areaMarkers = [];\n      predictionMarkers.forEach(marker => {\n        if (map.hasLayer(marker)) {\n          map.removeLayer(marker);\n        }\n      });\n      predictionMarkers = [];\n\n      // Add evacuation area markers\n      areas.value.forEach(area => {\n        if (area.latitude && area.longitude) {\n          const marker = L.marker([area.latitude, area.longitude]).addTo(map).bindPopup(`\n          <div style=\"min-width: 200px;\">\n            <strong>${area.name}</strong><br>\n            <span style=\"color: #666;\">${area.address}</span><br>\n            <span><strong>Capacity:</strong> ${area.capacity}</span><br>\n            <span><strong>Risk Score:</strong> ${area.risk_score?.toFixed(1) || 'N/A'}</span><br>\n            <span><strong>Available:</strong> ${(area.capacity || 0) - (area.current_occupancy || 0)}</span><br>\n            <button onclick=\"window.viewAreaDetail(${area.id})\" style=\"margin-top: 8px; padding: 4px 8px; background: #667eea; color: white; border: none; border-radius: 4px; cursor: pointer;\">View Details</button>\n            ${userLocation.value ? `<button onclick=\"window.getRouteDirections(${area.latitude}, ${area.longitude}, '${area.name.replace(/'/g, \"\\\\'\")}')\" style=\"margin-top: 8px; margin-left: 4px; padding: 4px 8px; background: #28a745; color: white; border: none; border-radius: 4px; cursor: pointer;\">Show Route</button>` : ''}\n          </div>\n        `);\n          areaMarkers.push(marker);\n        }\n      });\n\n      // Add disaster prediction markers\n      disasterPredictions.value.forEach(prediction => {\n        if (prediction.latitude && prediction.longitude) {\n          const disasterType = prediction.disaster_type?.toLowerCase() || 'unknown';\n          const riskLevel = parseInt(prediction.risk_level || 0, 10);\n\n          // Get marker color based on disaster type\n          const markerColor = getDisasterMarkerColor(disasterType);\n\n          // Create custom icon\n          const customIcon = L.divIcon({\n            className: 'custom-disaster-marker',\n            html: `<div style=\"background-color: ${markerColor}; border: 2px solid white; border-radius: 50%; width: 24px; height: 24px; display: flex; align-items: center; justify-content: center; color: white; font-weight: bold; font-size: 12px; box-shadow: 0 2px 4px rgba(0,0,0,0.3);\">${getDisasterIcon(disasterType)}</div>`,\n            iconSize: [24, 24],\n            iconAnchor: [12, 12]\n          });\n          const marker = L.marker([prediction.latitude, prediction.longitude], {\n            icon: customIcon\n          }).addTo(map).bindPopup(`\n          <div style=\"min-width: 250px;\">\n            <strong style=\"color: ${markerColor};\">${prediction.disaster_type || 'Unknown Disaster'}</strong><br>\n            <span style=\"color: #666;\">${prediction.location_name || prediction.location || 'Unknown Location'}</span><br>\n            <span><strong>Risk Level:</strong> ${prediction.risk_level || 'N/A'}/10</span><br>\n            <span><strong>Expected:</strong> ${formatDate(prediction.predicted_date || prediction.predicted_at)}</span><br>\n            <span><strong>Confidence:</strong> ${prediction.probability || 'N/A'}%</span><br>\n            <span><strong>Recovery:</strong> ${prediction.predicted_recovery_days || 'N/A'} days</span><br>\n            <button onclick=\"window.viewPredictionDetail(${prediction.id})\" style=\"margin-top: 8px; padding: 4px 8px; background: #dc3545; color: white; border: none; border-radius: 4px; cursor: pointer;\">View Details</button>\n          </div>\n        `);\n\n          // Add risk circle\n          const circleColor = getRiskCircleColor(riskLevel);\n          L.circle([prediction.latitude, prediction.longitude], {\n            color: circleColor,\n            fillColor: circleColor,\n            fillOpacity: 0.2,\n            radius: Math.max(500, riskLevel * 200),\n            weight: 2\n          }).addTo(map);\n          predictionMarkers.push(marker);\n        }\n      });\n\n      // Fit map to show all markers only if we have markers\n      const allMarkers = [...areaMarkers, ...predictionMarkers];\n      if (allMarkers.length > 0) {\n        try {\n          const group = new L.featureGroup(allMarkers);\n          map.fitBounds(group.getBounds().pad(0.1));\n        } catch (error) {\n          console.warn('[EvacuationAreaList] Could not fit bounds:', error);\n        }\n      }\n    }\n\n    /**\r\n     * Fetch prescriptive analytics data\r\n     */\n    async function fetchPrescriptiveData() {\n      if (!userLocation.value) return;\n      try {\n        const response = await residentEvacuationService.getRecommendedArea(userLocation.value.lat, userLocation.value.lng, predictedEvacuees.value);\n        prescriptiveData.value = response;\n        console.log('[EvacuationAreaList] Prescriptive data loaded:', response);\n      } catch (err) {\n        console.error('[EvacuationAreaList] Error fetching prescriptive data:', err);\n      }\n    }\n\n    /**\r\n     * Watch for user location changes to fetch prescriptive data\r\n     */\n    function watchUserLocation() {\n      if (userLocation.value) {\n        fetchPrescriptiveData();\n      }\n    }\n\n    /**\r\n     * Initialize on mount\r\n     */\n    onMounted(async () => {\n      await fetchAreas();\n      await fetchDisasterPredictions();\n      initializeMap();\n      updateAreaMarkers();\n      initializeGlobalFunctions();\n\n      // Watch for user location changes\n      watch(userLocation, () => {\n        watchUserLocation();\n      });\n\n      // Watch for data changes to update markers\n      watch(areas, () => {\n        updateAreaMarkers();\n      });\n      watch(disasterPredictions, () => {\n        updateAreaMarkers();\n      });\n    });\n\n    /**\r\n     * Close route directions panel\r\n     */\n    function closeRouteDirections() {\n      showRouteDirections.value = false;\n      selectedArea.value = null;\n      routeDirections.value = [];\n      routeDistance.value = '';\n      routeTime.value = '';\n\n      // Remove routing control from map\n      if (routingControl) {\n        map.removeControl(routingControl);\n        routingControl = null;\n      }\n    }\n\n    /**\r\n     * Get route directions to an evacuation area\r\n     */\n    function getRouteDirections(lat, lng, name) {\n      if (!userLocation.value) {\n        alert('Please get your location first to view directions.');\n        return;\n      }\n      selectedArea.value = {\n        latitude: lat,\n        longitude: lng,\n        name\n      };\n      showRouteDirections.value = true;\n      routeDirections.value = [];\n      routeDistance.value = 'Calculating...';\n      routeTime.value = 'Calculating...';\n\n      // Remove existing routing control\n      if (routingControl) {\n        map.removeControl(routingControl);\n      }\n\n      // Create new routing control\n      routingControl = L.Routing.control({\n        waypoints: [L.latLng(userLocation.value.lat, userLocation.value.lng), L.latLng(lat, lng)],\n        routeWhileDragging: false,\n        createMarker: () => null,\n        // Don't create default markers\n        lineOptions: {\n          styles: [{\n            color: '#667eea',\n            weight: 6,\n            opacity: 0.8\n          }]\n        },\n        show: false,\n        // Hide the default instructions panel\n        addWaypoints: false\n      }).addTo(map);\n\n      // Listen for route found event\n      routingControl.on('routesfound', e => {\n        const routes = e.routes;\n        const route = routes[0];\n\n        // Extract route information\n        routeDistance.value = `${(route.summary.totalDistance / 1000).toFixed(2)} km`;\n        routeTime.value = `${Math.round(route.summary.totalTime / 60)} min`;\n\n        // Extract step-by-step instructions\n        routeDirections.value = route.instructions.map(instruction => ({\n          instruction: instruction.text\n        }));\n        console.log('[EvacuationAreaList] Route calculated:', {\n          distance: routeDistance.value,\n          time: routeTime.value,\n          steps: routeDirections.value.length\n        });\n      });\n\n      // Handle routing errors\n      routingControl.on('routingerror', e => {\n        console.error('[EvacuationAreaList] Routing error:', e);\n        routeDistance.value = 'Error calculating route';\n        routeTime.value = 'Error calculating route';\n        routeDirections.value = [{\n          instruction: 'Unable to calculate route. Please try again.'\n        }];\n      });\n    }\n\n    /**\r\n     * Initialize global window functions for marker popups\r\n     */\n    function initializeGlobalFunctions() {\n      window.viewAreaDetail = areaId => {\n        goToAreaDetail(areaId);\n      };\n      window.getRouteDirections = (lat, lng, name) => {\n        getRouteDirections(lat, lng, name);\n      };\n    }\n\n    /**\r\n     * Cleanup on unmount\r\n     */\n    onUnmounted(() => {\n      if (map) {\n        map.remove();\n        map = null;\n      }\n\n      // Clean up routing control\n      if (routingControl) {\n        routingControl = null;\n      }\n    });\n    const __returned__ = {\n      router,\n      areas,\n      loading,\n      error,\n      disasterPredictions,\n      predictionsLoading,\n      predictedEvacuees,\n      topArea,\n      prescriptiveData,\n      userLocation,\n      locationStatus,\n      get map() {\n        return map;\n      },\n      set map(v) {\n        map = v;\n      },\n      get areaMarkers() {\n        return areaMarkers;\n      },\n      set areaMarkers(v) {\n        areaMarkers = v;\n      },\n      get predictionMarkers() {\n        return predictionMarkers;\n      },\n      set predictionMarkers(v) {\n        predictionMarkers = v;\n      },\n      get updateTimeout() {\n        return updateTimeout;\n      },\n      set updateTimeout(v) {\n        updateTimeout = v;\n      },\n      get mapInitialized() {\n        return mapInitialized;\n      },\n      set mapInitialized(v) {\n        mapInitialized = v;\n      },\n      showRouteDirections,\n      selectedArea,\n      routeDirections,\n      routeDistance,\n      routeTime,\n      get routingControl() {\n        return routingControl;\n      },\n      set routingControl(v) {\n        routingControl = v;\n      },\n      capitalizeFirst,\n      getStatusBadgeClass,\n      getHazardBadgeClass,\n      getSafetyFactorClass,\n      getPredictionSeverityClass,\n      getDisasterMarkerColor,\n      getDisasterIcon,\n      getRiskCircleColor,\n      formatDate,\n      fetchDisasterPredictions,\n      normalizePrediction,\n      fetchAreas,\n      getLocation,\n      goToAreaDetail,\n      initializeMap,\n      updateAreaMarkers,\n      updateAreaMarkersImmediate,\n      fetchPrescriptiveData,\n      watchUserLocation,\n      closeRouteDirections,\n      getRouteDirections,\n      initializeGlobalFunctions,\n      ref,\n      onMounted,\n      onUnmounted,\n      watch,\n      get useRouter() {\n        return useRouter;\n      },\n      get residentEvacuationService() {\n        return residentEvacuationService;\n      },\n      get residentPredictionsService() {\n        return residentPredictionsService;\n      },\n      get L() {\n        return L;\n      }\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["ref","onMounted","onUnmounted","watch","useRouter","residentEvacuationService","residentPredictionsService","L","router","areas","loading","error","disasterPredictions","predictionsLoading","predictedEvacuees","topArea","prescriptiveData","userLocation","locationStatus","map","areaMarkers","predictionMarkers","updateTimeout","mapInitialized","showRouteDirections","selectedArea","routeDirections","routeDistance","routeTime","routingControl","capitalizeFirst","str","charAt","toUpperCase","slice","getStatusBadgeClass","status","classMap","getHazardBadgeClass","riskScore","getSafetyFactorClass","safetyFactor","getPredictionSeverityClass","severity","severityMap","toLowerCase","getDisasterMarkerColor","disasterType","colorMap","getDisasterIcon","iconMap","getRiskCircleColor","riskLevel","formatDate","dateString","date","Date","toLocaleDateString","year","month","day","e","fetchDisasterPredictions","value","response","getDisasterPredictions","predictionsData","data","Array","isArray","normalizePrediction","console","log","length","err","p","disaster_type","type","risk_level","risk","location_name","location","latitude","longitude","probability","confidence","predicted_date","predicted_at","predicted_recovery_days","recoveryDays","fetchAreas","getAvailableAreas","areasData","evacuationAreas","a","area","risk_score","undefined","Number","isNaN","final_score","capacity","current_occupancy","capacity_score","distance_score","baseLat","baseLng","variation","Math","random","sort","b","message","getLocation","navigator","geolocation","getCurrentPosition","pos","lat","coords","lng","toFixed","watchUserLocation","goToAreaDetail","areaId","push","initializeMap","Icon","Default","prototype","_getIconUrl","mergeOptions","iconUrl","shadowUrl","defaultCenter","setView","tileLayer","attribution","maxZoom","addTo","updateAreaMarkers","clearTimeout","setTimeout","updateAreaMarkersImmediate","forEach","marker","hasLayer","removeLayer","bindPopup","name","address","id","replace","prediction","parseInt","markerColor","customIcon","divIcon","className","html","iconSize","iconAnchor","icon","circleColor","circle","color","fillColor","fillOpacity","radius","max","weight","allMarkers","group","featureGroup","fitBounds","getBounds","pad","warn","fetchPrescriptiveData","getRecommendedArea","initializeGlobalFunctions","closeRouteDirections","removeControl","getRouteDirections","alert","Routing","control","waypoints","latLng","routeWhileDragging","createMarker","lineOptions","styles","opacity","show","addWaypoints","on","routes","route","summary","totalDistance","round","totalTime","instructions","instruction","text","distance","time","steps","window","viewAreaDetail","remove"],"sources":["C:/VUEprojects/crud-app/src/pages/resident_pages/EvacuationAreaList.vue"],"sourcesContent":["<template>\r\n  <div class=\"evac-list\">\r\n    <!-- Header -->\r\n    <div class=\"card\">\r\n      <div class=\"card-header\">üó∫Ô∏è Evacuation Areas & Disaster Predictions Map</div>\r\n\r\n      <!-- Map Container -->\r\n      <div class=\"map-container\">\r\n        <div id=\"map\" class=\"map\"></div>\r\n\r\n        <!-- Route Directions Panel -->\r\n        <div v-if=\"showRouteDirections\" class=\"route-panel\">\r\n          <div class=\"route-header\">\r\n            <h4>üõ£Ô∏è Route Directions</h4>\r\n            <button @click=\"closeRouteDirections\" class=\"close-btn\">√ó</button>\r\n          </div>\r\n          <div class=\"route-content\">\r\n            <div v-if=\"routeDirections.length > 0\">\r\n              <div class=\"route-info\">\r\n                <strong>From:</strong> Your Location<br>\r\n                <strong>To:</strong> {{ selectedArea?.name }}<br>\r\n                <strong>Distance:</strong> {{ routeDistance }}<br>\r\n                <strong>Estimated Time:</strong> {{ routeTime }}\r\n              </div>\r\n              <div class=\"route-steps\">\r\n                <ol>\r\n                  <li v-for=\"(step, index) in routeDirections\" :key=\"index\">\r\n                    {{ step.instruction }}\r\n                  </li>\r\n                </ol>\r\n              </div>\r\n            </div>\r\n            <div v-else class=\"route-loading\">\r\n              Calculating route...\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      <!-- Location Status -->\r\n      <div class=\"location-status-box\">\r\n        <h4>üìç Your Location</h4>\r\n        <div class=\"loc-controls\">\r\n          <button class=\"btn btn-success\" @click=\"getLocation\">Get My Location</button>\r\n        </div>\r\n        <div class=\"muted\">{{ locationStatus }}</div>\r\n      </div>\r\n    </div>\r\n\r\n    <!-- Disaster Predictions Section -->\r\n    <div class=\"card\">\r\n      <div class=\"card-header\">üå™Ô∏è Active Disaster Predictions</div>\r\n\r\n      <!-- Loading State -->\r\n      <div v-if=\"predictionsLoading\" class=\"center py-4\">\r\n        <div class=\"spinner-border\" role=\"status\">\r\n          <span class=\"sr-only\">Loading predictions...</span>\r\n        </div>\r\n        <p class=\"mt-2\">Loading disaster predictions‚Ä¶</p>\r\n      </div>\r\n\r\n      <!-- Predictions List -->\r\n      <div v-else-if=\"disasterPredictions.length > 0\" class=\"predictions-grid\">\r\n        <div\r\n          v-for=\"prediction in disasterPredictions.slice(0, 3)\"\r\n          :key=\"prediction.id\"\r\n          class=\"prediction-card\"\r\n          :class=\"getPredictionSeverityClass(prediction.severity)\"\r\n        >\r\n          <div class=\"prediction-header\">\r\n            <h4>{{ prediction.disaster_type }}</h4>\r\n            <span class=\"severity-badge\" :class=\"getPredictionSeverityClass(prediction.severity)\">\r\n              {{ prediction.severity }}\r\n            </span>\r\n          </div>\r\n          <div class=\"prediction-body\">\r\n            <div class=\"prediction-detail\">\r\n              <strong>Location:</strong> {{ prediction.location_name }}\r\n            </div>\r\n            <div class=\"prediction-detail\">\r\n              <strong>Expected Date:</strong> {{ formatDate(prediction.predicted_date || prediction.predicted_at) }}\r\n            </div>\r\n           \r\n            <div class=\"prediction-detail\">\r\n              <strong>Risk Level:</strong> {{ prediction.risk_level }}/10\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      <!-- Empty State -->\r\n      <div v-else class=\"muted p-3\">No active disaster predictions available.</div>\r\n\r\n      <!-- View All Link -->\r\n      <div v-if=\"disasterPredictions.length > 3\" class=\"text-center p-3\">\r\n        <router-link to=\"/resident_pages/disaster-predictions\" class=\"btn btn-secondary\">\r\n          View All Predictions ‚Üí\r\n        </router-link>\r\n      </div>\r\n    </div>\r\n\r\n    <!-- Prescriptive Analytics Section -->\r\n    <div class=\"analytics-section\">\r\n      <!-- Top Recommendation Card -->\r\n      <div class=\"card prescriptive card-shadow\">\r\n        <div class=\"prescriptive-header\">\r\n          <!-- Left: Predicted Evacuees -->\r\n          <div class=\"pred-left\">\r\n            <h2>üìä Prescriptive Analytics</h2>\r\n            <div class=\"small\">Predicted Evacuees</div>\r\n            <div class=\"big\">{{ predictedEvacuees }}</div>\r\n          </div>\r\n\r\n          <!-- Right: Top Recommended Area -->\r\n          <div class=\"pred-right\">\r\n            <div class=\"small\">Recommended Evacuation Area (Top Score)</div>\r\n            <div v-if=\"topArea\" class=\"top-area\">\r\n              <div class=\"name\">\r\n                {{ topArea.name }}\r\n                <small class=\"addr\">- {{ topArea.address }}</small>\r\n              </div>\r\n              <div class=\"meta\">\r\n                Risk: <strong>{{ (topArea.risk_score || 0).toFixed(1) }}</strong> ¬∑\r\n                Final Score: <strong>{{ (topArea.final_score || 0).toFixed(1) }}</strong> ¬∑\r\n                Remaining: <strong>{{ (topArea.capacity || 0) - (topArea.current_occupancy || 0) }}</strong>\r\n              </div>\r\n              <button\r\n                class=\"btn btn-primary mt-8\"\r\n                @click=\"goToAreaDetail(topArea.id)\"\r\n              >\r\n                View Details ‚Üí\r\n              </button>\r\n            </div>\r\n            <div v-else class=\"small muted\">No recommended area available</div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      <!-- Allocations Table (if available) -->\r\n      <div v-if=\"prescriptiveData?.allocations?.length\" class=\"card\">\r\n        <div class=\"card-header\">üìç Recommended Allocations</div>\r\n        <div class=\"table-responsive\">\r\n          <table class=\"table table-custom\">\r\n            <thead>\r\n              <tr>\r\n                <th>Evacuation Area</th>\r\n                <th class=\"text-center\">Assigned Evacuees</th>\r\n                <th class=\"text-center\">Remaining Capacity</th>\r\n                <th class=\"text-center\">Distance (km)</th>\r\n                <th class=\"text-center\">Safety Factor</th>\r\n                <th class=\"text-center\">Final Score</th>\r\n              </tr>\r\n            </thead>\r\n            <tbody>\r\n              <tr v-for=\"alloc in prescriptiveData.allocations\" :key=\"alloc.evacuation_area_id\">\r\n                <td>\r\n                  <strong>{{ alloc.name }}</strong>\r\n                </td>\r\n                <td class=\"text-center\">\r\n                  <span class=\"badge badge-success\">{{ alloc.assigned || 0 }} people</span>\r\n                </td>\r\n                <td class=\"text-center\">\r\n                  <span>{{ alloc.capacity_left || 0 }} people</span>\r\n                </td>\r\n                <td class=\"text-center\">\r\n                  {{ alloc.distance ? alloc.distance.toFixed(2) : 'N/A' }}\r\n                </td>\r\n                <td class=\"text-center\">\r\n                  <span :class=\"['hazard-badge', getSafetyFactorClass(alloc.safety_factor || 0)]\">\r\n                    {{ (alloc.safety_factor || 0).toFixed(2) }}\r\n                  </span>\r\n                </td>\r\n                <td class=\"text-center\">\r\n                  <strong>{{ (alloc.final_score || 0).toFixed(1) }}</strong>\r\n                </td>\r\n              </tr>\r\n            </tbody>\r\n          </table>\r\n        </div>\r\n      </div>\r\n    </div>\r\n\r\n    <!-- Evacuation Areas List -->\r\n    <div class=\"card\">\r\n      <div class=\"card-header\">üìã Evacuation Areas List</div>\r\n\r\n      <!-- Loading State -->\r\n      <div v-if=\"loading\" class=\"center py-4\">\r\n        <div class=\"spinner-border\" role=\"status\">\r\n          <span class=\"sr-only\">Loading...</span>\r\n        </div>\r\n        <p class=\"mt-2\">Loading evacuation areas‚Ä¶</p>\r\n      </div>\r\n\r\n      <!-- Error State -->\r\n      <div v-else-if=\"error\" class=\"error-msg p-3\">\r\n        <strong>Error:</strong> {{ error }}\r\n      </div>\r\n\r\n      <!-- Areas Table -->\r\n      <div v-else-if=\"areas.length > 0\" class=\"table-responsive\">\r\n        <table class=\"table table-custom\">\r\n          <thead>\r\n            <tr>\r\n              <th>Name</th>\r\n              <th>Address</th>\r\n              <th class=\"text-center\">Capacity</th>\r\n              <th class=\"text-center\">Current</th>\r\n              <th class=\"text-center\">Available</th>\r\n              <th class=\"text-center\">Status</th>\r\n              <th class=\"text-center\">Risk Score</th>\r\n              <th class=\"text-center\">Final Score</th>\r\n              <th class=\"text-center\">Action</th>\r\n            </tr>\r\n          </thead>\r\n          <tbody>\r\n            <tr v-for=\"area in areas\" :key=\"area.id\">\r\n              <td>\r\n                <strong>{{ area.name }}</strong>\r\n              </td>\r\n              <td>{{ area.address }}</td>\r\n              <td class=\"text-center\">{{ area.capacity || '‚Äî' }}</td>\r\n              <td class=\"text-center\">{{ area.current_occupancy || 0 }}</td>\r\n              <td class=\"text-center\">\r\n                <strong>{{ (area.capacity || 0) - (area.current_occupancy || 0) }}</strong>\r\n              </td>\r\n              <td class=\"text-center\">\r\n                <span :class=\"['badge-custom', getStatusBadgeClass(area.status)]\">\r\n                  {{ capitalizeFirst(area.status) }}\r\n                </span>\r\n              </td>\r\n              <td class=\"text-center\">\r\n                <span :class=\"['hazard-badge', getHazardBadgeClass(area.risk_score || 0)]\">\r\n                  {{ (area.risk_score || 0).toFixed(1) }}\r\n                </span>\r\n              </td>\r\n              <td class=\"text-center\">\r\n                <strong style=\"color: #667eea;\">{{ (area.final_score || 0).toFixed(1) }}</strong>\r\n              </td>\r\n              <td class=\"text-center\">\r\n                <button\r\n                  class=\"btn btn-primary btn-sm\"\r\n                  @click=\"goToAreaDetail(area.id)\"\r\n                >\r\n                  View\r\n                </button>\r\n              </td>\r\n            </tr>\r\n          </tbody>\r\n        </table>\r\n      </div>\r\n\r\n      <!-- Empty State -->\r\n      <div v-else class=\"muted p-3\">No evacuation areas found.</div>\r\n    </div>\r\n\r\n\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, onMounted, onUnmounted, watch } from 'vue';\r\nimport { useRouter } from 'vue-router';\r\nimport { residentEvacuationService, residentPredictionsService } from '@/services/residentService';\r\nimport L from 'leaflet';\r\nimport 'leaflet/dist/leaflet.css';\r\nimport 'leaflet-routing-machine';\r\nimport 'leaflet-routing-machine/dist/leaflet-routing-machine.css';\r\n\r\nconst router = useRouter();\r\n\r\n// ============ DATA ============\r\nconst areas = ref([]);\r\nconst loading = ref(true);\r\nconst error = ref(null);\r\n\r\n// Disaster predictions\r\nconst disasterPredictions = ref([]);\r\nconst predictionsLoading = ref(true);\r\n\r\n// Prescriptive analytics\r\nconst predictedEvacuees = ref(29.41);\r\nconst topArea = ref(null);\r\nconst prescriptiveData = ref(null);\r\n\r\n// User location\r\nconst userLocation = ref(null);\r\nconst locationStatus = ref('');\r\n\r\n// Map instance\r\nlet map = null;\r\nlet areaMarkers = [];\r\nlet predictionMarkers = [];\r\nlet updateTimeout = null;\r\nlet mapInitialized = false;\r\n\r\n// Route directions\r\nconst showRouteDirections = ref(false);\r\nconst selectedArea = ref(null);\r\nconst routeDirections = ref([]);\r\nconst routeDistance = ref('');\r\nconst routeTime = ref('');\r\n\r\n// Routing control\r\nlet routingControl = null;\r\n\r\n// Add location modal (removed - residents cannot create evacuation areas)\r\n\r\n// ============ METHODS ============\r\n\r\n/**\r\n * Capitalize first letter of a string\r\n */\r\nfunction capitalizeFirst(str) {\r\n  if (!str) return '';\r\n  return str.charAt(0).toUpperCase() + str.slice(1);\r\n}\r\n\r\n/**\r\n * Get status badge CSS class\r\n */\r\nfunction getStatusBadgeClass(status) {\r\n  const classMap = {\r\n    'available': 'badge-success',\r\n    'full': 'badge-danger',\r\n    'closed': 'badge-warning',\r\n    'pending': 'badge-warning'\r\n  };\r\n  return classMap[status] || 'badge-warning';\r\n}\r\n\r\n/**\r\n * Get hazard badge class based on risk score\r\n */\r\nfunction getHazardBadgeClass(riskScore) {\r\n  if (!riskScore) riskScore = 0;\r\n  if (riskScore >= 8) return 'hazard-critical';\r\n  if (riskScore >= 6) return 'hazard-high';\r\n  if (riskScore >= 4) return 'hazard-moderate';\r\n  return 'hazard-low';\r\n}\r\n\r\n/**\r\n * Get safety factor badge class\r\n */\r\nfunction getSafetyFactorClass(safetyFactor) {\r\n  if (!safetyFactor) safetyFactor = 0;\r\n  if (safetyFactor >= 0.8) return 'hazard-low';\r\n  if (safetyFactor >= 0.6) return 'hazard-moderate';\r\n  if (safetyFactor >= 0.4) return 'hazard-high';\r\n  return 'hazard-critical';\r\n}\r\n\r\n/**\r\n * Get prediction severity class\r\n */\r\nfunction getPredictionSeverityClass(severity) {\r\n  const severityMap = {\r\n    'low': 'severity-low',\r\n    'moderate': 'severity-moderate',\r\n    'high': 'severity-high',\r\n    'critical': 'severity-critical'\r\n  };\r\n  return severityMap[severity?.toLowerCase()] || 'severity-moderate';\r\n}\r\n\r\n/**\r\n * Get disaster marker color based on disaster type\r\n */\r\nfunction getDisasterMarkerColor(disasterType) {\r\n  const colorMap = {\r\n    'flood': '#1e40af', // blue\r\n    'earthquake': '#dc2626', // red\r\n    'typhoon': '#059669', // green\r\n    'unknown': '#6b7280' // gray\r\n  };\r\n  return colorMap[disasterType] || colorMap['unknown'];\r\n}\r\n\r\n/**\r\n * Get disaster icon based on disaster type\r\n */\r\nfunction getDisasterIcon(disasterType) {\r\n  const iconMap = {\r\n    'flood': 'üåä',\r\n    'earthquake': 'üåã',\r\n    'typhoon': 'üåÄ',\r\n    'unknown': '‚ö†Ô∏è'\r\n  };\r\n  return iconMap[disasterType] || iconMap['unknown'];\r\n}\r\n\r\n/**\r\n * Get risk circle color based on risk level\r\n */\r\nfunction getRiskCircleColor(riskLevel) {\r\n  if (riskLevel >= 8) return '#dc2626'; // red\r\n  if (riskLevel >= 6) return '#ea580c'; // orange\r\n  if (riskLevel >= 4) return '#f59e0b'; // amber\r\n  if (riskLevel >= 2) return '#eab308'; // yellow\r\n  return '#22c55e'; // green\r\n}\r\n\r\n/**\r\n * Format date for display\r\n */\r\nfunction formatDate(dateString) {\r\n  if (!dateString) return 'N/A';\r\n  try {\r\n    const date = new Date(dateString);\r\n    return date.toLocaleDateString('en-US', {\r\n      year: 'numeric',\r\n      month: 'short',\r\n      day: 'numeric'\r\n    });\r\n  } catch (e) {\r\n    return dateString;\r\n  }\r\n}\r\n\r\n/**\r\n * Fetch disaster predictions from API\r\n */\r\nasync function fetchDisasterPredictions() {\r\n  predictionsLoading.value = true;\r\n\r\n  try {\r\n    const response = await residentPredictionsService.getDisasterPredictions();\r\n\r\n    // Handle paginated or array responses like in DisasterPredictionsList.vue\r\n    let predictionsData = response.data;\r\n    if (predictionsData && predictionsData.data) {\r\n      // Paginated response\r\n      predictionsData = predictionsData.data;\r\n    } else if (!Array.isArray(predictionsData)) {\r\n      // Not an array, set to empty\r\n      predictionsData = [];\r\n    }\r\n\r\n    disasterPredictions.value = Array.isArray(predictionsData) ? predictionsData.map(normalizePrediction) : [];\r\n\r\n    console.log('[EvacuationAreaList] Loaded disaster predictions:', disasterPredictions.value.length);\r\n  } catch (err) {\r\n    console.error('[EvacuationAreaList] Error fetching disaster predictions:', err);\r\n    disasterPredictions.value = [];\r\n  } finally {\r\n    predictionsLoading.value = false;\r\n  }\r\n}\r\n\r\n/**\r\n * Normalize prediction data to match frontend expectations\r\n */\r\nfunction normalizePrediction(p) {\r\n  const disaster_type = p.disaster_type ?? p.disasterType ?? p.type ?? '';\r\n  const risk_level = p.risk_level ?? p.riskLevel ?? p.risk ?? 0;\r\n  const location_name = p.location_name ?? p.location ?? 'Unknown Location';\r\n  const latitude = p.latitude ?? 14.5995; // Default Manila coordinates\r\n  const longitude = p.longitude ?? 120.9842;\r\n  const probability = p.probability ?? p.confidence ?? 0;\r\n  const predicted_date = p.predicted_date ?? p.predicted_at ?? null;\r\n  const predicted_recovery_days = p.predicted_recovery_days ?? p.recoveryDays ?? null;\r\n\r\n  return {\r\n    ...p,\r\n    disaster_type,\r\n    risk_level,\r\n    location_name,\r\n    latitude,\r\n    longitude,\r\n    probability,\r\n    predicted_date,\r\n    predicted_recovery_days\r\n  };\r\n}\r\n\r\n/**\r\n * Fetch all evacuation areas from API\r\n */\r\nasync function fetchAreas() {\r\n  loading.value = true;\r\n  error.value = null;\r\n\r\n  try {\r\n    const response = await residentEvacuationService.getAvailableAreas();\r\n\r\n    // Handle array or wrapped responses\r\n    let areasData = response;\r\n    if (response && typeof response === 'object' && !Array.isArray(response)) {\r\n      areasData = response.data || response.evacuationAreas || [];\r\n    }\r\n\r\n    areas.value = Array.isArray(areasData) ? areasData : [];\r\n\r\n    // Normalize numeric fields to avoid runtime template errors (toFixed expects Number)\r\n    areas.value = areas.value.map(a => {\r\n      const area = { ...a };\r\n      area.risk_score = (area.risk_score === null || area.risk_score === undefined) ? 0 : Number(area.risk_score);\r\n      if (Number.isNaN(area.risk_score)) area.risk_score = 0;\r\n      area.final_score = (area.final_score === null || area.final_score === undefined) ? 0 : Number(area.final_score);\r\n      if (Number.isNaN(area.final_score)) area.final_score = 0;\r\n      area.capacity = (area.capacity === null || area.capacity === undefined) ? 0 : Number(area.capacity);\r\n      if (Number.isNaN(area.capacity)) area.capacity = 0;\r\n      area.current_occupancy = (area.current_occupancy === null || area.current_occupancy === undefined) ? 0 : Number(area.current_occupancy);\r\n      if (Number.isNaN(area.current_occupancy)) area.current_occupancy = 0;\r\n      area.capacity_score = (area.capacity_score === null || area.capacity_score === undefined) ? 0 : Number(area.capacity_score);\r\n      if (Number.isNaN(area.capacity_score)) area.capacity_score = 0;\r\n      area.distance_score = (area.distance_score === null || area.distance_score === undefined) ? 0 : Number(area.distance_score);\r\n      if (Number.isNaN(area.distance_score)) area.distance_score = 0;\r\n      return area;\r\n    });\r\n\r\n    // Add mock lat/lng coordinates for areas that don't have them\r\n    areas.value = areas.value.map((area) => {\r\n      if (!area.latitude || !area.longitude) {\r\n        // Base coordinates around Manila, Philippines with small variations\r\n        const baseLat = 14.5995;\r\n        const baseLng = 120.9842;\r\n        const variation = 0.01; // ~1km variation\r\n\r\n        area.latitude = baseLat + (Math.random() - 0.5) * variation;\r\n        area.longitude = baseLng + (Math.random() - 0.5) * variation;\r\n      }\r\n      return area;\r\n    });\r\n\r\n    // Set top recommended area (highest final_score)\r\n    topArea.value = areas.value.length > 0\r\n      ? areas.value\r\n          .slice()\r\n          .sort((a, b) => (b.final_score || 0) - (a.final_score || 0))[0]\r\n      : null;\r\n\r\n    console.log('[EvacuationAreaList] Loaded areas:', areas.value.length);\r\n  } catch (err) {\r\n    console.error('[EvacuationAreaList] Error fetching areas:', err);\r\n    error.value = err.response?.data?.message || err.message || 'Failed to load evacuation areas';\r\n  } finally {\r\n    loading.value = false;\r\n  }\r\n}\r\n\r\n/**\r\n * Get user location using Geolocation API\r\n */\r\nfunction getLocation() {\r\n  locationStatus.value = 'Getting location...';\r\n\r\n  if (!navigator.geolocation) {\r\n    locationStatus.value = 'Geolocation not supported by this browser';\r\n    return;\r\n  }\r\n\r\n  navigator.geolocation.getCurrentPosition(\r\n    (pos) => {\r\n      const lat = pos.coords.latitude;\r\n      const lng = pos.coords.longitude;\r\n\r\n      userLocation.value = { lat, lng };\r\n      locationStatus.value = `Lat ${lat.toFixed(6)}, Lng ${lng.toFixed(6)}`;\r\n\r\n      // Fetch prescriptive data for the new location\r\n      watchUserLocation();\r\n    },\r\n    (err) => {\r\n      locationStatus.value = `Error: ${err.message}`;\r\n    }\r\n  );\r\n}\r\n\r\n/**\r\n * Navigate to evacuation area detail page\r\n */\r\nfunction goToAreaDetail(areaId) {\r\n  router.push(`/resident_pages/evacuation-areas/${areaId}`);\r\n}\r\n\r\n/**\r\n * Initialize map\r\n */\r\nfunction initializeMap() {\r\n  if (map) return; // Already initialized\r\n\r\n  // Fix Leaflet icon paths to use absolute URLs from root\r\n  delete L.Icon.Default.prototype._getIconUrl;\r\n  L.Icon.Default.mergeOptions({\r\n    iconUrl: '/marker-icon.png',\r\n    shadowUrl: '/marker-shadow.png',\r\n  });\r\n\r\n  // Default center (Manila, Philippines)\r\n  const defaultCenter = [14.5995, 120.9842];\r\n\r\n  map = L.map('map').setView(defaultCenter, 10);\r\n\r\n  // Add OpenStreetMap tiles\r\n  L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {\r\n    attribution: '¬© OpenStreetMap contributors',\r\n    maxZoom: 18,\r\n  }).addTo(map);\r\n\r\n  // Mark map as initialized\r\n  mapInitialized = true;\r\n  console.log('[EvacuationAreaList] Map initialized successfully');\r\n}\r\n\r\n/**\r\n * Update area markers on map with debouncing and initialization checks\r\n */\r\nfunction updateAreaMarkers() {\r\n  // Clear any existing timeout\r\n  if (updateTimeout) {\r\n    clearTimeout(updateTimeout);\r\n  }\r\n\r\n  // Debounce updates to prevent rapid firing\r\n  updateTimeout = setTimeout(() => {\r\n    updateAreaMarkersImmediate();\r\n  }, 300); // 300ms debounce\r\n}\r\n\r\n/**\r\n * Immediate marker update function (called after debouncing)\r\n */\r\nfunction updateAreaMarkersImmediate() {\r\n  // Check if map is initialized\r\n  if (!map || !mapInitialized) {\r\n    console.log('[EvacuationAreaList] Map not initialized, skipping marker update');\r\n    return;\r\n  }\r\n\r\n  console.log('[EvacuationAreaList] Updating markers:', areas.value.length, 'areas,', disasterPredictions.value.length, 'predictions');\r\n\r\n  // Clear existing markers more efficiently\r\n  areaMarkers.forEach(marker => {\r\n    if (map.hasLayer(marker)) {\r\n      map.removeLayer(marker);\r\n    }\r\n  });\r\n  areaMarkers = [];\r\n\r\n  predictionMarkers.forEach(marker => {\r\n    if (map.hasLayer(marker)) {\r\n      map.removeLayer(marker);\r\n    }\r\n  });\r\n  predictionMarkers = [];\r\n\r\n  // Add evacuation area markers\r\n  areas.value.forEach(area => {\r\n    if (area.latitude && area.longitude) {\r\n      const marker = L.marker([area.latitude, area.longitude])\r\n        .addTo(map)\r\n        .bindPopup(`\r\n          <div style=\"min-width: 200px;\">\r\n            <strong>${area.name}</strong><br>\r\n            <span style=\"color: #666;\">${area.address}</span><br>\r\n            <span><strong>Capacity:</strong> ${area.capacity}</span><br>\r\n            <span><strong>Risk Score:</strong> ${area.risk_score?.toFixed(1) || 'N/A'}</span><br>\r\n            <span><strong>Available:</strong> ${(area.capacity || 0) - (area.current_occupancy || 0)}</span><br>\r\n            <button onclick=\"window.viewAreaDetail(${area.id})\" style=\"margin-top: 8px; padding: 4px 8px; background: #667eea; color: white; border: none; border-radius: 4px; cursor: pointer;\">View Details</button>\r\n            ${userLocation.value ? `<button onclick=\"window.getRouteDirections(${area.latitude}, ${area.longitude}, '${area.name.replace(/'/g, \"\\\\'\")}')\" style=\"margin-top: 8px; margin-left: 4px; padding: 4px 8px; background: #28a745; color: white; border: none; border-radius: 4px; cursor: pointer;\">Show Route</button>` : ''}\r\n          </div>\r\n        `);\r\n\r\n      areaMarkers.push(marker);\r\n    }\r\n  });\r\n\r\n  // Add disaster prediction markers\r\n  disasterPredictions.value.forEach(prediction => {\r\n    if (prediction.latitude && prediction.longitude) {\r\n      const disasterType = prediction.disaster_type?.toLowerCase() || 'unknown';\r\n      const riskLevel = parseInt(prediction.risk_level || 0, 10);\r\n\r\n      // Get marker color based on disaster type\r\n      const markerColor = getDisasterMarkerColor(disasterType);\r\n\r\n      // Create custom icon\r\n      const customIcon = L.divIcon({\r\n        className: 'custom-disaster-marker',\r\n        html: `<div style=\"background-color: ${markerColor}; border: 2px solid white; border-radius: 50%; width: 24px; height: 24px; display: flex; align-items: center; justify-content: center; color: white; font-weight: bold; font-size: 12px; box-shadow: 0 2px 4px rgba(0,0,0,0.3);\">${getDisasterIcon(disasterType)}</div>`,\r\n        iconSize: [24, 24],\r\n        iconAnchor: [12, 12]\r\n      });\r\n\r\n      const marker = L.marker([prediction.latitude, prediction.longitude], { icon: customIcon })\r\n        .addTo(map)\r\n        .bindPopup(`\r\n          <div style=\"min-width: 250px;\">\r\n            <strong style=\"color: ${markerColor};\">${prediction.disaster_type || 'Unknown Disaster'}</strong><br>\r\n            <span style=\"color: #666;\">${prediction.location_name || prediction.location || 'Unknown Location'}</span><br>\r\n            <span><strong>Risk Level:</strong> ${prediction.risk_level || 'N/A'}/10</span><br>\r\n            <span><strong>Expected:</strong> ${formatDate(prediction.predicted_date || prediction.predicted_at)}</span><br>\r\n            <span><strong>Confidence:</strong> ${prediction.probability || 'N/A'}%</span><br>\r\n            <span><strong>Recovery:</strong> ${prediction.predicted_recovery_days || 'N/A'} days</span><br>\r\n            <button onclick=\"window.viewPredictionDetail(${prediction.id})\" style=\"margin-top: 8px; padding: 4px 8px; background: #dc3545; color: white; border: none; border-radius: 4px; cursor: pointer;\">View Details</button>\r\n          </div>\r\n        `);\r\n\r\n      // Add risk circle\r\n      const circleColor = getRiskCircleColor(riskLevel);\r\n      L.circle([prediction.latitude, prediction.longitude], {\r\n        color: circleColor,\r\n        fillColor: circleColor,\r\n        fillOpacity: 0.2,\r\n        radius: Math.max(500, riskLevel * 200),\r\n        weight: 2\r\n      }).addTo(map);\r\n\r\n      predictionMarkers.push(marker);\r\n    }\r\n  });\r\n\r\n  // Fit map to show all markers only if we have markers\r\n  const allMarkers = [...areaMarkers, ...predictionMarkers];\r\n  if (allMarkers.length > 0) {\r\n    try {\r\n      const group = new L.featureGroup(allMarkers);\r\n      map.fitBounds(group.getBounds().pad(0.1));\r\n    } catch (error) {\r\n      console.warn('[EvacuationAreaList] Could not fit bounds:', error);\r\n    }\r\n  }\r\n}\r\n\r\n/**\r\n * Fetch prescriptive analytics data\r\n */\r\nasync function fetchPrescriptiveData() {\r\n  if (!userLocation.value) return;\r\n\r\n  try {\r\n    const response = await residentEvacuationService.getRecommendedArea(\r\n      userLocation.value.lat,\r\n      userLocation.value.lng,\r\n      predictedEvacuees.value\r\n    );\r\n\r\n    prescriptiveData.value = response;\r\n    console.log('[EvacuationAreaList] Prescriptive data loaded:', response);\r\n  } catch (err) {\r\n    console.error('[EvacuationAreaList] Error fetching prescriptive data:', err);\r\n  }\r\n}\r\n\r\n/**\r\n * Watch for user location changes to fetch prescriptive data\r\n */\r\nfunction watchUserLocation() {\r\n  if (userLocation.value) {\r\n    fetchPrescriptiveData();\r\n  }\r\n}\r\n\r\n/**\r\n * Initialize on mount\r\n */\r\nonMounted(async () => {\r\n  await fetchAreas();\r\n  await fetchDisasterPredictions();\r\n  initializeMap();\r\n  updateAreaMarkers();\r\n  initializeGlobalFunctions();\r\n\r\n  // Watch for user location changes\r\n  watch(userLocation, () => {\r\n    watchUserLocation();\r\n  });\r\n\r\n  // Watch for data changes to update markers\r\n  watch(areas, () => {\r\n    updateAreaMarkers();\r\n  });\r\n\r\n  watch(disasterPredictions, () => {\r\n    updateAreaMarkers();\r\n  });\r\n});\r\n\r\n/**\r\n * Close route directions panel\r\n */\r\nfunction closeRouteDirections() {\r\n  showRouteDirections.value = false;\r\n  selectedArea.value = null;\r\n  routeDirections.value = [];\r\n  routeDistance.value = '';\r\n  routeTime.value = '';\r\n\r\n  // Remove routing control from map\r\n  if (routingControl) {\r\n    map.removeControl(routingControl);\r\n    routingControl = null;\r\n  }\r\n}\r\n\r\n/**\r\n * Get route directions to an evacuation area\r\n */\r\nfunction getRouteDirections(lat, lng, name) {\r\n  if (!userLocation.value) {\r\n    alert('Please get your location first to view directions.');\r\n    return;\r\n  }\r\n\r\n  selectedArea.value = { latitude: lat, longitude: lng, name };\r\n  showRouteDirections.value = true;\r\n  routeDirections.value = [];\r\n  routeDistance.value = 'Calculating...';\r\n  routeTime.value = 'Calculating...';\r\n\r\n  // Remove existing routing control\r\n  if (routingControl) {\r\n    map.removeControl(routingControl);\r\n  }\r\n\r\n  // Create new routing control\r\n  routingControl = L.Routing.control({\r\n    waypoints: [\r\n      L.latLng(userLocation.value.lat, userLocation.value.lng),\r\n      L.latLng(lat, lng)\r\n    ],\r\n    routeWhileDragging: false,\r\n    createMarker: () => null, // Don't create default markers\r\n    lineOptions: {\r\n      styles: [{ color: '#667eea', weight: 6, opacity: 0.8 }]\r\n    },\r\n    show: false, // Hide the default instructions panel\r\n    addWaypoints: false\r\n  }).addTo(map);\r\n\r\n  // Listen for route found event\r\n  routingControl.on('routesfound', (e) => {\r\n    const routes = e.routes;\r\n    const route = routes[0];\r\n\r\n    // Extract route information\r\n    routeDistance.value = `${(route.summary.totalDistance / 1000).toFixed(2)} km`;\r\n    routeTime.value = `${Math.round(route.summary.totalTime / 60)} min`;\r\n\r\n    // Extract step-by-step instructions\r\n    routeDirections.value = route.instructions.map(instruction => ({\r\n      instruction: instruction.text\r\n    }));\r\n\r\n    console.log('[EvacuationAreaList] Route calculated:', {\r\n      distance: routeDistance.value,\r\n      time: routeTime.value,\r\n      steps: routeDirections.value.length\r\n    });\r\n  });\r\n\r\n  // Handle routing errors\r\n  routingControl.on('routingerror', (e) => {\r\n    console.error('[EvacuationAreaList] Routing error:', e);\r\n    routeDistance.value = 'Error calculating route';\r\n    routeTime.value = 'Error calculating route';\r\n    routeDirections.value = [{ instruction: 'Unable to calculate route. Please try again.' }];\r\n  });\r\n}\r\n\r\n/**\r\n * Initialize global window functions for marker popups\r\n */\r\nfunction initializeGlobalFunctions() {\r\n  window.viewAreaDetail = (areaId) => {\r\n    goToAreaDetail(areaId);\r\n  };\r\n\r\n  window.getRouteDirections = (lat, lng, name) => {\r\n    getRouteDirections(lat, lng, name);\r\n  };\r\n}\r\n\r\n/**\r\n * Cleanup on unmount\r\n */\r\nonUnmounted(() => {\r\n  if (map) {\r\n    map.remove();\r\n    map = null;\r\n  }\r\n\r\n  // Clean up routing control\r\n  if (routingControl) {\r\n    routingControl = null;\r\n  }\r\n});\r\n</script>\r\n\r\n<style scoped>\r\n.evac-list {\r\n  padding: 1rem;\r\n  max-width: 1200px;\r\n  margin: 0 auto;\r\n}\r\n\r\n/* Header Styles */\r\n.card {\r\n  background: white;\r\n  border-radius: 8px;\r\n  box-shadow: 0 2px 4px rgba(0,0,0,0.1);\r\n  margin-bottom: 1rem;\r\n}\r\n\r\n.card-header {\r\n  padding: 1rem;\r\n  font-weight: 700;\r\n  border-bottom: 1px solid #e6edf3;\r\n  background: linear-gradient(180deg, #f8fafc 0%, #eef2f6 100%);\r\n  border-radius: 8px 8px 0 0;\r\n}\r\n\r\n/* Controls */\r\n.controls {\r\n  padding: 12px;\r\n  display: flex;\r\n  gap: 12px;\r\n  flex-wrap: wrap;\r\n}\r\n\r\n.controls label {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 6px;\r\n  cursor: pointer;\r\n}\r\n\r\n.controls input[type=\"checkbox\"] {\r\n  cursor: pointer;\r\n}\r\n\r\n/* Info Box */\r\n.info-box {\r\n  background: #fff3cd;\r\n  padding: 12px;\r\n  border-radius: 8px;\r\n  margin: 8px 12px;\r\n  border-left: 4px solid #ffc107;\r\n}\r\n\r\n.legend {\r\n  display: flex;\r\n  gap: 12px;\r\n  margin-top: 8px;\r\n  flex-wrap: wrap;\r\n}\r\n\r\n.legend-item {\r\n  display: flex;\r\n  gap: 6px;\r\n  align-items: center;\r\n  font-size: 0.9rem;\r\n}\r\n\r\n.dot {\r\n  width: 14px;\r\n  height: 14px;\r\n  border-radius: 50%;\r\n  display: inline-block;\r\n  border: 2px solid white;\r\n  box-shadow: 0 1px 3px rgba(0,0,0,0.2);\r\n}\r\n\r\n.dot.low { background: #28a745; }\r\n.dot.moderate { background: #ffc107; }\r\n.dot.high { background: #fd7e14; }\r\n.dot.critical { background: #dc3545; }\r\n\r\n/* Map */\r\n.map {\r\n  height: 320px;\r\n  border-radius: 8px;\r\n  margin: 12px;\r\n  background: #eef2f6;\r\n  border: 1px solid #e6edf3;\r\n}\r\n\r\n/* Location Status Box */\r\n.location-status-box {\r\n  padding: 12px;\r\n  margin: 0 12px 12px 12px;\r\n}\r\n\r\n.location-status-box h4 {\r\n  margin: 0 0 12px 0;\r\n}\r\n\r\n.loc-controls {\r\n  display: flex;\r\n  gap: 8px;\r\n  flex-wrap: wrap;\r\n  margin-bottom: 8px;\r\n}\r\n\r\n.muted {\r\n  color: #666;\r\n  font-size: 0.9rem;\r\n  margin-top: 8px;\r\n}\r\n\r\n/* Prescriptive Analytics */\r\n.p-6 { padding: 1.5rem 0; }\r\n.mb-8 { margin-bottom: 2rem; }\r\n\r\n.prescriptive {\r\n  padding: 1.5rem;\r\n  margin: 0 0 1.5rem 0;\r\n}\r\n\r\n.prescriptive-header {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: flex-start;\r\n  gap: 2rem;\r\n  flex-wrap: wrap;\r\n}\r\n\r\n.pred-left h2 {\r\n  margin: 0 0 0.5rem 0;\r\n  font-size: 1.5rem;\r\n}\r\n\r\n.pred-left .small {\r\n  font-size: 0.85rem;\r\n  color: #666;\r\n  margin-bottom: 4px;\r\n}\r\n\r\n.pred-left .big {\r\n  font-size: 2rem;\r\n  font-weight: 700;\r\n  color: #667eea;\r\n}\r\n\r\n.pred-right {\r\n  flex: 1;\r\n  min-width: 300px;\r\n}\r\n\r\n.pred-right .small {\r\n  font-size: 0.85rem;\r\n  color: #666;\r\n  margin-bottom: 8px;\r\n}\r\n\r\n.top-area {\r\n  background: #f8fafc;\r\n  padding: 12px;\r\n  border-radius: 6px;\r\n  border: 1px solid #e6edf3;\r\n}\r\n\r\n.top-area .name {\r\n  font-weight: 600;\r\n  margin-bottom: 6px;\r\n}\r\n\r\n.top-area .addr {\r\n  color: #666;\r\n  font-size: 0.9rem;\r\n}\r\n\r\n.top-area .meta {\r\n  font-size: 0.9rem;\r\n  color: #666;\r\n  margin-bottom: 12px;\r\n}\r\n\r\n.mt-8 { margin-top: 8px; }\r\n\r\n/* Table Styles */\r\n.table-responsive {\r\n  overflow: auto;\r\n}\r\n\r\n.table {\r\n  width: 100%;\r\n  border-collapse: collapse;\r\n}\r\n\r\n.table-custom {\r\n  border-collapse: separate;\r\n  border-spacing: 0;\r\n  border: 1px solid #e6edf3;\r\n  width: 100%;\r\n}\r\n\r\n.table-custom th,\r\n.table-custom td {\r\n  padding: 0.75rem;\r\n  border-right: 1px solid #e6edf3;\r\n  vertical-align: middle;\r\n}\r\n\r\n.table-custom th:last-child,\r\n.table-custom td:last-child {\r\n  border-right: none;\r\n}\r\n\r\n.table-custom thead th {\r\n  background: linear-gradient(180deg, #f8fafc 0%, #eef2f6 100%);\r\n  color: #374151;\r\n  font-weight: 700;\r\n  font-size: 0.875rem;\r\n  border-bottom: 2px solid #e6edf3;\r\n}\r\n\r\n.table-custom tbody tr:hover {\r\n  background: #f9fafb;\r\n}\r\n\r\n.table-custom tbody tr:nth-child(even) {\r\n  background: #ffffff;\r\n}\r\n\r\n.table-custom tbody tr:nth-child(odd) {\r\n  background: #fbfdfe;\r\n}\r\n\r\n.table td {\r\n  padding: 10px;\r\n  border-bottom: 1px solid #eee;\r\n}\r\n\r\n.table th {\r\n  padding: 10px;\r\n  border-bottom: 2px solid #ddd;\r\n  text-align: left;\r\n}\r\n\r\n.text-center { text-align: center; }\r\n\r\n/* Badge Styles */\r\n.badge-custom {\r\n  display: inline-block;\r\n  padding: 0.25rem 0.5rem;\r\n  border-radius: 9999px;\r\n  font-weight: 600;\r\n  border: 1px solid rgba(0,0,0,0.06);\r\n  font-size: 0.85rem;\r\n}\r\n\r\n.badge-success {\r\n  background: #ecfdf5;\r\n  color: #065f46;\r\n  border-color: rgba(6,95,70,0.1);\r\n}\r\n\r\n.badge-warning {\r\n  background: #fff7ed;\r\n  color: #92400e;\r\n  border-color: rgba(146,64,14,0.08);\r\n}\r\n\r\n.badge-danger {\r\n  background: #fff1f2;\r\n  color: #7f1d1d;\r\n  border-color: rgba(127,29,29,0.08);\r\n}\r\n\r\n.hazard-badge {\r\n  display: inline-block;\r\n  min-width: 34px;\r\n  padding: 0.2rem 0.5rem;\r\n  border-radius: 9999px;\r\n  text-align: center;\r\n  font-weight: 700;\r\n  font-size: 0.85rem;\r\n}\r\n\r\n.hazard-low { background: #dff7e5; color: #167f25; }\r\n.hazard-moderate { background: #fff4cc; color: #7a5b00; }\r\n.hazard-high { background: #fff0e0; color: #7a3b00; }\r\n.hazard-critical { background: #ffe6e6; color: #8b1e1e; }\r\n\r\n/* Buttons */\r\n.btn {\r\n  padding: 8px 12px;\r\n  border-radius: 6px;\r\n  color: white;\r\n  text-decoration: none;\r\n  background: #667eea;\r\n  border: none;\r\n  cursor: pointer;\r\n  font-size: 0.9rem;\r\n  transition: background 200ms ease;\r\n}\r\n\r\n.btn:hover {\r\n  opacity: 0.9;\r\n}\r\n\r\n.btn-success { background: #28a745; }\r\n.btn-primary { background: #667eea; }\r\n.btn-secondary { background: #6c757d; }\r\n\r\n.center {\r\n  text-align: center;\r\n  padding: 12px;\r\n}\r\n\r\n.p-1 { padding: 0.25rem; }\r\n\r\n.error-msg {\r\n  color: #b00020;\r\n  font-size: 0.9rem;\r\n  margin-top: 6px;\r\n}\r\n\r\n/* Card Shadow for emphasis */\r\n.card-shadow {\r\n  box-shadow: 0 6px 18px rgba(15, 23, 42, 0.08), 0 1px 4px rgba(15, 23, 42, 0.04);\r\n  border: 1px solid rgba(15, 23, 42, 0.06);\r\n}\r\n\r\n/* Disaster Predictions */\r\n.predictions-grid {\r\n  display: grid;\r\n  grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));\r\n  gap: 1rem;\r\n  margin: 1rem 0;\r\n}\r\n\r\n.prediction-card {\r\n  background: white;\r\n  border-radius: 8px;\r\n  padding: 1rem;\r\n  box-shadow: 0 2px 4px rgba(0,0,0,0.1);\r\n  border: 1px solid #e6edf3;\r\n  transition: box-shadow 0.2s ease;\r\n}\r\n\r\n.prediction-card:hover {\r\n  box-shadow: 0 4px 8px rgba(0,0,0,0.15);\r\n}\r\n\r\n.prediction-header {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: flex-start;\r\n  margin-bottom: 0.75rem;\r\n}\r\n\r\n.prediction-header h4 {\r\n  margin: 0;\r\n  font-size: 1.1rem;\r\n  font-weight: 600;\r\n  color: #374151;\r\n}\r\n\r\n.severity-badge {\r\n  padding: 0.25rem 0.5rem;\r\n  border-radius: 9999px;\r\n  font-size: 0.75rem;\r\n  font-weight: 600;\r\n  text-transform: uppercase;\r\n}\r\n\r\n.severity-low {\r\n  background: #ecfdf5;\r\n  color: #065f46;\r\n}\r\n\r\n.severity-moderate {\r\n  background: #fff7ed;\r\n  color: #92400e;\r\n}\r\n\r\n.severity-high {\r\n  background: #fff1f2;\r\n  color: #7f1d1d;\r\n}\r\n\r\n.severity-critical {\r\n  background: #fef2f2;\r\n  color: #991b1b;\r\n}\r\n\r\n.prediction-body {\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: 0.5rem;\r\n}\r\n\r\n.prediction-detail {\r\n  font-size: 0.9rem;\r\n  color: #666;\r\n}\r\n\r\n.prediction-detail strong {\r\n  color: #374151;\r\n}\r\n\r\n/* Modal Overlay */\r\n.modal-overlay {\r\n  display: flex;\r\n  position: fixed;\r\n  top: 0;\r\n  left: 0;\r\n  right: 0;\r\n  bottom: 0;\r\n  background: rgba(0,0,0,0.5);\r\n  align-items: center;\r\n  justify-content: center;\r\n  z-index: 1000;\r\n}\r\n\r\n.modal-content {\r\n  background: white;\r\n  border-radius: 8px;\r\n  padding: 2rem;\r\n  max-width: 500px;\r\n  width: 90%;\r\n  max-height: 90vh;\r\n  overflow-y: auto;\r\n  box-shadow: 0 10px 40px rgba(0,0,0,0.2);\r\n}\r\n\r\n.modal-content h3 {\r\n  margin: 0 0 1rem 0;\r\n  font-size: 1.25rem;\r\n}\r\n\r\n.form-row {\r\n  margin-bottom: 1rem;\r\n}\r\n\r\n.form-row label {\r\n  display: block;\r\n  font-weight: 600;\r\n  margin-bottom: 4px;\r\n}\r\n\r\n.form-row input {\r\n  width: 100%;\r\n  padding: 8px;\r\n  border: 1px solid #e6edf3;\r\n  border-radius: 6px;\r\n  font-size: 0.9rem;\r\n}\r\n\r\n.form-row input:focus {\r\n  outline: none;\r\n  border-color: #667eea;\r\n  box-shadow: 0 0 0 3px rgba(102,126,234,0.1);\r\n}\r\n\r\n.form-actions {\r\n  display: flex;\r\n  gap: 8px;\r\n  margin-top: 1.5rem;\r\n}\r\n\r\n.form-actions button {\r\n  flex: 1;\r\n}\r\n</style>\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}