{"ast":null,"code":"import { createElementVNode as _createElementVNode, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, toDisplayString as _toDisplayString, renderList as _renderList, Fragment as _Fragment, createTextVNode as _createTextVNode, resolveComponent as _resolveComponent, withCtx as _withCtx, createBlock as _createBlock } from \"vue\";\nconst _hoisted_1 = {\n  class: \"families-list\"\n};\nconst _hoisted_2 = {\n  class: \"card\"\n};\nconst _hoisted_3 = {\n  class: \"card-body\"\n};\nconst _hoisted_4 = {\n  key: 0,\n  class: \"center\"\n};\nconst _hoisted_5 = {\n  key: 1,\n  class: \"center error\"\n};\nconst _hoisted_6 = {\n  key: 2\n};\nconst _hoisted_7 = {\n  key: 0\n};\nconst _hoisted_8 = {\n  class: \"table-responsive\"\n};\nconst _hoisted_9 = {\n  class: \"table\"\n};\nconst _hoisted_10 = {\n  key: 1,\n  class: \"muted\"\n};\nconst _hoisted_11 = {\n  key: 0,\n  class: \"mt-3 muted\"\n};\nconst _hoisted_12 = {\n  key: 1,\n  class: \"muted\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_router_link = _resolveComponent(\"router-link\");\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_createElementVNode(\"div\", _hoisted_2, [_cache[1] || (_cache[1] = _createElementVNode(\"div\", {\n    class: \"card-header\"\n  }, \"üë®‚Äçüë©‚Äçüëß‚Äçüë¶ Families Currently in Evacuation Areas\", -1 /* CACHED */)), _createElementVNode(\"div\", _hoisted_3, [$setup.loading ? (_openBlock(), _createElementBlock(\"div\", _hoisted_4, \"Loading families‚Ä¶\")) : $setup.error ? (_openBlock(), _createElementBlock(\"div\", _hoisted_5, _toDisplayString($setup.error), 1 /* TEXT */)) : (_openBlock(), _createElementBlock(\"div\", _hoisted_6, [$setup.families.length ? (_openBlock(), _createElementBlock(\"div\", _hoisted_7, [_createElementVNode(\"div\", _hoisted_8, [_createElementVNode(\"table\", _hoisted_9, [_cache[0] || (_cache[0] = _createElementVNode(\"thead\", null, [_createElementVNode(\"tr\", null, [_createElementVNode(\"th\", null, \"Family Name\"), _createElementVNode(\"th\", null, \"Members\"), _createElementVNode(\"th\", null, \"Contact Number\"), _createElementVNode(\"th\", null, \"Evacuation Area\"), _createElementVNode(\"th\", null, \"Special Needs\"), _createElementVNode(\"th\", null, \"Checked In\")])], -1 /* CACHED */)), _createElementVNode(\"tbody\", null, [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList($setup.families, f => {\n    return _openBlock(), _createElementBlock(\"tr\", {\n      key: f.id\n    }, [_createElementVNode(\"td\", null, [_createElementVNode(\"strong\", null, _toDisplayString(f.family_head_name), 1 /* TEXT */)]), _createElementVNode(\"td\", null, _toDisplayString(f.total_members), 1 /* TEXT */), _createElementVNode(\"td\", null, _toDisplayString(f.contact_number), 1 /* TEXT */), _createElementVNode(\"td\", null, [$setup.getAreaId(f) ? (_openBlock(), _createBlock(_component_router_link, {\n      key: 0,\n      to: `/resident_pages/evacuation-areas/${$setup.getAreaId(f)}`,\n      class: \"text-link\"\n    }, {\n      default: _withCtx(() => [_createTextVNode(_toDisplayString($setup.getAreaName(f)), 1 /* TEXT */)]),\n      _: 2 /* DYNAMIC */\n    }, 1032 /* PROPS, DYNAMIC_SLOTS */, [\"to\"])) : (_openBlock(), _createElementBlock(\"span\", _hoisted_10, \"-\"))]), _createElementVNode(\"td\", null, _toDisplayString(f.special_needs || 'None'), 1 /* TEXT */), _createElementVNode(\"td\", null, _toDisplayString($setup.formatDate(f.checked_in_at)), 1 /* TEXT */)]);\n  }), 128 /* KEYED_FRAGMENT */))])])]), $setup.meta && $setup.meta.total ? (_openBlock(), _createElementBlock(\"div\", _hoisted_11, \"Total: \" + _toDisplayString($setup.meta.total), 1 /* TEXT */)) : _createCommentVNode(\"v-if\", true)])) : (_openBlock(), _createElementBlock(\"div\", _hoisted_12, \"No families currently in evacuation areas.\"))]))])])]);\n}","map":{"version":3,"names":["class","_createElementBlock","_hoisted_1","_createElementVNode","_hoisted_2","_hoisted_3","$setup","loading","_hoisted_4","error","_hoisted_5","_toDisplayString","_hoisted_6","families","length","_hoisted_7","_hoisted_8","_hoisted_9","_Fragment","_renderList","f","key","id","family_head_name","total_members","contact_number","getAreaId","_createBlock","_component_router_link","to","getAreaName","_hoisted_10","special_needs","formatDate","checked_in_at","meta","total","_hoisted_11","_hoisted_12"],"sources":["C:\\VUEprojects\\crud-app\\src\\pages\\resident_pages\\FamiliesList.vue"],"sourcesContent":["<template>\r\n  <div class=\"families-list\">\r\n    <div class=\"card\">\r\n      <div class=\"card-header\">üë®‚Äçüë©‚Äçüëß‚Äçüë¶ Families Currently in Evacuation Areas</div>\r\n      <div class=\"card-body\">\r\n        <div v-if=\"loading\" class=\"center\">Loading families‚Ä¶</div>\r\n        <div v-else-if=\"error\" class=\"center error\">{{ error }}</div>\r\n\r\n        <div v-else>\r\n          <div v-if=\"families.length\">\r\n            <div class=\"table-responsive\">\r\n              <table class=\"table\">\r\n                <thead>\r\n                  <tr>\r\n                    <th>Family Name</th>\r\n                    <th>Members</th>\r\n                    <th>Contact Number</th>\r\n                    <th>Evacuation Area</th>\r\n                    <th>Special Needs</th>\r\n                    <th>Checked In</th>\r\n                  </tr>\r\n                </thead>\r\n                <tbody>\r\n                  <tr v-for=\"f in families\" :key=\"f.id\">\r\n                    <td><strong>{{ f.family_head_name }}</strong></td>\r\n                    <td>{{ f.total_members }}</td>\r\n                    <td>{{ f.contact_number }}</td>\r\n                    <td>\r\n                      <router-link\r\n                        v-if=\"getAreaId(f)\"\r\n                        :to=\"`/resident_pages/evacuation-areas/${getAreaId(f)}`\"\r\n                        class=\"text-link\"\r\n                      >\r\n                        {{ getAreaName(f) }}\r\n                      </router-link>\r\n                      <span v-else class=\"muted\">-</span>\r\n                    </td>\r\n                    <td>{{ f.special_needs || 'None' }}</td>\r\n                    <td>{{ formatDate(f.checked_in_at) }}</td>\r\n                  </tr>\r\n                </tbody>\r\n              </table>\r\n            </div>\r\n            <div v-if=\"meta && meta.total\" class=\"mt-3 muted\">Total: {{ meta.total }}</div>\r\n          </div>\r\n          <div v-else class=\"muted\">No families currently in evacuation areas.</div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, onMounted, inject } from 'vue';\r\nimport dayjs from 'dayjs';\r\n\r\nconst residentAxios = inject('residentAxios', null);\r\nlet axiosFallback = null;\r\n\r\nconst families = ref([]);\r\nconst loading = ref(true);\r\nconst error = ref('');\r\nconst meta = ref(null);\r\n\r\nfunction formatDate(value) {\r\n  if (!value) return dayjs().format('MMM D, YYYY h:mm A');\r\n  try { return dayjs(value).format('MMM D, YYYY h:mm A'); } catch (e) { return String(value); }\r\n}\r\n\r\nfunction getAreaName(f) {\r\n  return f.evacuation_area?.name || f.evacuationArea?.name || (f.evacuation_area && f.evacuation_area.name) || 'Unknown';\r\n}\r\n\r\nfunction getAreaId(f) {\r\n  return f.evacuation_area?.id || f.evacuationArea?.id || (f.evacuation_area && f.evacuation_area.id) || null;\r\n}\r\n\r\nasync function fetchFamilies() {\r\n  loading.value = true;\r\n  error.value = '';\r\n  try {\r\n    if (!axiosFallback) {\r\n      const mod = await import('axios');\r\n      axiosFallback = mod.default || mod;\r\n    }\r\n    const http = residentAxios || axiosFallback;\r\n    const res = await http.get('/families');\r\n    // Controller returns { families: paginated } when wantsJson()\r\n    const payload = res.data || res;\r\n    if (payload.families) {\r\n      // pagination object\r\n      families.value = payload.families.data || payload.families || [];\r\n      meta.value = payload.families || null;\r\n    } else if (Array.isArray(payload)) {\r\n      families.value = payload;\r\n    } else if (payload.data && Array.isArray(payload.data)) {\r\n      families.value = payload.data;\r\n      meta.value = payload || null;\r\n    } else {\r\n      families.value = payload.families || payload;\r\n    }\r\n  } catch (e) {\r\n    console.error('Failed to load families', e);\r\n    error.value = e.response?.data?.message || e.message || 'Failed to load families';\r\n  } finally {\r\n    loading.value = false;\r\n  }\r\n}\r\n\r\nonMounted(fetchFamilies);\r\n</script>\r\n\r\n<style scoped>\r\n.families-list { padding: 1rem; max-width: 1100px; margin: 0 auto; }\r\n.table { width:100%; border-collapse:collapse; }\r\n.table th, .table td { padding: 10px; border-bottom: 1px solid #eee; }\r\n.table-responsive { overflow:auto; }\r\n.center { text-align:center; padding: 12px; }\r\n.muted { color:#666; }\r\n.text-link { color: #667eea; text-decoration: none; }\r\n.text-link:hover { text-decoration: underline; }\r\n.btn { padding:8px 12px; border-radius:6px; color:#fff; background:#667eea; }\r\n.mt-3 { margin-top: 12px; }\r\n</style>\r\n"],"mappings":";;EACOA,KAAK,EAAC;AAAe;;EACnBA,KAAK,EAAC;AAAM;;EAEVA,KAAK,EAAC;AAAW;;;EACAA,KAAK,EAAC;;;;EACHA,KAAK,EAAC;;;;;;;;;EAIpBA,KAAK,EAAC;AAAkB;;EACpBA,KAAK,EAAC;AAAO;;;EAwBCA,KAAK,EAAC;;;;EAQEA,KAAK,EAAC;;;;EAE3BA,KAAK,EAAC;;;;uBA5C1BC,mBAAA,CAgDM,OAhDNC,UAgDM,GA/CJC,mBAAA,CA8CM,OA9CNC,UA8CM,G,0BA7CJD,mBAAA,CAAiF;IAA5EH,KAAK,EAAC;EAAa,GAAC,oDAAkD,qBAC3EG,mBAAA,CA2CM,OA3CNE,UA2CM,GA1COC,MAAA,CAAAC,OAAO,I,cAAlBN,mBAAA,CAA0D,OAA1DO,UAA0D,EAAvB,mBAAiB,KACpCF,MAAA,CAAAG,KAAK,I,cAArBR,mBAAA,CAA6D,OAA7DS,UAA6D,EAAAC,gBAAA,CAAdL,MAAA,CAAAG,KAAK,qB,cAEpDR,mBAAA,CAsCM,OAAAW,UAAA,GArCON,MAAA,CAAAO,QAAQ,CAACC,MAAM,I,cAA1Bb,mBAAA,CAmCM,OAAAc,UAAA,GAlCJZ,mBAAA,CAgCM,OAhCNa,UAgCM,GA/BJb,mBAAA,CA8BQ,SA9BRc,UA8BQ,G,0BA7BNd,mBAAA,CASQ,gBARNA,mBAAA,CAOK,aANHA,mBAAA,CAAoB,YAAhB,aAAW,GACfA,mBAAA,CAAgB,YAAZ,SAAO,GACXA,mBAAA,CAAuB,YAAnB,gBAAc,GAClBA,mBAAA,CAAwB,YAApB,iBAAe,GACnBA,mBAAA,CAAsB,YAAlB,eAAa,GACjBA,mBAAA,CAAmB,YAAf,YAAU,E,uBAGlBA,mBAAA,CAkBQ,iB,kBAjBNF,mBAAA,CAgBKiB,SAAA,QAAAC,WAAA,CAhBWb,MAAA,CAAAO,QAAQ,EAAbO,CAAC;yBAAZnB,mBAAA,CAgBK;MAhBsBoB,GAAG,EAAED,CAAC,CAACE;QAChCnB,mBAAA,CAAkD,aAA9CA,mBAAA,CAAyC,gBAAAQ,gBAAA,CAA9BS,CAAC,CAACG,gBAAgB,iB,GACjCpB,mBAAA,CAA8B,YAAAQ,gBAAA,CAAvBS,CAAC,CAACI,aAAa,kBACtBrB,mBAAA,CAA+B,YAAAQ,gBAAA,CAAxBS,CAAC,CAACK,cAAc,kBACvBtB,mBAAA,CASK,aAPKG,MAAA,CAAAoB,SAAS,CAACN,CAAC,K,cADnBO,YAAA,CAMcC,sBAAA;;MAJXC,EAAE,sCAAsCvB,MAAA,CAAAoB,SAAS,CAACN,CAAC;MACpDpB,KAAK,EAAC;;wBAEN,MAAoB,C,kCAAjBM,MAAA,CAAAwB,WAAW,CAACV,CAAC,kB;;kEAElBnB,mBAAA,CAAmC,QAAnC8B,WAAmC,EAAR,GAAC,G,GAE9B5B,mBAAA,CAAwC,YAAAQ,gBAAA,CAAjCS,CAAC,CAACY,aAAa,4BACtB7B,mBAAA,CAA0C,YAAAQ,gBAAA,CAAnCL,MAAA,CAAA2B,UAAU,CAACb,CAAC,CAACc,aAAa,kB;wCAK9B5B,MAAA,CAAA6B,IAAI,IAAI7B,MAAA,CAAA6B,IAAI,CAACC,KAAK,I,cAA7BnC,mBAAA,CAA+E,OAA/EoC,WAA+E,EAA7B,SAAO,GAAA1B,gBAAA,CAAGL,MAAA,CAAA6B,IAAI,CAACC,KAAK,oB,sDAExEnC,mBAAA,CAA0E,OAA1EqC,WAA0E,EAAhD,4CAA0C,G","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}