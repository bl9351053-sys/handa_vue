{"ast":null,"code":"import { withAsyncContext as _withAsyncContext } from 'vue';\nimport { ref } from 'vue';\nimport { inject } from 'vue';\nexport default {\n  __name: 'RecommendArea',\n  async setup(__props, {\n    expose: __expose\n  }) {\n    __expose();\n    let __temp, __restore;\n    const residentAxios = inject('residentAxios', null);\n    const axiosFallback = ([__temp, __restore] = _withAsyncContext(() => import('axios')), __temp = await __temp, __restore(), __temp).default;\n    const geoSupported = 'geolocation' in navigator;\n    const loading = ref(false);\n    const error = ref('');\n    const recommended = ref(null);\n    const ranked = ref([]);\n    async function getRecommendations() {\n      if (!geoSupported) {\n        error.value = 'Geolocation not available';\n        return;\n      }\n      loading.value = true;\n      error.value = '';\n      recommended.value = null;\n      ranked.value = [];\n      navigator.geolocation.getCurrentPosition(async pos => {\n        const lat = pos.coords.latitude;\n        const lng = pos.coords.longitude;\n        try {\n          const http = residentAxios || axiosFallback;\n          // API expects latitude & longitude as query params (controller uses Request->input)\n          const res = await http.get('/evacuation-areas/recommend', {\n            params: {\n              latitude: lat,\n              longitude: lng\n            }\n          });\n          const payload = res.data || {};\n          recommended.value = payload.recommended_area ?? payload.recommended ?? null;\n          ranked.value = payload.ranked_areas ?? payload.ranked ?? payload.rankings ?? [];\n        } catch (e) {\n          console.error(e);\n          error.value = e.response?.data?.message || e.message || 'Failed to get recommendations';\n        } finally {\n          loading.value = false;\n        }\n      }, err => {\n        loading.value = false;\n        error.value = err.message || 'Geolocation error';\n      });\n    }\n    const __returned__ = {\n      residentAxios,\n      axiosFallback,\n      geoSupported,\n      loading,\n      error,\n      recommended,\n      ranked,\n      getRecommendations,\n      ref,\n      inject\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["ref","inject","residentAxios","axiosFallback","__temp","__restore","_withAsyncContext","default","geoSupported","navigator","loading","error","recommended","ranked","getRecommendations","value","geolocation","getCurrentPosition","pos","lat","coords","latitude","lng","longitude","http","res","get","params","payload","data","recommended_area","ranked_areas","rankings","e","console","response","message","err"],"sources":["C:/VUEprojects/crud-app/src/pages/resident_pages/RecommendArea.vue"],"sourcesContent":["<template>\r\n  <div class=\"recommend-area\">\r\n    <div class=\"card\">\r\n      <div class=\"card-header\">Nearby Recommendations</div>\r\n      <div class=\"card-body\">\r\n        <div v-if=\"!geoSupported\" class=\"muted\">Geolocation not supported in this browser.</div>\r\n        <div v-else>\r\n          <div class=\"controls\">\r\n            <button class=\"btn btn-primary\" @click=\"getRecommendations\" :disabled=\"loading\">Get Recommendations</button>\r\n          </div>\r\n\r\n          <div v-if=\"loading\" class=\"center\">Finding nearby areas…</div>\r\n          <div v-if=\"error\" class=\"center error\">{{ error }}</div>\r\n\r\n          <div v-if=\"recommended\" class=\"recommended-card\">\r\n            <h3>Top Recommended</h3>\r\n            <div class=\"area\">\r\n              <div class=\"area-name\">{{ recommended.name }}</div>\r\n              <div class=\"muted\">Score: {{ recommended.final_score ?? '—' }}</div>\r\n            </div>\r\n          </div>\r\n\r\n          <div v-if=\"ranked && ranked.length\" class=\"list\">\r\n            <h4>Ranked Areas</h4>\r\n            <ul>\r\n              <li v-for=\"area in ranked\" :key=\"area.id\">\r\n                <div class=\"row\">\r\n                  <div>{{ area.name }}</div>\r\n                  <div class=\"muted\">Score: {{ area.final_score ?? '—' }}</div>\r\n                </div>\r\n              </li>\r\n            </ul>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref } from 'vue';\r\nimport { inject } from 'vue';\r\nconst residentAxios = inject('residentAxios', null);\r\nconst axiosFallback = (await import('axios')).default;\r\n\r\nconst geoSupported = 'geolocation' in navigator;\r\nconst loading = ref(false);\r\nconst error = ref('');\r\nconst recommended = ref(null);\r\nconst ranked = ref([]);\r\n\r\nasync function getRecommendations() {\r\n  if (!geoSupported) { error.value = 'Geolocation not available'; return; }\r\n  loading.value = true; error.value = ''; recommended.value = null; ranked.value = [];\r\n  navigator.geolocation.getCurrentPosition(async (pos) => {\r\n    const lat = pos.coords.latitude; const lng = pos.coords.longitude;\r\n    try {\r\n      const http = residentAxios || axiosFallback;\r\n      // API expects latitude & longitude as query params (controller uses Request->input)\r\n      const res = await http.get('/evacuation-areas/recommend', { params: { latitude: lat, longitude: lng } });\r\n      const payload = res.data || {};\r\n      recommended.value = payload.recommended_area ?? payload.recommended ?? null;\r\n      ranked.value = payload.ranked_areas ?? payload.ranked ?? payload.rankings ?? [];\r\n    } catch (e) {\r\n      console.error(e);\r\n      error.value = e.response?.data?.message || e.message || 'Failed to get recommendations';\r\n    } finally { loading.value = false; }\r\n  }, (err) => { loading.value = false; error.value = err.message || 'Geolocation error'; });\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.recommend-area { padding: 1rem; max-width: 800px; margin: 0 auto; }\r\n.controls { margin-bottom: 1rem; }\r\n.center { text-align:center; margin: 0.5rem 0; }\r\n.recommended-card { background:#f0f8ff; padding:10px; border-radius:8px; margin-bottom:8px; }\r\n.list ul { list-style:none; padding:0; margin:0; }\r\n.list li { padding:8px 0; border-bottom:1px solid #f0f0f0; display:flex; justify-content:space-between; }\r\n.muted { color:#666; }\r\n.btn { padding:8px 12px; border-radius:6px; color:#fff; background:#667eea; border:none; cursor:pointer; }\r\n</style>\r\n"],"mappings":";AAwCA,SAASA,GAAG,QAAQ,KAAK;AACzB,SAASC,MAAM,QAAQ,KAAK;;;;;;;;IAC5B,MAAMC,aAAa,GAAGD,MAAM,CAAC,eAAe,EAAE,IAAI,CAAC;IACnD,MAAME,aAAa,GAAG,CAAC,CAAAC,MAAA,EAAAC,SAAA,IAAAC,iBAAA,OAAM,MAAM,CAAC,OAAO,I,4CAAGC,OAAO;IAErD,MAAMC,YAAY,GAAG,aAAa,IAAIC,SAAS;IAC/C,MAAMC,OAAO,GAAGV,GAAG,CAAC,KAAK,CAAC;IAC1B,MAAMW,KAAK,GAAGX,GAAG,CAAC,EAAE,CAAC;IACrB,MAAMY,WAAW,GAAGZ,GAAG,CAAC,IAAI,CAAC;IAC7B,MAAMa,MAAM,GAAGb,GAAG,CAAC,EAAE,CAAC;IAEtB,eAAec,kBAAkBA,CAAA,EAAG;MAClC,IAAI,CAACN,YAAY,EAAE;QAAEG,KAAK,CAACI,KAAK,GAAG,2BAA2B;QAAE;MAAQ;MACxEL,OAAO,CAACK,KAAK,GAAG,IAAI;MAAEJ,KAAK,CAACI,KAAK,GAAG,EAAE;MAAEH,WAAW,CAACG,KAAK,GAAG,IAAI;MAAEF,MAAM,CAACE,KAAK,GAAG,EAAE;MACnFN,SAAS,CAACO,WAAW,CAACC,kBAAkB,CAAC,MAAOC,GAAG,IAAK;QACtD,MAAMC,GAAG,GAAGD,GAAG,CAACE,MAAM,CAACC,QAAQ;QAAE,MAAMC,GAAG,GAAGJ,GAAG,CAACE,MAAM,CAACG,SAAS;QACjE,IAAI;UACF,MAAMC,IAAI,GAAGtB,aAAa,IAAIC,aAAa;UAC3C;UACA,MAAMsB,GAAG,GAAG,MAAMD,IAAI,CAACE,GAAG,CAAC,6BAA6B,EAAE;YAAEC,MAAM,EAAE;cAAEN,QAAQ,EAAEF,GAAG;cAAEI,SAAS,EAAED;YAAI;UAAE,CAAC,CAAC;UACxG,MAAMM,OAAO,GAAGH,GAAG,CAACI,IAAI,IAAI,CAAC,CAAC;UAC9BjB,WAAW,CAACG,KAAK,GAAGa,OAAO,CAACE,gBAAgB,IAAIF,OAAO,CAAChB,WAAW,IAAI,IAAI;UAC3EC,MAAM,CAACE,KAAK,GAAGa,OAAO,CAACG,YAAY,IAAIH,OAAO,CAACf,MAAM,IAAIe,OAAO,CAACI,QAAQ,IAAI,EAAE;QACjF,CAAC,CAAC,OAAOC,CAAC,EAAE;UACVC,OAAO,CAACvB,KAAK,CAACsB,CAAC,CAAC;UAChBtB,KAAK,CAACI,KAAK,GAAGkB,CAAC,CAACE,QAAQ,EAAEN,IAAI,EAAEO,OAAO,IAAIH,CAAC,CAACG,OAAO,IAAI,+BAA+B;QACzF,CAAC,SAAS;UAAE1B,OAAO,CAACK,KAAK,GAAG,KAAK;QAAE;MACrC,CAAC,EAAGsB,GAAG,IAAK;QAAE3B,OAAO,CAACK,KAAK,GAAG,KAAK;QAAEJ,KAAK,CAACI,KAAK,GAAGsB,GAAG,CAACD,OAAO,IAAI,mBAAmB;MAAE,CAAC,CAAC;IAC3F","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}