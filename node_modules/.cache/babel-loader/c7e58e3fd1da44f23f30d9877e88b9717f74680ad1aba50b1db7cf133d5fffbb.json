{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport { ref, inject } from 'vue';\nimport { useRouter } from 'vue-router';\nexport default {\n  __name: 'UpdateCreate',\n  setup(__props, {\n    expose: __expose\n  }) {\n    __expose();\n    const residentAxios = inject('residentAxios', null);\n    const axiosFallback = window.axios || null;\n    const router = useRouter();\n    const nowLocal = () => {\n      const d = new Date();\n      const iso = d.toISOString();\n      return iso.slice(0, 16);\n    };\n    const form = ref({\n      disaster_type: 'typhoon',\n      title: '',\n      description: '',\n      severity: 'moderate',\n      source: 'PAGASA/PhiVolcs',\n      latitude: '',\n      longitude: '',\n      issued_at: nowLocal()\n    });\n    const errors = ref({});\n    const clientValidate = () => {\n      errors.value = {};\n      if (!form.value.disaster_type) errors.value.disaster_type = 'Disaster type is required.';\n      if (!form.value.title) errors.value.title = 'Title is required.';\n      if (!form.value.description) errors.value.description = 'Description is required.';\n      if (!form.value.severity) errors.value.severity = 'Severity is required.';\n      if (!form.value.issued_at) errors.value.issued_at = 'Issued at datetime is required.';\n      return Object.keys(errors.value).length === 0;\n    };\n    const submit = async () => {\n      if (!clientValidate()) return;\n      try {\n        const payload = {\n          ...form.value\n        };\n        // convert local datetime-local to ISO string\n        if (payload.issued_at) payload.issued_at = new Date(payload.issued_at).toISOString();\n        const http = residentAxios || axiosFallback;\n        await http.post('/disaster-updates', payload);\n        router.push('/updates');\n      } catch (e) {\n        console.error(e);\n        // map Laravel validation errors (422)\n        if (e.response && e.response.status === 422 && e.response.data && e.response.data.errors) {\n          errors.value = e.response.data.errors;\n        } else {\n          alert('Failed to create update');\n        }\n      }\n    };\n    const __returned__ = {\n      residentAxios,\n      axiosFallback,\n      router,\n      nowLocal,\n      form,\n      errors,\n      clientValidate,\n      submit,\n      ref,\n      inject,\n      get useRouter() {\n        return useRouter;\n      }\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["ref","inject","useRouter","residentAxios","axiosFallback","window","axios","router","nowLocal","d","Date","iso","toISOString","slice","form","disaster_type","title","description","severity","source","latitude","longitude","issued_at","errors","clientValidate","value","Object","keys","length","submit","payload","http","post","push","e","console","error","response","status","data","alert"],"sources":["C:/VUEprojects/crud-app/src/pages/updates/UpdateCreate.vue"],"sourcesContent":["<template>\r\n  <div class=\"space-y-6\">\r\n    <div class=\"flex items-center justify-between\">\r\n      <h1 class=\"text-2xl font-bold\">üì¢ Add Disaster Update</h1>\r\n      <router-link to=\"/updates\" class=\"px-4 py-2 bg-gray-300 rounded\">‚Üê Back</router-link>\r\n    </div>\r\n\r\n    <div class=\"bg-white p-4 rounded shadow\">\r\n      <form @submit.prevent=\"submit\">\r\n        <div class=\"space-y-4\">\r\n          <div>\r\n            <label class=\"block mb-1\">Disaster Type *</label>\r\n            <select v-model=\"form.disaster_type\" class=\"input w-full\" required>\r\n              <option value=\"\">Select Type</option>\r\n              <option value=\"typhoon\">Typhoon</option>\r\n              <option value=\"earthquake\">Earthquake</option>\r\n              <option value=\"flood\">Flood</option>\r\n              <option value=\"landslide\">Landslide</option>\r\n            </select>\r\n            <div v-if=\"errors.disaster_type\" class=\"text-red-600 text-sm mt-1\">{{ errors.disaster_type }}</div>\r\n          </div>\r\n\r\n          <div>\r\n            <label class=\"block mb-1\">Title *</label>\r\n            <input v-model=\"form.title\" type=\"text\" class=\"input w-full\" required />\r\n            <div v-if=\"errors.title\" class=\"text-red-600 text-sm mt-1\">{{ errors.title }}</div>\r\n          </div>\r\n\r\n          <div>\r\n            <label class=\"block mb-1\">Description *</label>\r\n            <textarea v-model=\"form.description\" class=\"input w-full\" rows=\"5\" required></textarea>\r\n            <div v-if=\"errors.description\" class=\"text-red-600 text-sm mt-1\">{{ errors.description }}</div>\r\n          </div>\r\n\r\n          <div>\r\n            <label class=\"block mb-1\">Severity Level *</label>\r\n            <select v-model=\"form.severity\" class=\"input w-full\" required>\r\n              <option value=\"\">Select Severity</option>\r\n              <option value=\"low\">Low</option>\r\n              <option value=\"moderate\">Moderate</option>\r\n              <option value=\"high\">High</option>\r\n              <option value=\"critical\">Critical</option>\r\n            </select>\r\n            <div v-if=\"errors.severity\" class=\"text-red-600 text-sm mt-1\">{{ errors.severity }}</div>\r\n          </div>\r\n\r\n          <div>\r\n            <label class=\"block mb-1\">Source</label>\r\n            <input v-model=\"form.source\" type=\"text\" class=\"input w-full\" />\r\n            <div v-if=\"errors.source\" class=\"text-red-600 text-sm mt-1\">{{ errors.source }}</div>\r\n          </div>\r\n\r\n          <div class=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n            <div>\r\n              <label class=\"block mb-1\">Latitude (Optional)</label>\r\n              <input v-model.number=\"form.latitude\" type=\"number\" step=\"0.00000001\" class=\"input w-full\" />\r\n              <div v-if=\"errors.latitude\" class=\"text-red-600 text-sm mt-1\">{{ errors.latitude }}</div>\r\n            </div>\r\n            <div>\r\n              <label class=\"block mb-1\">Longitude (Optional)</label>\r\n              <input v-model.number=\"form.longitude\" type=\"number\" step=\"0.00000001\" class=\"input w-full\" />\r\n              <div v-if=\"errors.longitude\" class=\"text-red-600 text-sm mt-1\">{{ errors.longitude }}</div>\r\n            </div>\r\n          </div>\r\n\r\n          <div>\r\n            <label class=\"block mb-1\">Issued At *</label>\r\n            <input v-model=\"form.issued_at\" type=\"datetime-local\" class=\"input w-full\" required />\r\n            <div v-if=\"errors.issued_at\" class=\"text-red-600 text-sm mt-1\">{{ errors.issued_at }}</div>\r\n          </div>\r\n        </div>\r\n\r\n        <div class=\"flex items-center gap-3 mt-4\">\r\n          <button type=\"submit\" class=\"btn btn-success px-4 py-2\">‚úì Publish Update</button>\r\n          <router-link to=\"/updates\" class=\"btn btn-secondary px-4 py-2\">Cancel</router-link>\r\n        </div>\r\n      </form>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, inject } from 'vue';\r\nimport { useRouter } from 'vue-router';\r\n\r\nconst residentAxios = inject('residentAxios', null);\r\nconst axiosFallback = window.axios || null;\r\nconst router = useRouter();\r\n\r\nconst nowLocal = () => {\r\n  const d = new Date();\r\n  const iso = d.toISOString();\r\n  return iso.slice(0, 16);\r\n};\r\n\r\nconst form = ref({\r\n  disaster_type: 'typhoon',\r\n  title: '',\r\n  description: '',\r\n  severity: 'moderate',\r\n  source: 'PAGASA/PhiVolcs',\r\n  latitude: '',\r\n  longitude: '',\r\n  issued_at: nowLocal(),\r\n});\r\n\r\nconst errors = ref({});\r\n\r\nconst clientValidate = () => {\r\n  errors.value = {};\r\n  if (!form.value.disaster_type) errors.value.disaster_type = 'Disaster type is required.';\r\n  if (!form.value.title) errors.value.title = 'Title is required.';\r\n  if (!form.value.description) errors.value.description = 'Description is required.';\r\n  if (!form.value.severity) errors.value.severity = 'Severity is required.';\r\n  if (!form.value.issued_at) errors.value.issued_at = 'Issued at datetime is required.';\r\n  return Object.keys(errors.value).length === 0;\r\n};\r\n\r\nconst submit = async () => {\r\n  if (!clientValidate()) return;\r\n\r\n  try {\r\n    const payload = { ...form.value };\r\n    // convert local datetime-local to ISO string\r\n    if (payload.issued_at) payload.issued_at = new Date(payload.issued_at).toISOString();\r\n\r\n    const http = residentAxios || axiosFallback;\r\n    await http.post('/disaster-updates', payload);\r\n    router.push('/updates');\r\n  } catch (e) {\r\n    console.error(e);\r\n    // map Laravel validation errors (422)\r\n    if (e.response && e.response.status === 422 && e.response.data && e.response.data.errors) {\r\n      errors.value = e.response.data.errors;\r\n    } else {\r\n      alert('Failed to create update');\r\n    }\r\n  }\r\n};\r\n</script>\r\n"],"mappings":";AAkFA,SAASA,GAAG,EAAEC,MAAM,QAAQ,KAAK;AACjC,SAASC,SAAS,QAAQ,YAAY;;;;;;;IAEtC,MAAMC,aAAa,GAAGF,MAAM,CAAC,eAAe,EAAE,IAAI,CAAC;IACnD,MAAMG,aAAa,GAAGC,MAAM,CAACC,KAAK,IAAI,IAAI;IAC1C,MAAMC,MAAM,GAAGL,SAAS,CAAC,CAAC;IAE1B,MAAMM,QAAQ,GAAGA,CAAA,KAAM;MACrB,MAAMC,CAAC,GAAG,IAAIC,IAAI,CAAC,CAAC;MACpB,MAAMC,GAAG,GAAGF,CAAC,CAACG,WAAW,CAAC,CAAC;MAC3B,OAAOD,GAAG,CAACE,KAAK,CAAC,CAAC,EAAE,EAAE,CAAC;IACzB,CAAC;IAED,MAAMC,IAAI,GAAGd,GAAG,CAAC;MACfe,aAAa,EAAE,SAAS;MACxBC,KAAK,EAAE,EAAE;MACTC,WAAW,EAAE,EAAE;MACfC,QAAQ,EAAE,UAAU;MACpBC,MAAM,EAAE,iBAAiB;MACzBC,QAAQ,EAAE,EAAE;MACZC,SAAS,EAAE,EAAE;MACbC,SAAS,EAAEd,QAAQ,CAAC;IACtB,CAAC,CAAC;IAEF,MAAMe,MAAM,GAAGvB,GAAG,CAAC,CAAC,CAAC,CAAC;IAEtB,MAAMwB,cAAc,GAAGA,CAAA,KAAM;MAC3BD,MAAM,CAACE,KAAK,GAAG,CAAC,CAAC;MACjB,IAAI,CAACX,IAAI,CAACW,KAAK,CAACV,aAAa,EAAEQ,MAAM,CAACE,KAAK,CAACV,aAAa,GAAG,4BAA4B;MACxF,IAAI,CAACD,IAAI,CAACW,KAAK,CAACT,KAAK,EAAEO,MAAM,CAACE,KAAK,CAACT,KAAK,GAAG,oBAAoB;MAChE,IAAI,CAACF,IAAI,CAACW,KAAK,CAACR,WAAW,EAAEM,MAAM,CAACE,KAAK,CAACR,WAAW,GAAG,0BAA0B;MAClF,IAAI,CAACH,IAAI,CAACW,KAAK,CAACP,QAAQ,EAAEK,MAAM,CAACE,KAAK,CAACP,QAAQ,GAAG,uBAAuB;MACzE,IAAI,CAACJ,IAAI,CAACW,KAAK,CAACH,SAAS,EAAEC,MAAM,CAACE,KAAK,CAACH,SAAS,GAAG,iCAAiC;MACrF,OAAOI,MAAM,CAACC,IAAI,CAACJ,MAAM,CAACE,KAAK,CAAC,CAACG,MAAM,KAAK,CAAC;IAC/C,CAAC;IAED,MAAMC,MAAM,GAAG,MAAAA,CAAA,KAAY;MACzB,IAAI,CAACL,cAAc,CAAC,CAAC,EAAE;MAEvB,IAAI;QACF,MAAMM,OAAO,GAAG;UAAE,GAAGhB,IAAI,CAACW;QAAM,CAAC;QACjC;QACA,IAAIK,OAAO,CAACR,SAAS,EAAEQ,OAAO,CAACR,SAAS,GAAG,IAAIZ,IAAI,CAACoB,OAAO,CAACR,SAAS,CAAC,CAACV,WAAW,CAAC,CAAC;QAEpF,MAAMmB,IAAI,GAAG5B,aAAa,IAAIC,aAAa;QAC3C,MAAM2B,IAAI,CAACC,IAAI,CAAC,mBAAmB,EAAEF,OAAO,CAAC;QAC7CvB,MAAM,CAAC0B,IAAI,CAAC,UAAU,CAAC;MACzB,CAAC,CAAC,OAAOC,CAAC,EAAE;QACVC,OAAO,CAACC,KAAK,CAACF,CAAC,CAAC;QAChB;QACA,IAAIA,CAAC,CAACG,QAAQ,IAAIH,CAAC,CAACG,QAAQ,CAACC,MAAM,KAAK,GAAG,IAAIJ,CAAC,CAACG,QAAQ,CAACE,IAAI,IAAIL,CAAC,CAACG,QAAQ,CAACE,IAAI,CAAChB,MAAM,EAAE;UACxFA,MAAM,CAACE,KAAK,GAAGS,CAAC,CAACG,QAAQ,CAACE,IAAI,CAAChB,MAAM;QACvC,CAAC,MAAM;UACLiB,KAAK,CAAC,yBAAyB,CAAC;QAClC;MACF;IACF,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}