{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport { ref, inject, onMounted } from 'vue';\nimport { useRouter } from 'vue-router';\nexport default {\n  __name: 'DisasterUpdatesList',\n  setup(__props, {\n    expose: __expose\n  }) {\n    __expose();\n    const router = useRouter();\n    const residentAxios = inject('residentAxios');\n    const updates = ref([]);\n    const loading = ref(false);\n    const error = ref(null);\n    const syncing = ref(false);\n    const pagination = ref(null);\n    const fetchUpdates = async (page = 1) => {\n      loading.value = true;\n      error.value = null;\n      try {\n        const response = await residentAxios.get('/updates', {\n          params: {\n            page\n          }\n        });\n        updates.value = response.data.data || response.data || [];\n        pagination.value = response.data.current_page ? {\n          current_page: response.data.current_page,\n          last_page: response.data.last_page\n        } : null;\n      } catch (err) {\n        console.error('Error fetching updates:', err);\n        error.value = 'Failed to load disaster updates.';\n        updates.value = [];\n      } finally {\n        loading.value = false;\n      }\n    };\n    const syncUpdates = async () => {\n      syncing.value = true;\n      try {\n        const response = await residentAxios.post('/disaster-updates/sync');\n        alert(response.data.message || 'Synced successfully!');\n        fetchUpdates();\n      } catch (e) {\n        error.value = 'Failed to sync updates.';\n      }\n      syncing.value = false;\n    };\n    const goToDetail = id => {\n      router.push(`/resident_pages/disaster-updates/${id}`);\n    };\n    const formatDate = d => new Date(d).toLocaleString();\n    const getTimeAgo = d => {\n      const seconds = (new Date() - new Date(d)) / 1000;\n      if (seconds < 60) return `${Math.floor(seconds)}s ago`;\n      if (seconds < 3600) return `${Math.floor(seconds / 60)}m ago`;\n      if (seconds < 86400) return `${Math.floor(seconds / 3600)}h ago`;\n      return `${Math.floor(seconds / 86400)}d ago`;\n    };\n\n    // Safe ucfirst helper to avoid runtime errors when fields are missing\n    const ucfirst = s => {\n      const str = s || '';\n      return str ? str.charAt(0).toUpperCase() + str.slice(1) : '';\n    };\n    onMounted(() => fetchUpdates());\n    const __returned__ = {\n      router,\n      residentAxios,\n      updates,\n      loading,\n      error,\n      syncing,\n      pagination,\n      fetchUpdates,\n      syncUpdates,\n      goToDetail,\n      formatDate,\n      getTimeAgo,\n      ucfirst,\n      ref,\n      inject,\n      onMounted,\n      get useRouter() {\n        return useRouter;\n      }\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["ref","inject","onMounted","useRouter","router","residentAxios","updates","loading","error","syncing","pagination","fetchUpdates","page","value","response","get","params","data","current_page","last_page","err","console","syncUpdates","post","alert","message","e","goToDetail","id","push","formatDate","d","Date","toLocaleString","getTimeAgo","seconds","Math","floor","ucfirst","s","str","charAt","toUpperCase","slice"],"sources":["C:/VUEprojects/crud-app/src/pages/resident_pages/DisasterUpdatesList.vue"],"sourcesContent":["<template>\r\n  <div class=\"updates-container\">\r\n\r\n    <!-- Header -->\r\n    <div class=\"header-row\">\r\n      <h1 class=\"header-title\">ðŸš¨ Disaster Updates</h1>\r\n    </div>\r\n\r\n    <!-- Info Box -->\r\n    \r\n\r\n    <!-- Loading -->\r\n    <div v-if=\"loading\" class=\"loading\">Loading disaster updates...</div>\r\n\r\n    <!-- Error -->\r\n    <div v-if=\"error\" class=\"error-box\">{{ error }}</div>\r\n\r\n    <!-- Empty -->\r\n    <div v-if=\"!loading && !error && (!updates || updates.length === 0)\" class=\"empty\">\r\n      No disaster updates available.\r\n    </div>\r\n\r\n    <!-- Updates List -->\r\n    <div v-if=\"!loading && !error && updates && updates.length > 0\" class=\"updates-list\">\r\n\r\n      <div \r\n        v-for=\"update in updates\"\r\n        :key=\"update.id\"\r\n        class=\"update-card\"\r\n        :class=\"update.severity\"\r\n        @click=\"goToDetail(update.id)\"\r\n      >\r\n\r\n        <div class=\"update-header\">\r\n          <h3 class=\"update-title\">{{ update.title }}</h3>\r\n          <span class=\"badge\" :class=\"update.severity || ''\">\r\n            {{ ucfirst(update.severity) }}\r\n          </span>\r\n\r\n          <span class=\"badge gray\">\r\n            {{ ucfirst(update.disaster_type) }}\r\n          </span>\r\n        </div>\r\n\r\n        <p class=\"update-info\">\r\n          {{ update.source }} â€¢ {{ formatDate(update.issued_at) }}\r\n          ({{ getTimeAgo(update.issued_at) }})\r\n        </p>\r\n\r\n        <p class=\"update-desc\">{{ update.description }}</p>\r\n\r\n        <button \r\n          @click.stop=\"goToDetail(update.id)\"\r\n          class=\"btn btn-blue btn-sm\"\r\n        >\r\n          View Details\r\n        </button>\r\n\r\n      </div>\r\n    </div>\r\n\r\n    <!-- Pagination -->\r\n    <div v-if=\"pagination\" class=\"pagination\">\r\n      <button \r\n        v-if=\"pagination.current_page > 1\"\r\n        @click=\"fetchUpdates(pagination.current_page - 1)\"\r\n        class=\"btn btn-gray\"\r\n      >\r\n        Previous\r\n      </button>\r\n\r\n      <span class=\"page-info\">\r\n        Page {{ pagination.current_page }} of {{ pagination.last_page }}\r\n      </span>\r\n\r\n      <button \r\n        v-if=\"pagination.current_page < pagination.last_page\"\r\n        @click=\"fetchUpdates(pagination.current_page + 1)\"\r\n        class=\"btn btn-gray\"\r\n      >\r\n        Next\r\n      </button>\r\n    </div>\r\n\r\n  </div>\r\n</template>\r\n\r\n\r\n<script setup>\r\nimport { ref, inject, onMounted } from 'vue';\r\nimport { useRouter } from 'vue-router';\r\n\r\nconst router = useRouter();\r\nconst residentAxios = inject('residentAxios');\r\n\r\nconst updates = ref([]);\r\nconst loading = ref(false);\r\nconst error = ref(null);\r\nconst syncing = ref(false);\r\nconst pagination = ref(null);\r\n\r\nconst fetchUpdates = async (page = 1) => {\r\n  loading.value = true;\r\n  error.value = null;\r\n\r\n  try {\r\n    const response = await residentAxios.get('/updates', {\r\n      params: { page }\r\n    });\r\n\r\n    updates.value = response.data.data || response.data || [];\r\n    pagination.value = response.data.current_page ? {\r\n      current_page: response.data.current_page,\r\n      last_page: response.data.last_page\r\n    } : null;\r\n\r\n  } catch (err) {\r\n    console.error('Error fetching updates:', err);\r\n    error.value = 'Failed to load disaster updates.';\r\n    updates.value = [];\r\n  } finally {\r\n    loading.value = false;\r\n  }\r\n};\r\n\r\nconst syncUpdates = async () => {\r\n  syncing.value = true;\r\n  try {\r\n    const response = await residentAxios.post('/disaster-updates/sync');\r\n    alert(response.data.message || 'Synced successfully!');\r\n    fetchUpdates();\r\n  } catch (e) {\r\n    error.value = 'Failed to sync updates.';\r\n  }\r\n  syncing.value = false;\r\n};\r\n\r\nconst goToDetail = (id) => {\r\n  router.push(`/resident_pages/disaster-updates/${id}`);\r\n};\r\n\r\nconst formatDate = (d) => new Date(d).toLocaleString();\r\nconst getTimeAgo = (d) => {\r\n  const seconds = (new Date() - new Date(d)) / 1000;\r\n  if (seconds < 60) return `${Math.floor(seconds)}s ago`;\r\n  if (seconds < 3600) return `${Math.floor(seconds/60)}m ago`;\r\n  if (seconds < 86400) return `${Math.floor(seconds/3600)}h ago`;\r\n  return `${Math.floor(seconds/86400)}d ago`;\r\n};\r\n\r\n// Safe ucfirst helper to avoid runtime errors when fields are missing\r\nconst ucfirst = (s) => {\r\n  const str = s || '';\r\n  return str ? (str.charAt(0).toUpperCase() + str.slice(1)) : '';\r\n};\r\n\r\nonMounted(() => fetchUpdates());\r\n</script>\r\n\r\n\r\n<style>\r\n/* ================== BASE LAYOUT ================== */\r\n.updates-container {\r\n  padding: 20px;\r\n  font-family: \"Segoe UI\", sans-serif;\r\n  color: #333;\r\n}\r\n\r\n.header-row {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n}\r\n\r\n.header-title {\r\n  font-size: 28px;\r\n  font-weight: 700;\r\n}\r\n\r\n/* ================== BUTTONS ================== */\r\n.btn {\r\n  padding: 10px 16px;\r\n  border-radius: 8px;\r\n  font-size: 14px;\r\n  cursor: pointer;\r\n  border: none;\r\n  transition: 0.2s;\r\n}\r\n\r\n.btn-sm {\r\n  padding: 8px 12px;\r\n  font-size: 12px;\r\n}\r\n\r\n.btn-green {\r\n  background: #22c55e;\r\n  color: white;\r\n}\r\n.btn-green:hover {\r\n  background: #16a34a;\r\n}\r\n\r\n.btn-blue {\r\n  background: #2563eb;\r\n  color: white;\r\n}\r\n.btn-blue:hover {\r\n  background: #1d4ed8;\r\n}\r\n\r\n.btn-gray {\r\n  background: #d1d5db;\r\n  color: #333;\r\n}\r\n.btn-gray:hover {\r\n  background: #bfc3c7;\r\n}\r\n\r\n.btn:disabled {\r\n  opacity: 0.6;\r\n  cursor: not-allowed;\r\n}\r\n\r\n/* ================== INFO BOX ================== */\r\n.info-box {\r\n  background: #fff7d6;\r\n  border: 1px solid #ffe8a3;\r\n  padding: 15px;\r\n  border-radius: 10px;\r\n  margin-top: 15px;\r\n}\r\n\r\n/* ================== UPDATE CARDS ================== */\r\n.updates-list {\r\n  margin-top: 20px;\r\n}\r\n\r\n.update-card {\r\n  background: white;\r\n  border-radius: 10px;\r\n  padding: 18px;\r\n  border: 1px solid #ddd;\r\n  margin-bottom: 15px;\r\n  box-shadow: 0 2px 6px rgba(0,0,0,0.05);\r\n  transition: 0.2s;\r\n}\r\n\r\n.update-card:hover {\r\n  box-shadow: 0 4px 14px rgba(0,0,0,0.12);\r\n  transform: translateY(-3px);\r\n  cursor: pointer;\r\n}\r\n\r\n/* Severity color backgrounds */\r\n.update-card.critical { background: #ffe5e5; border-color: #ff9999; }\r\n.update-card.high     { background: #ffe9d6; border-color: #ffb478; }\r\n.update-card.moderate { background: #fff6cc; border-color: #ffe38a; }\r\n.update-card.low      { background: #e3f2ff; border-color: #a8d3ff; }\r\n\r\n/* Badges */\r\n.badge {\r\n  padding: 4px 10px;\r\n  border-radius: 20px;\r\n  font-size: 11px;\r\n  font-weight: bold;\r\n  text-transform: capitalize;\r\n}\r\n\r\n.badge.critical { background: #ff4d4d; color: white; }\r\n.badge.high     { background: #ff8c42; color: white; }\r\n.badge.moderate { background: #ffcc33; color: black; }\r\n.badge.low      { background: #4da6ff; color: white; }\r\n\r\n.badge.gray { background: #ccc; color: #333; }\r\n\r\n/* ================== TEXT ================== */\r\n.update-title {\r\n  font-size: 18px;\r\n  font-weight: 600;\r\n}\r\n\r\n.update-info {\r\n  font-size: 13px;\r\n  color: #666;\r\n  margin: 6px 0;\r\n}\r\n\r\n.update-desc {\r\n  margin-bottom: 10px;\r\n  color: #444;\r\n}\r\n\r\n/* ================== PAGINATION ================== */\r\n.pagination {\r\n  margin-top: 20px;\r\n  display: flex;\r\n  gap: 10px;\r\n  justify-content: center;\r\n}\r\n\r\n.page-info {\r\n  font-size: 14px;\r\n  color: #444;\r\n}\r\n\r\n/* ================== STATUS BOXES ================== */\r\n.loading,\r\n.empty {\r\n  text-align: center;\r\n  padding: 25px;\r\n  color: #666;\r\n}\r\n\r\n.error-box {\r\n  background: #ffe5e5;\r\n  border: 1px solid #ff9c9c;\r\n  padding: 12px;\r\n  border-radius: 8px;\r\n  color: #cc0000;\r\n}\r\n</style>\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}