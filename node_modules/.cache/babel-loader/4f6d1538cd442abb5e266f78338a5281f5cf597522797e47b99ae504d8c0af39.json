{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport { ref, inject } from 'vue';\nimport { useRoute, useRouter } from 'vue-router';\nexport default {\n  __name: 'RegisterFamily',\n  setup(__props, {\n    expose: __expose\n  }) {\n    __expose();\n    const route = useRoute();\n    const router = useRouter();\n    const id = route.params.id;\n    const residentAxios = inject('residentAxios', null);\n    let axiosFallback = null;\n    const form = ref({\n      family_head_name: '',\n      total_members: 1,\n      contact_number: '',\n      address: '',\n      special_needs: ''\n    });\n    const errors = ref({});\n    const serverError = ref('');\n    const successMessage = ref('');\n    const submitting = ref(false);\n\n    /**\r\n     * Submit the registration form\r\n     */\n    async function submit() {\n      submitting.value = true;\n      errors.value = {};\n      serverError.value = '';\n      successMessage.value = '';\n      try {\n        if (!axiosFallback) {\n          const mod = await import('axios');\n          axiosFallback = mod.default || mod;\n        }\n        const http = residentAxios || axiosFallback;\n        console.debug('[RegisterFamily] submitting to /evacuation-areas/' + id + '/go', form.value);\n        const response = await http.post(`/evacuation-areas/${id}/go`, form.value);\n        console.debug('[RegisterFamily] success', response.data);\n        successMessage.value = response.data.message || 'Family registered successfully!';\n\n        // Redirect after a short delay to show the success message\n        setTimeout(() => {\n          router.push(`/resident_pages/evacuation-areas/${id}`);\n        }, 1500);\n      } catch (e) {\n        console.error('[RegisterFamily] submission error', e);\n        if (e.response && e.response.status === 422) {\n          // Validation errors\n          errors.value = e.response.data.errors || e.response.data || {};\n          console.debug('[RegisterFamily] validation errors', errors.value);\n        } else {\n          // Server or other error\n          serverError.value = e.response?.data?.message || e.message || 'Failed to register family';\n        }\n      } finally {\n        submitting.value = false;\n      }\n    }\n    const __returned__ = {\n      route,\n      router,\n      id,\n      residentAxios,\n      get axiosFallback() {\n        return axiosFallback;\n      },\n      set axiosFallback(v) {\n        axiosFallback = v;\n      },\n      form,\n      errors,\n      serverError,\n      successMessage,\n      submitting,\n      submit,\n      ref,\n      inject,\n      get useRoute() {\n        return useRoute;\n      },\n      get useRouter() {\n        return useRouter;\n      }\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["ref","inject","useRoute","useRouter","route","router","id","params","residentAxios","axiosFallback","form","family_head_name","total_members","contact_number","address","special_needs","errors","serverError","successMessage","submitting","submit","value","mod","default","http","console","debug","response","post","data","message","setTimeout","push","e","error","status"],"sources":["C:/VUEprojects/crud-app/src/pages/resident_pages/RegisterFamily.vue"],"sourcesContent":["<template>\r\n  <div class=\"register-family\">\r\n    <!-- Header with Back Button -->\r\n    <div class=\"header-controls\">\r\n      <router-link :to=\"`/resident_pages/evacuation-areas/${id}`\" class=\"btn btn-secondary\">‚Üê Back to Area</router-link>\r\n    </div>\r\n\r\n    <div class=\"card\">\r\n      <div class=\"card-header\">üë• Register My Family</div>\r\n      <div class=\"card-body\">\r\n        <p class=\"intro-text\">Please provide your family information to register at this evacuation area.</p>\r\n\r\n        <!-- Success Message -->\r\n        <div v-if=\"successMessage\" class=\"success-msg\">\r\n          ‚úÖ {{ successMessage }}\r\n        </div>\r\n\r\n        <!-- Server Error -->\r\n        <div v-if=\"serverError\" class=\"error-box\">\r\n          ‚ùå {{ serverError }}\r\n        </div>\r\n\r\n        <!-- Registration Form -->\r\n        <form @submit.prevent=\"submit\" class=\"form\">\r\n          <div class=\"form-row\">\r\n            <label for=\"family_head_name\">Family Head Name *</label>\r\n            <input \r\n              id=\"family_head_name\"\r\n              v-model=\"form.family_head_name\" \r\n              type=\"text\"\r\n              placeholder=\"e.g., Juan Dela Cruz\"\r\n              required\r\n            />\r\n            <div v-if=\"errors.family_head_name\" class=\"error-msg\">\r\n              {{ errors.family_head_name[0] }}\r\n            </div>\r\n          </div>\r\n\r\n          <div class=\"form-row\">\r\n            <label for=\"total_members\">Total Family Members *</label>\r\n            <input \r\n              id=\"total_members\"\r\n              v-model.number=\"form.total_members\" \r\n              type=\"number\" \r\n              min=\"1\"\r\n              placeholder=\"e.g., 4\"\r\n              required\r\n            />\r\n            <div v-if=\"errors.total_members\" class=\"error-msg\">\r\n              {{ errors.total_members[0] }}\r\n            </div>\r\n            <div class=\"hint\">Including yourself</div>\r\n          </div>\r\n\r\n          <div class=\"form-row\">\r\n            <label for=\"contact_number\">Contact Number *</label>\r\n            <input \r\n              id=\"contact_number\"\r\n              v-model=\"form.contact_number\" \r\n              type=\"text\"\r\n              placeholder=\"e.g., +63 9XX XXX XXXX\"\r\n              required\r\n            />\r\n            <div v-if=\"errors.contact_number\" class=\"error-msg\">\r\n              {{ errors.contact_number[0] }}\r\n            </div>\r\n          </div>\r\n\r\n          <div class=\"form-row\">\r\n            <label for=\"address\">Current Address</label>\r\n            <input \r\n              id=\"address\"\r\n              v-model=\"form.address\" \r\n              type=\"text\"\r\n              placeholder=\"Your residential address\"\r\n            />\r\n            <div v-if=\"errors.address\" class=\"error-msg\">\r\n              {{ errors.address[0] }}\r\n            </div>\r\n          </div>\r\n\r\n          <div class=\"form-row\">\r\n            <label for=\"special_needs\">Special Needs / Medical Conditions</label>\r\n            <input \r\n              id=\"special_needs\"\r\n              v-model=\"form.special_needs\" \r\n              type=\"text\"\r\n              placeholder=\"e.g., Wheelchair accessible, Oxygen support, etc.\"\r\n            />\r\n            <div v-if=\"errors.special_needs\" class=\"error-msg\">\r\n              {{ errors.special_needs[0] }}\r\n            </div>\r\n          </div>\r\n\r\n          <div class=\"form-actions\">\r\n            <button type=\"submit\" class=\"btn btn-primary\" :disabled=\"submitting\">\r\n              {{ submitting ? 'Registering...' : '‚úì Register Family' }}\r\n            </button>\r\n            <router-link :to=\"`/resident_pages/evacuation-areas/${id}`\" class=\"btn btn-secondary\">\r\n              Cancel\r\n            </router-link>\r\n          </div>\r\n        </form>\r\n      </div>\r\n    </div>\r\n\r\n    <!-- Info Box -->\r\n    <div class=\"card mt-2\">\r\n      <div class=\"card-header\">‚ÑπÔ∏è Information</div>\r\n      <div class=\"card-body\">\r\n        <ul class=\"info-list\">\r\n          <li>Your family information will be securely recorded</li>\r\n          <li>You will receive a confirmation with your family ID</li>\r\n          <li>The evacuation center staff will be notified of your arrival</li>\r\n          <li>Contact the center at the provided number if you have questions</li>\r\n        </ul>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, inject } from 'vue';\r\nimport { useRoute, useRouter } from 'vue-router';\r\n\r\nconst route = useRoute();\r\nconst router = useRouter();\r\nconst id = route.params.id;\r\n\r\nconst residentAxios = inject('residentAxios', null);\r\nlet axiosFallback = null;\r\n\r\nconst form = ref({\r\n  family_head_name: '',\r\n  total_members: 1,\r\n  contact_number: '',\r\n  address: '',\r\n  special_needs: ''\r\n});\r\n\r\nconst errors = ref({});\r\nconst serverError = ref('');\r\nconst successMessage = ref('');\r\nconst submitting = ref(false);\r\n\r\n/**\r\n * Submit the registration form\r\n */\r\nasync function submit() {\r\n  submitting.value = true;\r\n  errors.value = {};\r\n  serverError.value = '';\r\n  successMessage.value = '';\r\n\r\n  try {\r\n    if (!axiosFallback) {\r\n      const mod = await import('axios');\r\n      axiosFallback = mod.default || mod;\r\n    }\r\n\r\n    const http = residentAxios || axiosFallback;\r\n    \r\n    console.debug('[RegisterFamily] submitting to /evacuation-areas/' + id + '/go', form.value);\r\n    \r\n    const response = await http.post(`/evacuation-areas/${id}/go`, form.value);\r\n    \r\n    console.debug('[RegisterFamily] success', response.data);\r\n    \r\n    successMessage.value = response.data.message || 'Family registered successfully!';\r\n    \r\n    // Redirect after a short delay to show the success message\r\n    setTimeout(() => {\r\n      router.push(`/resident_pages/evacuation-areas/${id}`);\r\n    }, 1500);\r\n  } catch (e) {\r\n    console.error('[RegisterFamily] submission error', e);\r\n    \r\n    if (e.response && e.response.status === 422) {\r\n      // Validation errors\r\n      errors.value = e.response.data.errors || e.response.data || {};\r\n      console.debug('[RegisterFamily] validation errors', errors.value);\r\n    } else {\r\n      // Server or other error\r\n      serverError.value = e.response?.data?.message || e.message || 'Failed to register family';\r\n    }\r\n  } finally {\r\n    submitting.value = false;\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.register-family { padding: 1rem; max-width: 700px; margin: 0 auto; }\r\n.form-row { margin-bottom: 0.75rem; }\r\nlabel { display:block; font-weight:600; margin-bottom:4px; }\r\ninput[type=\"text\"], input[type=\"number\"] { width:100%; padding:8px; border:1px solid #e6edf3; border-radius:6px; }\r\n.form-actions { display:flex; gap:8px; margin-top:12px; }\r\n.btn { padding:8px 12px; border-radius:6px; color:#fff; text-decoration:none; border:none; cursor:pointer; }\r\n.btn-primary { background:#667eea; }\r\n.btn-secondary { background:#6c757d; }\r\n.error-msg { color:#b00020; font-size:0.9rem; margin-top:6px; }\r\n</style>\r\n"],"mappings":";AA0HA,SAASA,GAAG,EAAEC,MAAM,QAAQ,KAAK;AACjC,SAASC,QAAQ,EAAEC,SAAS,QAAQ,YAAY;;;;;;;IAEhD,MAAMC,KAAK,GAAGF,QAAQ,CAAC,CAAC;IACxB,MAAMG,MAAM,GAAGF,SAAS,CAAC,CAAC;IAC1B,MAAMG,EAAE,GAAGF,KAAK,CAACG,MAAM,CAACD,EAAE;IAE1B,MAAME,aAAa,GAAGP,MAAM,CAAC,eAAe,EAAE,IAAI,CAAC;IACnD,IAAIQ,aAAa,GAAG,IAAI;IAExB,MAAMC,IAAI,GAAGV,GAAG,CAAC;MACfW,gBAAgB,EAAE,EAAE;MACpBC,aAAa,EAAE,CAAC;MAChBC,cAAc,EAAE,EAAE;MAClBC,OAAO,EAAE,EAAE;MACXC,aAAa,EAAE;IACjB,CAAC,CAAC;IAEF,MAAMC,MAAM,GAAGhB,GAAG,CAAC,CAAC,CAAC,CAAC;IACtB,MAAMiB,WAAW,GAAGjB,GAAG,CAAC,EAAE,CAAC;IAC3B,MAAMkB,cAAc,GAAGlB,GAAG,CAAC,EAAE,CAAC;IAC9B,MAAMmB,UAAU,GAAGnB,GAAG,CAAC,KAAK,CAAC;;IAE7B;AACA;AACA;IACA,eAAeoB,MAAMA,CAAA,EAAG;MACtBD,UAAU,CAACE,KAAK,GAAG,IAAI;MACvBL,MAAM,CAACK,KAAK,GAAG,CAAC,CAAC;MACjBJ,WAAW,CAACI,KAAK,GAAG,EAAE;MACtBH,cAAc,CAACG,KAAK,GAAG,EAAE;MAEzB,IAAI;QACF,IAAI,CAACZ,aAAa,EAAE;UAClB,MAAMa,GAAG,GAAG,MAAM,MAAM,CAAC,OAAO,CAAC;UACjCb,aAAa,GAAGa,GAAG,CAACC,OAAO,IAAID,GAAG;QACpC;QAEA,MAAME,IAAI,GAAGhB,aAAa,IAAIC,aAAa;QAE3CgB,OAAO,CAACC,KAAK,CAAC,mDAAmD,GAAGpB,EAAE,GAAG,KAAK,EAAEI,IAAI,CAACW,KAAK,CAAC;QAE3F,MAAMM,QAAQ,GAAG,MAAMH,IAAI,CAACI,IAAI,CAAC,qBAAqBtB,EAAE,KAAK,EAAEI,IAAI,CAACW,KAAK,CAAC;QAE1EI,OAAO,CAACC,KAAK,CAAC,0BAA0B,EAAEC,QAAQ,CAACE,IAAI,CAAC;QAExDX,cAAc,CAACG,KAAK,GAAGM,QAAQ,CAACE,IAAI,CAACC,OAAO,IAAI,iCAAiC;;QAEjF;QACAC,UAAU,CAAC,MAAM;UACf1B,MAAM,CAAC2B,IAAI,CAAC,oCAAoC1B,EAAE,EAAE,CAAC;QACvD,CAAC,EAAE,IAAI,CAAC;MACV,CAAC,CAAC,OAAO2B,CAAC,EAAE;QACVR,OAAO,CAACS,KAAK,CAAC,mCAAmC,EAAED,CAAC,CAAC;QAErD,IAAIA,CAAC,CAACN,QAAQ,IAAIM,CAAC,CAACN,QAAQ,CAACQ,MAAM,KAAK,GAAG,EAAE;UAC3C;UACAnB,MAAM,CAACK,KAAK,GAAGY,CAAC,CAACN,QAAQ,CAACE,IAAI,CAACb,MAAM,IAAIiB,CAAC,CAACN,QAAQ,CAACE,IAAI,IAAI,CAAC,CAAC;UAC9DJ,OAAO,CAACC,KAAK,CAAC,oCAAoC,EAAEV,MAAM,CAACK,KAAK,CAAC;QACnE,CAAC,MAAM;UACL;UACAJ,WAAW,CAACI,KAAK,GAAGY,CAAC,CAACN,QAAQ,EAAEE,IAAI,EAAEC,OAAO,IAAIG,CAAC,CAACH,OAAO,IAAI,2BAA2B;QAC3F;MACF,CAAC,SAAS;QACRX,UAAU,CAACE,KAAK,GAAG,KAAK;MAC1B;IACF","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}