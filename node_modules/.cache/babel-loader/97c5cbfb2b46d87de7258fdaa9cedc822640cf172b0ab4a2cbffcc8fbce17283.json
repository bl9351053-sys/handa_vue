{"ast":null,"code":"import { createCommentVNode as _createCommentVNode, createElementVNode as _createElementVNode, createTextVNode as _createTextVNode, resolveComponent as _resolveComponent, withCtx as _withCtx, createVNode as _createVNode, openBlock as _openBlock, createElementBlock as _createElementBlock, toDisplayString as _toDisplayString, vShow as _vShow, withDirectives as _withDirectives } from \"vue\";\nconst _hoisted_1 = {\n  class: \"container\"\n};\nconst _hoisted_2 = {\n  class: \"header\"\n};\nconst _hoisted_3 = {\n  key: 0,\n  class: \"loading\"\n};\nconst _hoisted_4 = {\n  key: 1,\n  class: \"alert-error\"\n};\nconst _hoisted_5 = {\n  key: 2,\n  class: \"form-card\"\n};\nconst _hoisted_6 = {\n  class: \"update-title\"\n};\nconst _hoisted_7 = {\n  class: \"meta\"\n};\nconst _hoisted_8 = {\n  class: \"description\"\n};\nconst _hoisted_9 = {\n  key: 0,\n  class: \"map-section\"\n};\nconst _hoisted_10 = {\n  key: 0,\n  class: \"alert-error\"\n};\nconst _hoisted_11 = {\n  key: 1,\n  class: \"map-loading\"\n};\nconst _hoisted_12 = {\n  id: \"show-disaster-map\",\n  class: \"map\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_router_link = _resolveComponent(\"router-link\");\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_createCommentVNode(\" Header \"), _createElementVNode(\"div\", _hoisted_2, [_cache[1] || (_cache[1] = _createElementVNode(\"h1\", {\n    class: \"title\"\n  }, \"Update Details\", -1 /* CACHED */)), _createVNode(_component_router_link, {\n    to: \"/updates\",\n    class: \"btn-back\"\n  }, {\n    default: _withCtx(() => [...(_cache[0] || (_cache[0] = [_createTextVNode(\"‚Üê Back\", -1 /* CACHED */)]))]),\n    _: 1 /* STABLE */\n  })]), _createCommentVNode(\" Loading & Error \"), $setup.loading ? (_openBlock(), _createElementBlock(\"div\", _hoisted_3, \"Loading‚Ä¶\")) : _createCommentVNode(\"v-if\", true), $setup.error ? (_openBlock(), _createElementBlock(\"div\", _hoisted_4, _toDisplayString($setup.error), 1 /* TEXT */)) : _createCommentVNode(\"v-if\", true), _createCommentVNode(\" Update Info \"), $setup.update ? (_openBlock(), _createElementBlock(\"div\", _hoisted_5, [_createElementVNode(\"h2\", _hoisted_6, _toDisplayString($setup.update.title), 1 /* TEXT */), _createElementVNode(\"div\", _hoisted_7, _toDisplayString($setup.update.source) + \" ‚Ä¢ \" + _toDisplayString($setup.formatDate($setup.update.issued_at)), 1 /* TEXT */), _createElementVNode(\"p\", _hoisted_8, _toDisplayString($setup.update.description), 1 /* TEXT */), _createElementVNode(\"p\", null, [_cache[2] || (_cache[2] = _createElementVNode(\"strong\", null, \"Type:\", -1 /* CACHED */)), _createTextVNode(\" \" + _toDisplayString($setup.update.disaster_type), 1 /* TEXT */)]), _createElementVNode(\"p\", null, [_cache[3] || (_cache[3] = _createElementVNode(\"strong\", null, \"Severity:\", -1 /* CACHED */)), _createTextVNode(\" \" + _toDisplayString($setup.update.severity), 1 /* TEXT */)]), _createElementVNode(\"p\", null, [_cache[4] || (_cache[4] = _createElementVNode(\"strong\", null, \"Coordinates:\", -1 /* CACHED */)), _createTextVNode(\" \" + _toDisplayString($setup.update.latitude ?? 'N/A') + \", \" + _toDisplayString($setup.update.longitude ?? 'N/A'), 1 /* TEXT */)]), _createCommentVNode(\" Map Section \"), $setup.update.latitude && $setup.update.longitude ? (_openBlock(), _createElementBlock(\"div\", _hoisted_9, [_cache[5] || (_cache[5] = _createElementVNode(\"h3\", null, \"üìç Location Map\", -1 /* CACHED */)), $setup.mapError ? (_openBlock(), _createElementBlock(\"div\", _hoisted_10, _toDisplayString($setup.mapError), 1 /* TEXT */)) : !$setup.mapReady ? (_openBlock(), _createElementBlock(\"div\", _hoisted_11, \"Loading map‚Ä¶\")) : _createCommentVNode(\"v-if\", true), _withDirectives(_createElementVNode(\"div\", _hoisted_12, null, 512 /* NEED_PATCH */), [[_vShow, $setup.mapReady]])])) : _createCommentVNode(\"v-if\", true)])) : _createCommentVNode(\"v-if\", true)]);\n}","map":{"version":3,"names":["class","id","_createElementBlock","_hoisted_1","_createCommentVNode","_createElementVNode","_hoisted_2","_createVNode","_component_router_link","to","_cache","$setup","loading","_hoisted_3","error","_hoisted_4","_toDisplayString","update","_hoisted_5","_hoisted_6","title","_hoisted_7","source","formatDate","issued_at","_hoisted_8","description","disaster_type","severity","latitude","longitude","_hoisted_9","mapError","_hoisted_10","mapReady","_hoisted_11","_hoisted_12"],"sources":["C:\\VUEprojects\\crud-app\\src\\pages\\updates\\UpdateShow.vue"],"sourcesContent":["<template>\r\n  <div class=\"container\">\r\n    <!-- Header -->\r\n    <div class=\"header\">\r\n      <h1 class=\"title\">Update Details</h1>\r\n      <router-link to=\"/updates\" class=\"btn-back\">‚Üê Back</router-link>\r\n    </div>\r\n\r\n    <!-- Loading & Error -->\r\n    <div v-if=\"loading\" class=\"loading\">Loading‚Ä¶</div>\r\n    <div v-if=\"error\" class=\"alert-error\">{{ error }}</div>\r\n\r\n    <!-- Update Info -->\r\n    <div v-if=\"update\" class=\"form-card\">\r\n      <h2 class=\"update-title\">{{ update.title }}</h2>\r\n      <div class=\"meta\">{{ update.source }} ‚Ä¢ {{ formatDate(update.issued_at) }}</div>\r\n      <p class=\"description\">{{ update.description }}</p>\r\n      <p><strong>Type:</strong> {{ update.disaster_type }}</p>\r\n      <p><strong>Severity:</strong> {{ update.severity }}</p>\r\n      <p><strong>Coordinates:</strong> {{ update.latitude ?? 'N/A' }}, {{ update.longitude ?? 'N/A' }}</p>\r\n\r\n      <!-- Map Section -->\r\n      <div v-if=\"update.latitude && update.longitude\" class=\"map-section\">\r\n        <h3>üìç Location Map</h3>\r\n        <div v-if=\"mapError\" class=\"alert-error\">{{ mapError }}</div>\r\n        <div v-else-if=\"!mapReady\" class=\"map-loading\">Loading map‚Ä¶</div>\r\n        <div id=\"show-disaster-map\" v-show=\"mapReady\" class=\"map\"></div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, onMounted, onUnmounted, nextTick } from 'vue';\r\nimport { useRoute } from 'vue-router';\r\nimport axios from 'axios';\r\n\r\nconst route = useRoute();\r\nconst update = ref(null);\r\nconst loading = ref(false);\r\nconst error = ref(null);\r\nconst mapReady = ref(false);\r\nconst mapError = ref(null);\r\nlet leafletMap = null;\r\n\r\nconst load = async () => {\r\n  loading.value = true;\r\n  error.value = null;\r\n  try {\r\n    const res = await axios.get(`/updates/${route.params.id}`);\r\n    update.value = res.data.data || res.data;\r\n    \r\n    await nextTick();\r\n    if (update.value.latitude && update.value.longitude) {\r\n      await initLeafletSafe(update.value.latitude, update.value.longitude);\r\n    }\r\n  } catch (e) {\r\n    console.error(e);\r\n    error.value = 'Failed to load';\r\n  } finally {\r\n    loading.value = false;\r\n  }\r\n};\r\n\r\nconst formatDate = s => s ? new Date(s).toLocaleString() : 'N/A';\r\n\r\nonMounted(load);\r\n\r\nonUnmounted(() => {\r\n  if (leafletMap && leafletMap.remove) leafletMap.remove();\r\n});\r\n\r\nasync function initLeafletSafe(lat, lng) {\r\n  try {\r\n    const L = await loadLeafletAssets(10000);\r\n    const el = await waitForElement('#show-disaster-map', 5000);\r\n    leafletMap = L.map(el).setView([parseFloat(lat), parseFloat(lng)], 10);\r\n    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', { \r\n      attribution: '¬© OpenStreetMap contributors',\r\n      maxZoom: 19\r\n    }).addTo(leafletMap);\r\n    L.marker([parseFloat(lat), parseFloat(lng)]).addTo(leafletMap).bindPopup(`<strong>${update.value.title}</strong>`);\r\n    mapReady.value = true;\r\n  } catch (e) {\r\n    mapError.value = e.message || String(e);\r\n    mapReady.value = false;\r\n  }\r\n}\r\n\r\nfunction waitForElement(selector, timeout = 2000) {\r\n  return new Promise((resolve, reject) => {\r\n    const el = document.querySelector(selector);\r\n    if (el) return resolve(el);\r\n    const checkInterval = 100;\r\n    let elapsed = 0;\r\n    const interval = setInterval(() => {\r\n      const found = document.querySelector(selector);\r\n      if (found) { clearInterval(interval); resolve(found); }\r\n      elapsed += checkInterval;\r\n      if (elapsed >= timeout) { clearInterval(interval); reject('Timeout waiting for element'); }\r\n    }, checkInterval);\r\n  });\r\n}\r\n\r\nfunction loadLeafletAssets(timeout = 10000) {\r\n  return new Promise((resolve, reject) => {\r\n    if (window.L) return resolve(window.L);\r\n    const cssHref = 'https://unpkg.com/leaflet@1.9.4/dist/leaflet.css';\r\n    const jsSrc = 'https://unpkg.com/leaflet@1.9.4/dist/leaflet.js';\r\n    if (!document.querySelector(`link[href=\"${cssHref}\"]`)) {\r\n      const link = document.createElement('link'); \r\n      link.rel = 'stylesheet'; \r\n      link.href = cssHref; \r\n      document.head.appendChild(link);\r\n    }\r\n    if (!document.querySelector(`script[src=\"${jsSrc}\"]`)) {\r\n      const script = document.createElement('script');\r\n      script.src = jsSrc;\r\n      script.async = true;\r\n      script.onload = () => resolve(window.L);\r\n      script.onerror = () => reject('Leaflet failed to load');\r\n      document.head.appendChild(script);\r\n      setTimeout(() => { if (!window.L) reject('Leaflet load timeout'); }, timeout);\r\n    } else { resolve(window.L); }\r\n  });\r\n}\r\n</script>\r\n\r\n<style>\r\n.container { max-width: 700px; margin: 20px auto; padding: 0 16px; font-family: Arial, sans-serif; }\r\n\r\n/* Header */\r\n.header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; }\r\n.title { font-size: 24px; font-weight: bold; color: #333; }\r\n.btn-back { padding: 8px 16px; background: #ccc; color: #333; border-radius: 6px; text-decoration: none; }\r\n.btn-back:hover { background: #bbb; }\r\n\r\n/* Loading & Error */\r\n.loading { text-align: center; padding: 16px; color: #555; }\r\n.alert-error { background: #ffe5e5; color: #b30000; padding: 12px 16px; border-radius: 8px; margin-bottom: 16px; }\r\n\r\n/* Card */\r\n.form-card { background: #fff; padding: 20px; border-radius: 12px; box-shadow: 0 2px 6px rgba(0,0,0,0.1); }\r\n.update-title { font-size: 20px; font-weight: bold; margin-bottom: 6px; color: #333; }\r\n.meta { font-size: 14px; color: #666; margin-bottom: 12px; }\r\n.description { font-size: 16px; color: #333; line-height: 1.5; margin-bottom: 12px; }\r\n</style>\r\n<script></script>"],"mappings":";;EACOA,KAAK,EAAC;AAAW;;EAEfA,KAAK,EAAC;AAAQ;;;EAMCA,KAAK,EAAC;;;;EACRA,KAAK,EAAC;;;;EAGLA,KAAK,EAAC;;;EACnBA,KAAK,EAAC;AAAc;;EACnBA,KAAK,EAAC;AAAM;;EACdA,KAAK,EAAC;AAAa;;;EAM0BA,KAAK,EAAC;;;;EAE/BA,KAAK,EAAC;;;;EACAA,KAAK,EAAC;;;EAC5BC,EAAE,EAAC,mBAAmB;EAAmBD,KAAK,EAAC;;;;uBAzB1DE,mBAAA,CA4BM,OA5BNC,UA4BM,GA3BJC,mBAAA,YAAe,EACfC,mBAAA,CAGM,OAHNC,UAGM,G,0BAFJD,mBAAA,CAAqC;IAAjCL,KAAK,EAAC;EAAO,GAAC,gBAAc,qBAChCO,YAAA,CAAgEC,sBAAA;IAAnDC,EAAE,EAAC,UAAU;IAACT,KAAK,EAAC;;sBAAW,MAAM,KAAAU,MAAA,QAAAA,MAAA,O,iBAAN,QAAM,mB;;QAGpDN,mBAAA,qBAAwB,EACbO,MAAA,CAAAC,OAAO,I,cAAlBV,mBAAA,CAAkD,OAAlDW,UAAkD,EAAd,UAAQ,K,mCACjCF,MAAA,CAAAG,KAAK,I,cAAhBZ,mBAAA,CAAuD,OAAvDa,UAAuD,EAAAC,gBAAA,CAAdL,MAAA,CAAAG,KAAK,oB,mCAE9CV,mBAAA,iBAAoB,EACTO,MAAA,CAAAM,MAAM,I,cAAjBf,mBAAA,CAeM,OAfNgB,UAeM,GAdJb,mBAAA,CAAgD,MAAhDc,UAAgD,EAAAH,gBAAA,CAApBL,MAAA,CAAAM,MAAM,CAACG,KAAK,kBACxCf,mBAAA,CAAgF,OAAhFgB,UAAgF,EAAAL,gBAAA,CAA3DL,MAAA,CAAAM,MAAM,CAACK,MAAM,IAAG,KAAG,GAAAN,gBAAA,CAAGL,MAAA,CAAAY,UAAU,CAACZ,MAAA,CAAAM,MAAM,CAACO,SAAS,mBACtEnB,mBAAA,CAAmD,KAAnDoB,UAAmD,EAAAT,gBAAA,CAAzBL,MAAA,CAAAM,MAAM,CAACS,WAAW,kBAC5CrB,mBAAA,CAAwD,Y,0BAArDA,mBAAA,CAAsB,gBAAd,OAAK,qB,iBAAS,GAAC,GAAAW,gBAAA,CAAGL,MAAA,CAAAM,MAAM,CAACU,aAAa,iB,GACjDtB,mBAAA,CAAuD,Y,0BAApDA,mBAAA,CAA0B,gBAAlB,WAAS,qB,iBAAS,GAAC,GAAAW,gBAAA,CAAGL,MAAA,CAAAM,MAAM,CAACW,QAAQ,iB,GAChDvB,mBAAA,CAAoG,Y,0BAAjGA,mBAAA,CAA6B,gBAArB,cAAY,qB,iBAAS,GAAC,GAAAW,gBAAA,CAAGL,MAAA,CAAAM,MAAM,CAACY,QAAQ,aAAY,IAAE,GAAAb,gBAAA,CAAGL,MAAA,CAAAM,MAAM,CAACa,SAAS,0B,GAEpF1B,mBAAA,iBAAoB,EACTO,MAAA,CAAAM,MAAM,CAACY,QAAQ,IAAIlB,MAAA,CAAAM,MAAM,CAACa,SAAS,I,cAA9C5B,mBAAA,CAKM,OALN6B,UAKM,G,0BAJJ1B,mBAAA,CAAwB,YAApB,iBAAe,qBACRM,MAAA,CAAAqB,QAAQ,I,cAAnB9B,mBAAA,CAA6D,OAA7D+B,WAA6D,EAAAjB,gBAAA,CAAjBL,MAAA,CAAAqB,QAAQ,oB,CACnCrB,MAAA,CAAAuB,QAAQ,I,cAAzBhC,mBAAA,CAAiE,OAAjEiC,WAAiE,EAAlB,cAAY,K,mDAC3D9B,mBAAA,CAAgE,OAAhE+B,WAAgE,gC,SAA5BzB,MAAA,CAAAuB,QAAQ,E","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}