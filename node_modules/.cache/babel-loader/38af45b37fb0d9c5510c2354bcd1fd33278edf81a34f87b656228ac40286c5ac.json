{"ast":null,"code":"import \"core-js/modules/web.url-search-params.delete.js\";\nimport \"core-js/modules/web.url-search-params.has.js\";\nimport \"core-js/modules/web.url-search-params.size.js\";\nimport { reactive, toRefs, onMounted } from 'vue';\nimport axios from 'axios';\nexport default {\n  __name: 'ReportFacility',\n  setup(__props, {\n    expose: __expose\n  }) {\n    __expose();\n    const state = reactive({\n      facilities: [],\n      summary: {\n        total: 0,\n        by_status: {},\n        by_type: {}\n      },\n      loading: false,\n      error: null\n    });\n    async function fetchFacilities() {\n      state.loading = true;\n      state.error = null;\n      try {\n        const res = await axios.get('http://localhost:8000/api/reports/facility', {\n          params: {\n            json: 1\n          }\n        });\n        state.facilities = res.data.facilities || [];\n        state.summary = res.data.summary || {\n          total: 0,\n          by_status: {},\n          by_type: {}\n        };\n      } catch (e) {\n        console.error(e);\n        state.error = e.message || 'Failed to load facilities.';\n      } finally {\n        state.loading = false;\n      }\n    }\n    async function downloadCSV() {\n      try {\n        const res = await axios.get('http://localhost:8000/api/reports/facility', {\n          params: {\n            format: 'csv'\n          },\n          responseType: 'blob'\n        });\n        const blob = new Blob([res.data], {\n          type: 'text/csv'\n        });\n        const url = window.URL.createObjectURL(blob);\n        const a = document.createElement('a');\n        a.href = url;\n        a.download = `facility_report_${new Date().toISOString().slice(0, 19).replace(/[:T]/g, '_')}.csv`;\n        document.body.appendChild(a);\n        a.click();\n        a.remove();\n        window.URL.revokeObjectURL(url);\n      } catch (e) {\n        console.error('CSV download failed', e);\n        state.error = 'Failed to download CSV.';\n      }\n    }\n    onMounted(fetchFacilities);\n    const {\n      facilities,\n      summary,\n      loading,\n      error\n    } = toRefs(state);\n    const __returned__ = {\n      state,\n      fetchFacilities,\n      downloadCSV,\n      facilities,\n      summary,\n      loading,\n      error,\n      reactive,\n      toRefs,\n      onMounted,\n      get axios() {\n        return axios;\n      }\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["reactive","toRefs","onMounted","axios","state","facilities","summary","total","by_status","by_type","loading","error","fetchFacilities","res","get","params","json","data","e","console","message","downloadCSV","format","responseType","blob","Blob","type","url","window","URL","createObjectURL","a","document","createElement","href","download","Date","toISOString","slice","replace","body","appendChild","click","remove","revokeObjectURL"],"sources":["C:/VUEprojects/crud-app/src/pages/ReportFacility.vue"],"sourcesContent":["<template>\r\n  <div class=\"container\">\r\n    <div class=\"header mb-6\">\r\n      <h1 class=\"text-3xl font-bold gradient-text\">Facility Report</h1>\r\n    </div>\r\n\r\n    <div class=\"flex items-center justify-between mb-4\">\r\n      <div>\r\n        <button class=\"btn-submit\" @click=\"fetchFacilities\">Refresh</button>\r\n        <button class=\"btn-submit ml-2\" @click=\"downloadCSV\">Download CSV</button>\r\n      </div>\r\n      <div>\r\n        <span v-if=\"loading\">Loading...</span>\r\n        <span v-if=\"error\" class=\"text-red-600\">{{ error }}</span>\r\n      </div>\r\n    </div>\r\n```\r\n<!-- Summary -->\r\n<div class=\"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6\">\r\n  <div class=\"info-box purple\">\r\n    <p class=\"label\">Total Facilities</p>\r\n    <p class=\"value\">{{ summary.total }}</p>\r\n  </div>\r\n  <div class=\"info-box green\">\r\n    <p class=\"label\">By Status</p>\r\n    <p class=\"value\" v-for=\"(count, status) in summary.by_status\" :key=\"status\">{{ status }}: {{ count }}</p>\r\n  </div>\r\n  <div class=\"info-box indigo\">\r\n    <p class=\"label\">By Type</p>\r\n    <p class=\"value\" v-for=\"(count, type) in summary.by_type\" :key=\"type\">{{ type }}: {{ count }}</p>\r\n  </div>\r\n</div>\r\n\r\n<!-- Table -->\r\n<div class=\"card\">\r\n  <table class=\"w-full table-auto border-collapse\">\r\n    <thead>\r\n      <tr>\r\n        <th class=\"th\">Name</th>\r\n        <th class=\"th\">Type</th>\r\n        <th class=\"th\">Status</th>\r\n        <th class=\"th\">Address</th>\r\n      </tr>\r\n    </thead>\r\n    <tbody>\r\n      <tr v-for=\"facility in facilities\" :key=\"facility.id\">\r\n        <td class=\"td\">{{ facility.name }}</td>\r\n        <td class=\"td\">{{ facility.type }}</td>\r\n        <td class=\"td\">{{ facility.status }}</td>\r\n        <td class=\"td\">{{ facility.address }}</td>\r\n      </tr>\r\n    </tbody>\r\n  </table>\r\n</div>\r\n```\r\n\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\n</script>\r\n\r\n<script setup>\r\nimport { reactive, toRefs, onMounted } from 'vue'\r\nimport axios from 'axios'\r\n\r\nconst state = reactive({\r\n  facilities: [],\r\n  summary: { total:0, by_status:{}, by_type:{} },\r\n  loading: false,\r\n  error: null,\r\n})\r\n\r\nasync function fetchFacilities() {\r\n  state.loading = true\r\n  state.error = null\r\n  try {\r\n    const res = await axios.get('http://localhost:8000/api/reports/facility', { params: { json: 1 } })\r\n    state.facilities = res.data.facilities || []\r\n    state.summary = res.data.summary || { total:0, by_status:{}, by_type:{} }\r\n  } catch (e) {\r\n    console.error(e)\r\n    state.error = e.message || 'Failed to load facilities.'\r\n  } finally {\r\n    state.loading = false\r\n  }\r\n}\r\n\r\nasync function downloadCSV() {\r\n  try {\r\n    const res = await axios.get('http://localhost:8000/api/reports/facility', { params: { format: 'csv' }, responseType: 'blob' })\r\n    const blob = new Blob([res.data], { type: 'text/csv' })\r\n    const url = window.URL.createObjectURL(blob)\r\n    const a = document.createElement('a')\r\n    a.href = url\r\n    a.download = `facility_report_${new Date().toISOString().slice(0,19).replace(/[:T]/g,'_')}.csv`\r\n    document.body.appendChild(a)\r\n    a.click()\r\n    a.remove()\r\n    window.URL.revokeObjectURL(url)\r\n  } catch (e) {\r\n    console.error('CSV download failed', e)\r\n    state.error = 'Failed to download CSV.'\r\n  }\r\n}\r\n\r\nonMounted(fetchFacilities)\r\n\r\nconst { facilities, summary, loading, error } = toRefs(state)\r\n</script>\r\n\r\n<style scoped>\r\n.container { max-width: 1100px; margin:0 auto; padding:20px; }\r\n.gradient-text { background: linear-gradient(90deg,#6366f1,#f43f5e); -webkit-background-clip:text; -webkit-text-fill-color:transparent; }\r\n.card { background:#fff; border-radius:12px; padding:20px; box-shadow:0 4px 12px rgba(0,0,0,0.08); margin-bottom:20px; }\r\n.info-box { padding:15px; border-radius:12px; }\r\n.info-box.purple { background:#f3e8ff; color:#7c3aed; }\r\n.info-box.green { background:#d1fae5; color:#059669; }\r\n.info-box.indigo { background:#e0e7ff; color:#4338ca; }\r\ntable { width:100%; border-collapse:collapse; }\r\n.th, .td { padding:8px; border:1px solid #e5e7eb; text-align:left; }\r\n</style>\r\n"],"mappings":";;;AA+DA,SAASA,QAAQ,EAAEC,MAAM,EAAEC,SAAS,QAAQ,KAAK;AACjD,OAAOC,KAAK,MAAM,OAAO;;;;;;;IAEzB,MAAMC,KAAK,GAAGJ,QAAQ,CAAC;MACrBK,UAAU,EAAE,EAAE;MACdC,OAAO,EAAE;QAAEC,KAAK,EAAC,CAAC;QAAEC,SAAS,EAAC,CAAC,CAAC;QAAEC,OAAO,EAAC,CAAC;MAAE,CAAC;MAC9CC,OAAO,EAAE,KAAK;MACdC,KAAK,EAAE;IACT,CAAC,CAAC;IAEF,eAAeC,eAAeA,CAAA,EAAG;MAC/BR,KAAK,CAACM,OAAO,GAAG,IAAI;MACpBN,KAAK,CAACO,KAAK,GAAG,IAAI;MAClB,IAAI;QACF,MAAME,GAAG,GAAG,MAAMV,KAAK,CAACW,GAAG,CAAC,4CAA4C,EAAE;UAAEC,MAAM,EAAE;YAAEC,IAAI,EAAE;UAAE;QAAE,CAAC,CAAC;QAClGZ,KAAK,CAACC,UAAU,GAAGQ,GAAG,CAACI,IAAI,CAACZ,UAAU,IAAI,EAAE;QAC5CD,KAAK,CAACE,OAAO,GAAGO,GAAG,CAACI,IAAI,CAACX,OAAO,IAAI;UAAEC,KAAK,EAAC,CAAC;UAAEC,SAAS,EAAC,CAAC,CAAC;UAAEC,OAAO,EAAC,CAAC;QAAE,CAAC;MAC3E,CAAC,CAAC,OAAOS,CAAC,EAAE;QACVC,OAAO,CAACR,KAAK,CAACO,CAAC,CAAC;QAChBd,KAAK,CAACO,KAAK,GAAGO,CAAC,CAACE,OAAO,IAAI,4BAA4B;MACzD,CAAC,SAAS;QACRhB,KAAK,CAACM,OAAO,GAAG,KAAK;MACvB;IACF;IAEA,eAAeW,WAAWA,CAAA,EAAG;MAC3B,IAAI;QACF,MAAMR,GAAG,GAAG,MAAMV,KAAK,CAACW,GAAG,CAAC,4CAA4C,EAAE;UAAEC,MAAM,EAAE;YAAEO,MAAM,EAAE;UAAM,CAAC;UAAEC,YAAY,EAAE;QAAO,CAAC,CAAC;QAC9H,MAAMC,IAAI,GAAG,IAAIC,IAAI,CAAC,CAACZ,GAAG,CAACI,IAAI,CAAC,EAAE;UAAES,IAAI,EAAE;QAAW,CAAC,CAAC;QACvD,MAAMC,GAAG,GAAGC,MAAM,CAACC,GAAG,CAACC,eAAe,CAACN,IAAI,CAAC;QAC5C,MAAMO,CAAC,GAAGC,QAAQ,CAACC,aAAa,CAAC,GAAG,CAAC;QACrCF,CAAC,CAACG,IAAI,GAAGP,GAAG;QACZI,CAAC,CAACI,QAAQ,GAAG,mBAAmB,IAAIC,IAAI,CAAC,CAAC,CAACC,WAAW,CAAC,CAAC,CAACC,KAAK,CAAC,CAAC,EAAC,EAAE,CAAC,CAACC,OAAO,CAAC,OAAO,EAAC,GAAG,CAAC,MAAM;QAC/FP,QAAQ,CAACQ,IAAI,CAACC,WAAW,CAACV,CAAC,CAAC;QAC5BA,CAAC,CAACW,KAAK,CAAC,CAAC;QACTX,CAAC,CAACY,MAAM,CAAC,CAAC;QACVf,MAAM,CAACC,GAAG,CAACe,eAAe,CAACjB,GAAG,CAAC;MACjC,CAAC,CAAC,OAAOT,CAAC,EAAE;QACVC,OAAO,CAACR,KAAK,CAAC,qBAAqB,EAAEO,CAAC,CAAC;QACvCd,KAAK,CAACO,KAAK,GAAG,yBAAyB;MACzC;IACF;IAEAT,SAAS,CAACU,eAAe,CAAC;IAE1B,MAAM;MAAEP,UAAU;MAAEC,OAAO;MAAEI,OAAO;MAAEC;IAAM,CAAC,GAAGV,MAAM,CAACG,KAAK,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}