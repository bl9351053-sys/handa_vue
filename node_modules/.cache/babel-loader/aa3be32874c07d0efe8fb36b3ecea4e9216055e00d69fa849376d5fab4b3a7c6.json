{"ast":null,"code":"import { withAsyncContext as _withAsyncContext } from 'vue';\nimport { ref, onMounted, inject } from 'vue';\nexport default {\n  __name: 'EvacuationAreaList',\n  async setup(__props, {\n    expose: __expose\n  }) {\n    __expose();\n    let __temp, __restore;\n    const residentAxios = inject('residentAxios', null);\n    const axiosFallback = ([__temp, __restore] = _withAsyncContext(() => import('axios')), __temp = await __temp, __restore(), __temp).default;\n    const areas = ref([]);\n    const loading = ref(true);\n    const error = ref(null);\n    const predictedEvacuees = ref(0);\n    const topArea = ref(null);\n    const showPredictions = ref(true);\n    const showFaultLines = ref(false);\n    const showAddLocation = ref(false);\n    const locationStatus = ref('');\n    async function fetchAreas() {\n      loading.value = true;\n      error.value = null;\n      try {\n        const http = residentAxios || axiosFallback;\n        const res = await http.get('/evacuation-areas');\n        areas.value = res.data || [];\n        // compute predicted and top area\n        predictedEvacuees.value = 29.41; // default placeholder\n        topArea.value = areas.value.slice().sort((a, b) => (b.final_score || 0) - (a.final_score || 0))[0] || null;\n      } catch (e) {\n        console.error(e);\n        error.value = e.response?.data?.message || e.message || 'Failed to load evacuation areas';\n      } finally {\n        loading.value = false;\n      }\n    }\n    function getLocation() {\n      locationStatus.value = 'Getting location...';\n      if (!navigator.geolocation) {\n        locationStatus.value = 'Geolocation not supported';\n        return;\n      }\n      navigator.geolocation.getCurrentPosition(pos => {\n        locationStatus.value = `Lat ${pos.coords.latitude.toFixed(6)}, Lng ${pos.coords.longitude.toFixed(6)}`;\n        showAddLocation.value = true;\n      }, err => {\n        locationStatus.value = `Error: ${err.message}`;\n      });\n    }\n    function openAddLocation() {\n      // for now just alert ‚Äî the blade uses modal; we can wire modal if needed\n      alert('Add Location modal not implemented in resident UI yet');\n    }\n    onMounted(fetchAreas);\n    const __returned__ = {\n      residentAxios,\n      axiosFallback,\n      areas,\n      loading,\n      error,\n      predictedEvacuees,\n      topArea,\n      showPredictions,\n      showFaultLines,\n      showAddLocation,\n      locationStatus,\n      fetchAreas,\n      getLocation,\n      openAddLocation,\n      ref,\n      onMounted,\n      inject\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["ref","onMounted","inject","residentAxios","axiosFallback","__temp","__restore","_withAsyncContext","default","areas","loading","error","predictedEvacuees","topArea","showPredictions","showFaultLines","showAddLocation","locationStatus","fetchAreas","value","http","res","get","data","slice","sort","a","b","final_score","e","console","response","message","getLocation","navigator","geolocation","getCurrentPosition","pos","coords","latitude","toFixed","longitude","err","openAddLocation","alert"],"sources":["C:/VUEprojects/crud-app/src/pages/resident_pages/EvacuationAreaList.vue"],"sourcesContent":["<template>\r\n  <div class=\"evac-list\">\r\n    <meta name=\"csrf-token\" :content=\"csrfToken\" />\r\n    <div class=\"card\">\r\n      <div class=\"card-header\">üó∫Ô∏è Evacuation Areas Map</div>\r\n\r\n      <div class=\"controls\">\r\n        <label><input type=\"checkbox\" v-model=\"showPredictions\"> Show Disaster Predictions (Color-Coded by Severity)</label>\r\n        <label style=\"margin-left:12px\"><input type=\"checkbox\" v-model=\"showFaultLines\"> Show Earthquake Fault Lines</label>\r\n      </div>\r\n\r\n      <div class=\"info-box\">\r\n        <strong>üìä Prediction Severity:</strong>\r\n        <div class=\"legend\">\r\n          <span class=\"legend-item\"><span class=\"dot low\"></span> Low (1-3)</span>\r\n          <span class=\"legend-item\"><span class=\"dot moderate\"></span> Moderate (4-5)</span>\r\n          <span class=\"legend-item\"><span class=\"dot high\"></span> High (6-7)</span>\r\n          <span class=\"legend-item\"><span class=\"dot critical\"></span> Critical (8-10)</span>\r\n        </div>\r\n      </div>\r\n\r\n      <div id=\"map\" class=\"map\"></div>\r\n\r\n      <div class=\"location-status-box\">\r\n        <h4>üìç Your Location</h4>\r\n        <div class=\"loc-controls\">\r\n          <button class=\"btn btn-success\" @click=\"getLocation\">Get My Location</button>\r\n          <button class=\"btn btn-primary\" v-if=\"showAddLocation\" @click=\"openAddLocation\">‚ûï Add My Location as Evacuation Area</button>\r\n        </div>\r\n        <div class=\"muted\">{{ locationStatus }}</div>\r\n      </div>\r\n    </div>\r\n\r\n    <div class=\"p-6 mb-8\">\r\n      <div class=\"card prescriptive\">\r\n        <div class=\"flex\">\r\n          <div class=\"pred-left\">\r\n            <h2>üìä Prescriptive Analytics</h2>\r\n            <div class=\"small\">Predicted Evacuees</div>\r\n            <div class=\"big\">{{ predictedEvacuees }}</div>\r\n          </div>\r\n          <div class=\"pred-right\">\r\n            <div class=\"small\">Recommended Evacuation Area (by score)</div>\r\n            <div v-if=\"topArea\" class=\"top-area\">\r\n              <div class=\"name\">{{ topArea.name }} <small class=\"addr\">- {{ topArea.address }}</small></div>\r\n              <div class=\"meta\">Hazard: <strong>{{ topArea.risk_score }}</strong> ¬∑ Capacity left: <strong>{{ (topArea.capacity - (topArea.current_occupancy||0)) }}</strong></div>\r\n            </div>\r\n            <div v-else class=\"small\">No recommended area available</div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      <div class=\"card\">\r\n        <div class=\"card-header\">üìã Evacuation Areas List</div>\r\n        <div v-if=\"loading\" class=\"center\">Loading evacuation areas‚Ä¶</div>\r\n        <div v-else>\r\n          <div v-if=\"areas.length\">\r\n            <div class=\"table-responsive\">\r\n              <table class=\"table\">\r\n                <thead>\r\n                  <tr>\r\n                    <th>Name</th>\r\n                    <th>Address</th>\r\n                    <th>Capacity</th>\r\n                    <th>Occupancy</th>\r\n                    <th>Status</th>\r\n                    <th>Score</th>\r\n                    <th></th>\r\n                  </tr>\r\n                </thead>\r\n                <tbody>\r\n                  <tr v-for=\"area in areas\" :key=\"area.id\">\r\n                    <td><strong>{{ area.name }}</strong></td>\r\n                    <td>{{ area.address }}</td>\r\n                    <td>{{ area.capacity ?? '‚Äî' }}</td>\r\n                    <td>{{ area.current_occupancy ?? 0 }}</td>\r\n                    <td>{{ area.status }}</td>\r\n                    <td>{{ area.final_score ?? '‚Äî' }}</td>\r\n                    <td><router-link :to=\"`/resident_pages/evacuation-areas/${area.id}`\" class=\"btn btn-primary\">View</router-link></td>\r\n                  </tr>\r\n                </tbody>\r\n              </table>\r\n            </div>\r\n          </div>\r\n          <div v-else class=\"muted p-1\">No evacuation areas found.</div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, onMounted, inject } from 'vue';\r\nconst residentAxios = inject('residentAxios', null);\r\nconst axiosFallback = (await import('axios')).default;\r\n\r\nconst areas = ref([]);\r\nconst loading = ref(true);\r\nconst error = ref(null);\r\nconst predictedEvacuees = ref(0);\r\nconst topArea = ref(null);\r\n\r\nconst showPredictions = ref(true);\r\nconst showFaultLines = ref(false);\r\nconst showAddLocation = ref(false);\r\nconst locationStatus = ref('');\r\n\r\nasync function fetchAreas() {\r\n  loading.value = true;\r\n  error.value = null;\r\n  try {\r\n    const http = residentAxios || axiosFallback;\r\n    const res = await http.get('/evacuation-areas');\r\n    areas.value = res.data || [];\r\n    // compute predicted and top area\r\n    predictedEvacuees.value = 29.41; // default placeholder\r\n    topArea.value = areas.value.slice().sort((a,b) => (b.final_score||0)-(a.final_score||0))[0] || null;\r\n  } catch (e) {\r\n    console.error(e);\r\n    error.value = e.response?.data?.message || e.message || 'Failed to load evacuation areas';\r\n  } finally {\r\n    loading.value = false;\r\n  }\r\n}\r\n\r\nfunction getLocation() {\r\n  locationStatus.value = 'Getting location...';\r\n  if (!navigator.geolocation) { locationStatus.value = 'Geolocation not supported'; return; }\r\n  navigator.geolocation.getCurrentPosition((pos) => {\r\n    locationStatus.value = `Lat ${pos.coords.latitude.toFixed(6)}, Lng ${pos.coords.longitude.toFixed(6)}`;\r\n    showAddLocation.value = true;\r\n  }, (err) => { locationStatus.value = `Error: ${err.message}`; });\r\n}\r\n\r\nfunction openAddLocation() {\r\n  // for now just alert ‚Äî the blade uses modal; we can wire modal if needed\r\n  alert('Add Location modal not implemented in resident UI yet');\r\n}\r\n\r\nonMounted(fetchAreas);\r\n</script>\r\n\r\n<style scoped>\r\n.evac-list { padding: 1rem; max-width: 1200px; margin: 0 auto; }\r\n.controls { padding: 12px; display:flex; gap:12px; }\r\n.info-box { background:#fff3cd; padding:12px; border-radius:8px; margin:8px 12px; }\r\n.legend { display:flex; gap:12px; margin-top:8px; }\r\n.legend-item { display:flex; gap:6px; align-items:center; }\r\n.dot { width:14px; height:14px; border-radius:50%; display:inline-block; border:2px solid white; box-shadow:0 1px 3px rgba(0,0,0,0.2); }\r\n.dot.low { background:#28a745; }\r\n.dot.moderate { background:#ffc107; }\r\n.dot.high { background:#fd7e14; }\r\n.dot.critical { background:#dc3545; }\r\n.map { height: 320px; border-radius:8px; margin:12px; background:#eef2f6; }\r\n.location-status-box { padding: 12px; margin: 0 12px 12px 12px; }\r\n.prescriptive { padding: 12px; margin: 12px 0; display:flex; justify-content:space-between; align-items:center; }\r\n.pred-left .big { font-size: 1.6rem; font-weight:700; }\r\n.table { width:100%; border-collapse:collapse; }\r\n.table th, .table td { padding: 10px; border-bottom: 1px solid #eee; }\r\n.table-responsive { overflow:auto; }\r\n.center { text-align:center; padding: 12px; }\r\n.muted { color:#666; }\r\n.btn { padding:8px 12px; border-radius:6px; color:#fff; text-decoration:none; background:#667eea; }\r\n.btn-success { background:#28a745; }\r\n.btn-primary { background:#667eea; }\r\n</style>\r\n"],"mappings":";AA4FA,SAASA,GAAG,EAAEC,SAAS,EAAEC,MAAM,QAAQ,KAAK;;;;;;;;IAC5C,MAAMC,aAAa,GAAGD,MAAM,CAAC,eAAe,EAAE,IAAI,CAAC;IACnD,MAAME,aAAa,GAAG,CAAC,CAAAC,MAAA,EAAAC,SAAA,IAAAC,iBAAA,OAAM,MAAM,CAAC,OAAO,I,4CAAGC,OAAO;IAErD,MAAMC,KAAK,GAAGT,GAAG,CAAC,EAAE,CAAC;IACrB,MAAMU,OAAO,GAAGV,GAAG,CAAC,IAAI,CAAC;IACzB,MAAMW,KAAK,GAAGX,GAAG,CAAC,IAAI,CAAC;IACvB,MAAMY,iBAAiB,GAAGZ,GAAG,CAAC,CAAC,CAAC;IAChC,MAAMa,OAAO,GAAGb,GAAG,CAAC,IAAI,CAAC;IAEzB,MAAMc,eAAe,GAAGd,GAAG,CAAC,IAAI,CAAC;IACjC,MAAMe,cAAc,GAAGf,GAAG,CAAC,KAAK,CAAC;IACjC,MAAMgB,eAAe,GAAGhB,GAAG,CAAC,KAAK,CAAC;IAClC,MAAMiB,cAAc,GAAGjB,GAAG,CAAC,EAAE,CAAC;IAE9B,eAAekB,UAAUA,CAAA,EAAG;MAC1BR,OAAO,CAACS,KAAK,GAAG,IAAI;MACpBR,KAAK,CAACQ,KAAK,GAAG,IAAI;MAClB,IAAI;QACF,MAAMC,IAAI,GAAGjB,aAAa,IAAIC,aAAa;QAC3C,MAAMiB,GAAG,GAAG,MAAMD,IAAI,CAACE,GAAG,CAAC,mBAAmB,CAAC;QAC/Cb,KAAK,CAACU,KAAK,GAAGE,GAAG,CAACE,IAAI,IAAI,EAAE;QAC5B;QACAX,iBAAiB,CAACO,KAAK,GAAG,KAAK,CAAC,CAAC;QACjCN,OAAO,CAACM,KAAK,GAAGV,KAAK,CAACU,KAAK,CAACK,KAAK,CAAC,CAAC,CAACC,IAAI,CAAC,CAACC,CAAC,EAACC,CAAC,KAAK,CAACA,CAAC,CAACC,WAAW,IAAE,CAAC,KAAGF,CAAC,CAACE,WAAW,IAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,IAAI,IAAI;MACrG,CAAC,CAAC,OAAOC,CAAC,EAAE;QACVC,OAAO,CAACnB,KAAK,CAACkB,CAAC,CAAC;QAChBlB,KAAK,CAACQ,KAAK,GAAGU,CAAC,CAACE,QAAQ,EAAER,IAAI,EAAES,OAAO,IAAIH,CAAC,CAACG,OAAO,IAAI,iCAAiC;MAC3F,CAAC,SAAS;QACRtB,OAAO,CAACS,KAAK,GAAG,KAAK;MACvB;IACF;IAEA,SAASc,WAAWA,CAAA,EAAG;MACrBhB,cAAc,CAACE,KAAK,GAAG,qBAAqB;MAC5C,IAAI,CAACe,SAAS,CAACC,WAAW,EAAE;QAAElB,cAAc,CAACE,KAAK,GAAG,2BAA2B;QAAE;MAAQ;MAC1Fe,SAAS,CAACC,WAAW,CAACC,kBAAkB,CAAEC,GAAG,IAAK;QAChDpB,cAAc,CAACE,KAAK,GAAG,OAAOkB,GAAG,CAACC,MAAM,CAACC,QAAQ,CAACC,OAAO,CAAC,CAAC,CAAC,SAASH,GAAG,CAACC,MAAM,CAACG,SAAS,CAACD,OAAO,CAAC,CAAC,CAAC,EAAE;QACtGxB,eAAe,CAACG,KAAK,GAAG,IAAI;MAC9B,CAAC,EAAGuB,GAAG,IAAK;QAAEzB,cAAc,CAACE,KAAK,GAAG,UAAUuB,GAAG,CAACV,OAAO,EAAE;MAAE,CAAC,CAAC;IAClE;IAEA,SAASW,eAAeA,CAAA,EAAG;MACzB;MACAC,KAAK,CAAC,uDAAuD,CAAC;IAChE;IAEA3C,SAAS,CAACiB,UAAU,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}